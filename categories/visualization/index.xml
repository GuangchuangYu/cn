<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Visualization on Guangchuang Yu</title>
    <link>https://guangchuangyu.github.io/cn/categories/visualization/</link>
    <description>Recent content in Visualization on Guangchuang Yu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 21 Feb 2017 12:23:16 +0800</lastBuildDate>
    <atom:link href="https://guangchuangyu.github.io/cn/categories/visualization/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>æ ¹æ®GTFç”»åŸºå› çš„å¤šä¸ªè½¬å½•æœ¬ç»“æ„</title>
      <link>https://guangchuangyu.github.io/cn/2017/02/%E6%A0%B9%E6%8D%AEgtf%E7%94%BB%E5%9F%BA%E5%9B%A0%E7%9A%84%E5%A4%9A%E4%B8%AA%E8%BD%AC%E5%BD%95%E6%9C%AC%E7%BB%93%E6%9E%84/</link>
      <pubDate>Tue, 21 Feb 2017 12:23:16 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/02/%E6%A0%B9%E6%8D%AEgtf%E7%94%BB%E5%9F%BA%E5%9B%A0%E7%9A%84%E5%A4%9A%E4%B8%AA%E8%BD%AC%E5%BD%95%E6%9C%AC%E7%BB%93%E6%9E%84/</guid>
      <description>&lt;p&gt;è¿™æ˜¯&lt;a href=&#34;https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;amp;mid=2247484044&amp;amp;idx=2&amp;amp;sn=56b45eaeb4ad344481afa05abeb1c53e&amp;amp;chksm=9b484237ac3fcb219e41d5653fb800f987e7d217bbb3a5a0c0170ffb8e402f4cc5f726212ef7&amp;amp;mpshare=1&amp;amp;scene=1&amp;amp;srcid=0220calgiLgIZmjiiaNXZ0BE&amp;amp;key=df0a0b140e64a33b97880a54ee7cc95794b60a225d5338e88620674bed463405e61c5365394b7830750de8d3a88e122babd535c88c7d74b974b20c509218cf00d106c991a3a3f049c698a8f847aa5e06&amp;amp;ascene=0&amp;amp;uin=MTMxNjc4OTY2Mg%3D%3D&amp;amp;devicetype=iMac14%2C2+OSX+OSX+10.11.6+build(15G1217&#34;&gt;ç”Ÿç‰©æŠ€èƒ½æ ‘çš„ä¸€é“ä¹ é¢˜&lt;/a&gt;&amp;amp;version=12010310&amp;amp;nettype=WIFI&amp;amp;fontScale=100&amp;amp;pass_ticket=J1eAvg1veHMBZIOMVGYm1PxOxXHeQHJpF8%2BD0NyGdpCpT0gzYYAkuagjrw0kvQNd)ï¼Œä½¿ç”¨äº†base plotæ¥ç”»ï¼Œåšä¸ºè¡¥å……ï¼Œæˆ‘ä½¿ç”¨ggplot2æ¥é‡ç”»ä¸€éã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;url &amp;lt;- &amp;quot;http://www.broadinstitute.org/cancer/cga/sites/default/files/data/tools/rnaseqc/gencode.v7.annotation_goodContig.gtf.gz&amp;quot;
tmpfile &amp;lt;- tempfile(fileext=&amp;quot;.gtf.gz&amp;quot;)
download.file(url, tmpfile)
gtf &amp;lt;- read.table(tmpfile,stringsAsFactors = F,
                  header = F,comment.char = &amp;quot;#&amp;quot;,sep = &#39;\t&#39;
                  )
gtf &amp;lt;- gtf[gtf[,2] ==&#39;HAVANA&#39;,]
gtf &amp;lt;- gtf[grepl(&#39;protein_coding&#39;,gtf[,9]),]
gtf$gene &amp;lt;- sapply(as.character(gtf[,9]), function(x) sub(&amp;quot;.*gene_name\\s([^;]+);.*&amp;quot;, &amp;quot;\\1&amp;quot;, x))

draw_gene &amp;lt;- &#39;ANXA1&#39;
structure &amp;lt;- gtf[gtf$gene==draw_gene,c(1,3:5)]
names(structure) &amp;lt;- c(&amp;quot;chr&amp;quot;, &amp;quot;record&amp;quot;, &amp;quot;start&amp;quot;, &amp;quot;end&amp;quot;)
idx &amp;lt;- which(structure$record == &amp;quot;transcript&amp;quot;)
s &amp;lt;- idx+1
e &amp;lt;- c(idx[-1]-1, nrow(structure))
g &amp;lt;- lapply(seq_along(s), function(i) {
  x &amp;lt;- structure[s[i]:e[i],]
  x$transcript &amp;lt;- i
  return(x)
}) %&amp;gt;% do.call(rbind, .)

g &amp;lt;- g[g$record == &amp;quot;exon&amp;quot;,]
g$transcript &amp;lt;- factor(g$transcript)

library(ggplot2)
ggplot(g) + geom_segment(aes(x=start, xend=end, y=transcript, yend=transcript, color=transcript), size=2) + theme(legend.position=&amp;quot;none&amp;quot;) + labs(title=&amp;quot;ANXA1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2017/gtf.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä¸­ç©ºçš„ç¯å½¢æ ‘</title>
      <link>https://guangchuangyu.github.io/cn/2016/12/%E4%B8%AD%E7%A9%BA%E7%9A%84%E7%8E%AF%E5%BD%A2%E6%A0%91/</link>
      <pubDate>Sat, 03 Dec 2016 00:53:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/12/%E4%B8%AD%E7%A9%BA%E7%9A%84%E7%8E%AF%E5%BD%A2%E6%A0%91/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/iss95.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ˜¯&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues/95&#34;&gt;github&lt;/a&gt;ä¸Šçš„é—®é¢˜ï¼Œä»–æƒ³ç”»ç¯å½¢æ ‘çš„æ—¶å€™ï¼ŒåŠ ä¸€æ¡é•¿é•¿çš„root lengthæŠŠtipsç»™é¡¶å‡ºå»ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªé—®é¢˜åœ¨google forumä¸Šæˆ‘æ—©å·²è§£ç­”ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screen Shot 2016-11-30 at 9.06.01 PM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘åœ¨google groupä¸Šæ•™ä¼šçš„è¿™ä¸ªäººï¼Œä»–çš„æ–‡ç« å‘è¡¨åœ¨&lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pubmed/27605062&#34;&gt;nature communications&lt;/a&gt;ä¸Šï¼Œä¸‹é¢æ˜¯pubmedä¸Šçš„æˆªå›¾ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screen Shot 2016-11-30 at 9.06.57 PM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç®€ç›´äº®çäº†æˆ‘çš„ç‹—çœ¼ï¼Œæˆ‘çœ‹åˆ°è¿™å›¾ï¼Œä¸€å£è€è¡€å·®åˆ«å–·å‡ºæ¥ï¼Œè¿™ç”»çš„ä»€ä¹ˆç©æ„ï¼Œå•¥éƒ½çœ‹ä¸æ¸…ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘æœ¬æ¥ä»¥ä¸ºä»–è¦æŠŠä¸­é—´åšç©ºï¼Œæ˜¯ä¸ºäº†æŠŠlegendæ”¾è¿›å»ï¼Œç»“æœä¸æ˜¯ï¼Œå°¼ç›ä¹Ÿå¤ªç©ºäº†ï¼Œè€Œä¸”tipsæ ¹æœ¬åˆ†ä¸æ¸…å…³ç³»ï¼Œæ»¡ç¯‡æ–‡ç« éƒ½æ˜¯è¿™ç§å›¾ï¼Œé™„ä»¶ä¸Šæ›´å¤šï¼Œå¥½ä¸€æœµå¥‡è‘©ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯githubä¸Šçš„é—®é¢˜ï¼Œè®©æˆ‘é‡æ–°è®¤è¯†äº†è¿™æ ·çš„å›¾ï¼Œå°±åƒæé—®è€…è¯´çš„ï¼Œä»–æƒ³æŠŠtipç»™é¡¶å‡ºå»ï¼Œè¿™æ ·å®¹æ˜“çœ‹åˆ°tip labelï¼ŒæŸç§ç¨‹åº¦ä¸Šï¼Œè¿™ä¸å¤±ä¸ºä¸€ä¸ªå¥½æ–¹æ³•ï¼Œä¸€ç§å¥½æŠ˜ä¸­ï¼Œä½†åƒä¸Šé¢é‚£ä¸ªé¡¶å¾—å¤ªå‰å®³äº†ï¼Œæˆ‘ä¾ç„¶æ¥å—ä¸äº†ã€‚&lt;/p&gt;

&lt;p&gt;å®ç°èµ·æ¥ä¹Ÿå®¹æ˜“ï¼Œæé—®è€…è¯´figtreeå¯ä»¥åšï¼Œé€šè¿‡æä¸€æ¡é•¿é•¿çš„root lengthæ¥å®ç°ï¼Œè¿™ä¸ªåœ¨ggtreeé‡Œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼Œä½†æˆ‘åšç©ºç¯å½¢æ ‘æˆ–è€…è¯´é¡¶ä¸€é¡¶tip labelï¼Œæ ¹æœ¬å°±ä¸éœ€è¦ç”¨é¢å¤–ç”»æ¡çº¿æ¥é¡¶/æ’‘å¼€åœ†å½¢ï¼Œä½†æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œæ— éæ˜¯è¦ç»™å·¦è¾¹ç•™æ›´å¤šç©ºé—´ï¼Œè¿™æ ·åœ¨æ—‹è½¬æˆæåæ ‡çš„æ—¶å€™ï¼Œå·¦è¾¹çš„ç©ºé—´å°±å˜æˆäº†å†…éƒ¨çš„ç©ºé—´ï¼Œäºæ˜¯ä¸­é—´å°±ç©ºäº†ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥å‘¢ï¼Œ+xlim(è´Ÿæ•°, NA) å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>vertical dendrogram in ggtree</title>
      <link>https://guangchuangyu.github.io/cn/2016/11/vertical-dendrogram-in-ggtree/</link>
      <pubDate>Tue, 29 Nov 2016 00:53:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/11/vertical-dendrogram-in-ggtree/</guid>
      <description>&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Is it possible to plot horizontal trees with ggtree? (a la plot.hclust default).&lt;/p&gt;&amp;mdash; Diego Diez (@kurai_yousei) &lt;a href=&#34;https://twitter.com/kurai_yousei/status/799532564633518080&#34;&gt;November 18, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;è¿™ä¸ªDiegoåœ¨æ¨ç‰¹ä¸Šé—®çš„é—®é¢˜ï¼Œä»–æœ€è¿‘åœ¨å†™ä¸€ä¸ª&lt;a href=&#34;https://github.com/ddiez/motiftools&#34;&gt;motiftools&lt;/a&gt;çš„RåŒ…ï¼Œé‡Œé¢ç”¨äº†ggtreeæ¥ç”»å›¾ï¼Œæˆ‘æƒ³ä»–åº”è¯¥æ˜¯è¦è§£å†³ä»–åœ¨åŒ…é‡Œçš„ç”»æ ‘/èšç±»åŠŸèƒ½å§ã€‚&lt;/p&gt;

&lt;p&gt;ä»–é—®é¢˜å†™çš„horizontalï¼Œä½†å…¶å®plot.hclusté»˜è®¤æ˜¯verticalï¼Œggtreeé»˜è®¤ä¹Ÿæ˜¯horizontalï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºä»–é—®çš„æ˜¯vertical layoutï¼Œè¿™ä¸ªåœ¨æˆ‘çš„å›ç­”ä¸­ä¹Ÿå¾—åˆ°äº†ä»–çš„ç¡®è®¤ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; require(ggtree)
&amp;gt; set.seed(123)
&amp;gt; tr = rtree(30)
&amp;gt; ggtree(tr) + scale_x_reverse() + coord_flip()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œæ— éæ˜¯åæ ‡è½´ç¿»è½¬è€Œå·²ã€‚äºæ˜¯ä¸Šé¢çš„ä»£ç ï¼Œå°±å¾—åˆ°ä¸‹é¢çš„å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screen Shot 2016-11-21 at 7.53.54 PM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ggtreeæ”¯æŒå¤šç§å¸ƒå±€(layout)ï¼Œrectangularï¼ˆä¸Šé¢è¿™ç§å°±æ˜¯ï¼Œçˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹ç”±90åº¦æŠ˜çº¿è¿æ¥ï¼‰ï¼Œslatedï¼ˆçˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹ç”±ç›´çº¿è¿æ¥ï¼‰ï¼Œ circularï¼ˆåœ†åœˆå‹ï¼Œçˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹çš„è¿æ¥æ–¹å¼å¯ä»¥æ˜¯rectangularä¹Ÿå¯ä»¥æ˜¯slantedï¼‰ï¼Œfanï¼ˆé¡¾åæ€ä¹‰-æ‰‡å­å‹ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæœ‰å¼€å£çš„åœ†åœˆï¼Œå®é™…ä¸Šggtreeæä¾›äº†open_treeå‡½æ•°ï¼Œå¯ä»¥æŠŠcircularçš„æ ‘è½¬å˜ä¸ºfan layoutï¼‰ï¼Œunrootedï¼ˆæ— æ ¹æ ‘ï¼Œè¿æ¥æ–¹å¼æ˜¯slantedï¼Œä½†æ²¡æœ‰æ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¯ä»¥è¯´æœ‰äº›è¯´åœ†åœˆå‹ï¼Œä½†æ²¡æœ‰ä¸­å¿ƒï¼‰ï¼Œè¿˜æœ‰äºŒç»´æ ‘ï¼ˆæŠŠyè½´åˆ©ç”¨èµ·æ¥ï¼Œå¯ä»¥æ˜ å°„åˆ°èŠ‚ç‚¹çš„phenotypeæˆ–è€…æ˜¯ç»Ÿè®¡æ¨æ–­çš„ä¼°å€¼ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šé¢æåˆ°çš„è¿™äº›å¸ƒå±€ï¼Œéƒ½å¯ä»¥æœ‰ç”»phylogramæˆ–cladogramï¼Œå·®åˆ«åœ¨äºphylogramæœ‰branch lengthè€Œcladogramæ²¡æœ‰ã€‚è€Œåœ¨å±‚æ¬¡èšç±»ä¸­ï¼Œåšçš„æ˜¯èšç±»ï¼Œè€Œä¸æ˜¯è¿›åŒ–æ ‘ï¼Œè¿™æ˜¯ä¸åŒçš„æ¦‚å¿µï¼Œæ‰€ä»¥ç”»å‡ºæ¥çš„å›¾ç›¸ä¼¼ï¼Œä½†å´æ˜¯ä¸ä¸€æ ·çš„ä¸œè¥¿ï¼Œæ‰€ä»¥èšç±»åˆ†æçš„å›¾å«dendrogramï¼Œåƒä¸Šé¢è¿™ä¸ªå›¾ï¼Œå°±æ˜¯å…¸å‹çš„dendrogramç”»æ³•ï¼Œæ˜¾ç„¶çœ‹ç€å’Œè¿›åŒ–æ ‘æ˜¯æ²¡ä»€ä¹ˆå·®åˆ«çš„ï¼Œåªä¸è¿‡è¿›åŒ–æ ‘ä¸€èˆ¬ä»å·¦åˆ°å³ç”»ï¼Œè€Œdendrogramç”»è¿™ç§ä»ä¸Šåˆ°ä¸‹çš„å½¢çŠ¶è¿˜æ˜¯æ¯”è¾ƒå¸¸è§çš„ã€‚è™½ç„¶æ˜¯ä¸ä¸€æ ·çš„ä¸œè¥¿ï¼Œä½†ä»ç”»å›¾çš„è§’åº¦æ¥çœ‹ï¼Œdendrogramå’Œrectangular layoutçš„phylogram/cladogramæ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥è¦é—®ggtreeèƒ½ä¸èƒ½ç”»dendrogramçš„å½¢çŠ¶ï¼Œå½“ç„¶å¯ä»¥ï¼Œè¦é—®èƒ½ä¸èƒ½ä»ä¸Šåˆ°ä¸‹ï¼Œå½“ç„¶å¯ä»¥ï¼Œæ— éæ˜¯åæ ‡è½´é¢ è¿‡æ¥å€’è¿‡å»è€Œå·²ï¼Œå°±ç®—ä½ è¦ç”»å‡ºä»ä¸‹åˆ°ä¸Šï¼Œä»å³åˆ°å·¦ï¼Œéƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨emojiç”»å›¾</title>
      <link>https://guangchuangyu.github.io/cn/2016/11/%E4%BD%BF%E7%94%A8emoji%E7%94%BB%E5%9B%BE/</link>
      <pubDate>Fri, 25 Nov 2016 00:53:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/11/%E4%BD%BF%E7%94%A8emoji%E7%94%BB%E5%9B%BE/</guid>
      <description>&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; code for the PhD/cute animals gestation &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/gganimate?src=hash&#34;&gt;#gganimate&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/emojifont?src=hash&#34;&gt;#emojifont&lt;/a&gt; plot &lt;a href=&#34;https://t.co/qWM0bCHoHJ&#34;&gt;https://t.co/qWM0bCHoHJ&lt;/a&gt; ğŸ­ğŸ¶ğŸ±ğŸºğŸ¯ğŸ·ğŸğŸ»ğŸ‘¶ğŸ³ğŸ˜ğŸ“• &lt;a href=&#34;https://t.co/a4GYl191a8&#34;&gt;https://t.co/a4GYl191a8&lt;/a&gt;&lt;/p&gt;&amp;mdash; MaÃ«lle Salmon (@ma_salmon) &lt;a href=&#34;https://twitter.com/ma_salmon/status/800007428096094209&#34;&gt;November 19, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;æ— ç¼˜æ— æ•…æ”¶åˆ°å¥½å‡ æ¡æ¶ˆæ¯ï¼ŒåŸæ¥æ˜¯ç”¨emojiç”»å›¾ã€‚&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/pboesu&#34;&gt;@pboesu&lt;/a&gt; btw do you know the &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; emojifont pkg? I&amp;#39;ve used it more than &lt;a href=&#34;https://twitter.com/millerdl&#34;&gt;@millerdl&lt;/a&gt; emoGG &lt;a href=&#34;https://t.co/p27fwEmDSD&#34;&gt;https://t.co/p27fwEmDSD&lt;/a&gt; but I like both &lt;a href=&#34;https://t.co/uV49WjOSp3&#34;&gt;https://t.co/uV49WjOSp3&lt;/a&gt;&lt;/p&gt;&amp;mdash; MaÃ«lle Salmon (@ma_salmon) &lt;a href=&#34;https://twitter.com/ma_salmon/status/800009044123586560&#34;&gt;November 19, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;åšä¸ºemojifontåŒ…çš„ä½œè€…ï¼Œæˆ‘è¡¨ç¤ºå¾ˆé«˜å…´çœ‹åˆ°è‡ªå·±çš„åŒ…ç»™å¤§å®¶å¸¦æ¥ä¹è¶£ï¼Œåœ¨å›å¤ä¸­@milerdlè¯´emoGGæ˜¯ä»–ç”¨äº†ä¸¤ä¸ªæ™šä¸Šå†™çš„ï¼Œemojifontåˆšå¥½ä¹Ÿæ˜¯æˆ‘ç”¨äº†ä¸¤ä¸ªæ™šä¸Šå†™çš„ï¼Œä¸€ä¸ªæ™šä¸Šæ”¯æŒäº†emojiå­—ä½“ï¼Œå¦ä¸€ä¸ªæ™šä¸ŠåŠ å…¥äº†fontawesomeå­—ä½“ã€‚&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Hi &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; excellent &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/emojifont?src=hash&#34;&gt;#emojifont&lt;/a&gt; implementation! &lt;a href=&#34;https://t.co/lTIWDQ1zq0&#34;&gt;https://t.co/lTIWDQ1zq0&lt;/a&gt; very cool! &lt;a href=&#34;https://t.co/sCALpuWW28&#34;&gt;pic.twitter.com/sCALpuWW28&lt;/a&gt;&lt;/p&gt;&amp;mdash; Jo-fai (Joe) Chow (@matlabulous) &lt;a href=&#34;https://twitter.com/matlabulous/status/677205176663588865&#34;&gt;December 16, 2015&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;åœ¨å†™è¿™ä¸ªåŒ…ä¹‹å‰ï¼Œæˆ‘æ—©å°±æœ‰ç”¨emojiåœ¨Rç”»å›¾ä¸­ï¼Œå†™è¿™ä¸ªåŒ…ä¹Ÿæ­£æ˜¯ä¸ºäº†å›åº”emoGGï¼Œå› ä¸ºæˆ‘è§‰å¾—ä»–çš„å®ç°æ–¹å¼å¹¶ä¸ç†æƒ³ï¼Œè€Œæˆ‘çš„æ›´ä¸ºçµæ´»ã€‚&lt;/p&gt;

&lt;p&gt;å›åˆ°ä¸»é¢˜ä¸Šï¼Œæˆ‘å°†å±•ç¤ºä½¿ç”¨emojifontæ¥ç”»å›¾ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢è¿™ä¸ªæ•°æ®æ˜¯æˆ‘æ¯å¹´è¯»ä¹¦ã€çœ‹ç”µå½±ã€å¬ä¸“è¾‘çš„æ•°ç›®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; d
   year category num
1  2009     book  35
2  2009    movie  64
3  2009    music  24
4  2010     book  34
5  2010    movie  47
6  2010    music  13
7  2011     book  17
8  2011    movie  18
9  2011    music   2
10 2012     book  25
11 2012    movie  25
12 2012    music   0
13 2013     book  15
14 2013    movie  17
15 2013    music   0
16 2014     book   8
17 2014    movie  11
18 2014    music   1
19 2015     book   5
20 2015    movie  14
21 2015    music   0
22 2016     book   4
23 2016    movie  14
24 2016    music   0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…ˆåŠ è½½æ‰€éœ€çš„åŒ…å’Œemojiå­—ä½“ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;require(ggplot2)
require(ggthemes)
require(emojifont)
load.emojifont()
emo &amp;lt;- emoji(c(&amp;quot;book&amp;quot;, &amp;quot;movie_camera&amp;quot;, &amp;quot;musical_note&amp;quot;))
names(emo) &amp;lt;- c(&#39;book&#39;, &#39;movie&#39;, &#39;music&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç”»å‡ºè¶‹åŠ¿å›¾ï¼Œå¹¶åœ¨æ¯ä¸ªç‚¹ä¸Šç”¨ç›¸åº”çš„emojiå­—ä½“æ ‡æ³¨ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- ggplot(d, aes(x=factor(year), y=num, group=category, colour=category))
p &amp;lt;- p +geom_line() +geom_text(aes(label=emo[category]), family=&#39;OpenSansEmoji&#39;, size=10) +xlab(NULL) + ylab(NULL) 

æ›´æ”¹ä¸€äº›èƒŒæ™¯ç­‰ä¸»é¢˜ç»†èŠ‚ï¼Œè®¾ç½®ä¸­æ–‡å­—ä½“ç­‰ï¼š
p &amp;lt;- p + theme_fivethirtyeight() + scale_color_tableau()
p &amp;lt;- p+theme(axis.text.x=element_text(face=&amp;quot;bold&amp;quot;, size=16), 
        axis.text.y=element_text(face=&amp;quot;bold&amp;quot;, size=16))
 p &amp;lt;- p+theme(legend.text=element_text(size=16, family=&amp;quot;OpenSansEmoji&amp;quot;), 
            legend.title=element_blank(), legend.position=&#39;none&#39;)
p+ ggtitle(&#39;Yå”çš„ä¹¦å½±éŸ³&#39;) + theme(plot.title=element_text(family=&#39;STKaiti&#39;))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;äºæ˜¯äº§ç”Ÿä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/Screen Shot 2016-11-21 at 7.47.34 PM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é£Ÿè‰²æ€§ä¹Ÿ</title>
      <link>https://guangchuangyu.github.io/cn/2016/11/%E9%A3%9F%E8%89%B2%E6%80%A7%E4%B9%9F/</link>
      <pubDate>Mon, 21 Nov 2016 12:23:16 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/11/%E9%A3%9F%E8%89%B2%E6%80%A7%E4%B9%9F/</guid>
      <description>&lt;p&gt;ç”»å›¾é…è‰²å¹¶ä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œå¥½çš„é…è‰²è®©äººçœ¼å‰ä¸€äº®ï¼Œè™½ç„¶Ræœ‰å¾ˆå¤šé…è‰²æ–¹æ¡ˆï¼Œåšä¸ºggplot2çš„çˆ±å¥½è€…ï¼Œggthemesä¹Ÿæä¾›äº†å¾ˆå¤šä¸»é¢˜ï¼Œå†…ç½®äº†å¾ˆå¤šé…è‰²æ–¹æ¡ˆï¼Œè¿˜æœ‰ä¸€äº›å…¶å®ƒçš„åŒ…ï¼Œæ¯”å¦‚ggtechï¼ŒåŒ…å«äº†ä¸€äº›ç§‘æŠ€å…¬å¸æ¯”å¦‚facebook, twitter, googleçš„å…¸å‹é…è‰²æ–¹æ¡ˆï¼Œç”šè‡³äºggsciï¼Œæä¾›äº†nature, lancetçš„é…è‰²æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;ä½†è¿™äº›è¿œè¿œä¸å¤Ÿï¼
ä½†è¿™äº›è¿œè¿œä¸å¤Ÿï¼
ä½†è¿™äº›è¿œè¿œä¸å¤Ÿï¼&lt;/p&gt;

&lt;p&gt;çœ‹åˆ°ä¸€å¼ å›¾ç‰‡è®©æˆ‘çœ¼å‰ä¸€äº®ï¼Œæˆ‘æƒ³ç”¨å®ƒçš„é…è‰²æ–¹æ¡ˆå‘¢ï¼æˆ‘æƒ³æ‹¿æœ€æ–°ç”µå½±çš„æµ·æŠ¥çš„é…è‰²æ¥è£…ä¸ªé€¼å‘¢ï¼ç”»å›¾æ—¶ä¸æƒ³ç”¨ç°æˆçš„é…è‰²ï¼Œæƒ³è¦å¦ç±»ä¸€äº›ï¼Œæˆ‘æƒ³ç”¨ä¸€äº›å¤§è‡ªç„¶çš„é£æ ¼ï¼Œæ¯”å¦‚æ±‚å¶æœŸé—´å„ç§é¸Ÿç±»çš„ç¾½æ¯›é¢œè‰²æ¥ç”»ï¼&lt;/p&gt;

&lt;p&gt;è¿™äº›åœ¨Ré‡Œé¢ï¼Œéƒ½æ˜¯å¯ä»¥çš„ï¼Œå¯ä»¥çš„ï¼Œå¯ä»¥çš„&amp;hellip;&lt;/p&gt;

&lt;p&gt;ä¸‹é¢éš†é‡æ¨èä¸€ä¸ªå«rPlotterçš„RåŒ…ï¼Œ&lt;a href=&#34;https://github.com/woobe/rPlotter&#34;&gt;https://github.com/woobe/rPlotter&lt;/a&gt;ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨å›¾ç‰‡ä¸­æŠ½æé¢œè‰²ã€‚å…¶å®å®ç°èµ·æ¥ä¹Ÿå®¹æ˜“ï¼Œç”¨EBImageæŠŠå›¾ç‰‡è¯»è¿›å»ï¼Œå­˜æˆä¸€ä¸ªRGBçš„ä¸‰ç»´çŸ©é˜µï¼Œé€šè¿‡kmeansèšç±»ï¼ŒæŠŠä¸­å¿ƒç‚¹é¢œè‰²æŠ¥å‡ºæ¥å°±å¯ä»¥äº†ã€‚è‹¥å¹²å¹´å‰æˆ‘å†™è¿‡ç”¨kmeanså‹ç¼©å›¾ç‰‡ï¼Œç”¨çš„å°±æ˜¯æŠŠé¢œè‰²å¡«å……æˆä¸­å¿ƒç‚¹é¢œè‰²ï¼Œç¨å¾®æŠŠä¹‹å‰çš„ä»£ç æ”¹ä¸€æ”¹ï¼Œä¹Ÿèƒ½å®ç°è¿™ä¸ªé¢œè‰²æŠ½æçš„åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;p&gt;å®ä¾‹æ¼”ç¤ºï¼Œæˆ‘googleäº†ä¸€å¼ spiderçš„å›¾ç‰‡ï¼ŒæŠŠé¢œè‰²æå‡ºæ¥ï¼Œæ‹¿æ¥ç”»barplotï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/Jumping-spider.jpeg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pal = extract_colours(&amp;quot;http://i1.mirror.co.uk/incoming/article8566552.ece/ALTERNATES/s615b/Jumping-spider.jpg&amp;quot;)
barplot(1:5, col=pal)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/spider_color.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å†æ¥ä¸€å¼ homer simpsonçš„å›¾ç‰‡ï¼š
&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/kissing-Homer-Simpson-The-Simpsons-Marge-Simpson-_578180-20_zx1jpk.jpeg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pal2 = extract_colours(&amp;quot;https://images.complex.com/complex/image/upload/t_article_image/kissing-Homer-Simpson-The-Simpsons-Marge-Simpson-_578180-20_zx1jpk.jpg&amp;quot;, 7)
barplot(1:7, col=pal2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/homer_color.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¹‹å‰è¯´çš„å„ç§åœºæ™¯ï¼Œéƒ½æ˜¯å¯ä»¥å®ç°çš„ï¼Œæœ€æ–°æµ·æŠ¥é…è‰²ï¼Œä½ å¯ä»¥æœ‰ï¼ä½ æƒ³ç”»å›¾ç”¨ç¾é˜Ÿæ¥é…è‰²ï¼Œå¯ä»¥æœ‰ï¼æ‹¿èœ˜è››å°é¸Ÿæ¥é…è‰²ï¼Œå¯ä»¥æœ‰ï¼ç”šè‡³äºæ‹¿è‚Œè‚‰ç”·çš„è‚‰è‰²ä¹Ÿå¯ä»¥çš„ã€‚ä¸‹æ¬¡å‘æ–‡ç« åœ¨æ„é…è‰²çš„æ—¶å€™ï¼Œä½•ä¸æœç´¢å›¾ç‰‡ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆå›¾ç‰‡é¡ºçœ¼çš„ï¼Œå°±æ‹¿æ¥ç”¨äº†ã€‚&lt;/p&gt;

&lt;p&gt;å³ä½¿ä½ ä¸ä¼šç”¨Rç”»å›¾ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¿™é…è‰²æ–¹æ¡ˆåº”è¯¥äºM$çš„officeä¸­ï¼Œword/excel/powerpointéƒ½æ˜¯æ”¯æŒè‡ªå®šä¹‰é¢œè‰²ä¸»é¢˜çš„ï¼Œè¯·è‡ªè¡Œæœç´¢ &amp;ldquo;office è‡ªå®šä¹‰ä¸»é¢˜é¢œè‰²&amp;rdquo;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DNAåºåˆ—å·®å¼‚ä½œå›¾</title>
      <link>https://guangchuangyu.github.io/cn/2016/11/dna%E5%BA%8F%E5%88%97%E5%B7%AE%E5%BC%82%E4%BD%9C%E5%9B%BE/</link>
      <pubDate>Sat, 19 Nov 2016 12:23:16 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/11/dna%E5%BA%8F%E5%88%97%E5%B7%AE%E5%BC%82%E4%BD%9C%E5%9B%BE/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/640.jpeg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ˜¯é«˜è€å¸ˆ&lt;a href=&#34;http://link.springer.com/article/10.1007/s11540-015-9307-3&#34;&gt;æ–‡ç« &lt;/a&gt;é‡Œçš„å›¾ï¼Œæ¯ä¸€ä¸ªå°å›¾éƒ½æ˜¯é€šè¿‡æ¯”è¾ƒä¸¤æ¡æ¯”å¯¹åºåˆ—å·®å¼‚è€Œåšå‡ºæ¥çš„ï¼Œä»å›¾Aå’ŒBä¸­å¯ä»¥çœ‹å‡ºï¼ŒCF_YL21æœ‰å¯èƒ½æ˜¯Montå’ŒOzä¸¤æ¡åºåˆ—é‡ç»„è€Œæ¥ã€‚é«˜è€å¸ˆè‡ªå·±åšå‡ºè¿™å›¾åï¼Œæ·±çŸ¥æ‰‹å·¥ç»Ÿè®¡åºåˆ—å·®å¼‚ã€ç”»å›¾ã€æ‹¼å›¾ä¹‹å›°éš¾ã€‚é—®æˆ‘æœ‰æ²¡æœ‰åŠæ³•è¯»ä¸¤æ¡åºåˆ—ï¼Œç”Ÿæˆä¸€ä¸ªå›¾ã€‚&lt;/p&gt;

&lt;p&gt;å¾ˆå¤šä¸œè¥¿éƒ½æ²¡æœ‰ç°æˆçš„ï¼Œéœ€è¦è‡ªå·±é€ è½®å­ï¼Œäºæ˜¯æˆ‘å†™äº†ä¸ªRåŒ…æ¥åšè¿™ä¸ªäº‹æƒ…ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(seqcombo)
fas = list.files(system.file(&amp;quot;examples&amp;quot;,&amp;quot;GVariation&amp;quot;, package=&amp;quot;seqcombo&amp;quot;), 
pattern=&amp;quot;fas&amp;quot;, full.names=TRUE)
x = seqdiff(fas[1])
plot(x)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/Screen Shot 2016-11-17 at 8.25.26 PM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸€è¡Œä»£ç è¯»æ–‡ä»¶ï¼Œç„¶åplotç”»å‡ºæ¥ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸‰ä¸ªæ–‡ä»¶ä¸€èµ·è¯»ï¼Œä¸‰ä¸ªå›¾ä¸€èµ·ç”»ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;x = lapply(fas, seqdiff)
plts = lapply(x, plot)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åå¯ä»¥å¾ˆå®¹æ˜“æŠŠä¸‰å¼ å›¾æ‹¼åœ¨ä¸€èµ·&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cowplot::plot_grid(plotlist=plts, ncol=1, labels=LETTERS[1:3])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/Screen Shot 2016-11-17 at 8.20.21 PM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç®€ç›´å®Œç¾ï¼Œè·Ÿæ–‡ç« ä¸­çš„å›¾ä¸€æ¯›ä¸€æ ·ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªåŒ…æˆ‘å–å&lt;a href=&#34;https://github.com/GuangchuangYu/seqcombo&#34;&gt;seqcombo&lt;/a&gt;ï¼Œ90åå¤§æ¦‚ä¸çŸ¥é“ä½•ä¸ºcomboï¼Œå¦‚æœä½ çŸ¥é“ï¼Œæ²¡é”™ï¼Œè¯´çš„å°±æ˜¯ä½ ï¼Œä½ å·²ç»æš´éœ²å¹´é¾„äº†ï¼å› ä¸ºè¿™ä¸ªå›¾æ˜¯å¯ä»¥è¾…åŠ©çœ‹åºåˆ—é‡ç»„çš„ï¼Œæ‰€ä»¥å–è¿™ä¸ªåå­—ï¼Œä»¥åæœ‰å¯èƒ½çš„è¯ï¼Œå†å®ç°ä¸€äº›å…¶å®ƒçš„å¯è§†åŒ–æ–¹æ³•ï¼Œèµ·ç å¾—æœ‰ä¸‰æŠŠåˆ·å­ï¼Œæ‰å¯¹å¾—èµ·comboè¿™åå­—ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree: reverse time scale</title>
      <link>https://guangchuangyu.github.io/cn/2016/11/ggtree-reverse-time-scale/</link>
      <pubDate>Tue, 08 Nov 2016 12:23:16 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/11/ggtree-reverse-time-scale/</guid>
      <description>&lt;p&gt;è¿™æ˜¯æœ€è¿‘githubä¸Šçš„é—®é¢˜ï¼Œå¦‚ä½•åè½¬time scaleï¼Œä¹Ÿå°±æ˜¯æŠŠæœ€è¿‘çš„æ—¶é—´è®¾ä¸º0ã€‚è€Œå†…éƒ¨èŠ‚ç‚¹ä¸ºè·ä»Šå¤šå°‘å¹´ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ï¼ŒæŠŠxè½´çš„å€¼å˜æˆx-max(x)å°±å¯ä»¥ï¼Œæ„Ÿè§‰è¿™ä¸ªä¹Ÿåªä¼šåœ¨æ—¶é—´æ ‘ä¸Šä½¿ç”¨ï¼Œæ‰€ä»¥å–årevtsï¼ˆreverse time scaleï¼‰ï¼Œrevtsä¹‹åï¼Œxè½´æœ€å¤§å€¼æ˜¯0ï¼Œå…¶å®ƒä¸ºè´Ÿæ•°ï¼Œå¯ä»¥ä½¿ç”¨scale_x_continuousæ”¹labelä¸ºç»å¯¹å€¼ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; library(ggtree)
&amp;gt; tr = rtree(30)
&amp;gt; p =ggtree(tr) + theme_tree2()
&amp;gt; p1 = revts(p)
&amp;gt; p2 = p1 + scale_x_continuous(
              breaks=c(-4:0), 
              labels=abs(-4:0))
&amp;gt; multiplot(p, p1, p2, ncol=3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2016/Screen Shot 2016-11-07 at 11.00.08 AM.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ggtreeå®ç°è¿›åŒ–æ ‘çš„å¯è§†åŒ–å’Œæ³¨é‡Š</title>
      <link>https://guangchuangyu.github.io/cn/2016/03/%E4%BD%BF%E7%94%A8ggtree%E5%AE%9E%E7%8E%B0%E8%BF%9B%E5%8C%96%E6%A0%91%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%92%8C%E6%B3%A8%E9%87%8A/</link>
      <pubDate>Wed, 09 Mar 2016 13:17:48 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/03/%E4%BD%BF%E7%94%A8ggtree%E5%AE%9E%E7%8E%B0%E8%BF%9B%E5%8C%96%E6%A0%91%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%92%8C%E6%B3%A8%E9%87%8A/</guid>
      <description>

&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡å—é­å¤ªäº‘ï¼ˆ&lt;a href=&#34;http://www.weibo.com/taiyun&#34;&gt;@cloud_wei&lt;/a&gt;)çš„é‚€è¯·ï¼Œæœ€åˆå‘è¡¨äº&lt;a href=&#34;http://cos.name/2015/11/to-achieve-the-visualization-and-annotation-of-evolutionary-tree-using-ggtree/&#34;&gt;ç»Ÿè®¡ä¹‹éƒ½&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æ–‡ç« æœ€åæåˆ°çš„å¯ä»¥åœ¨å›¾ä¸ŠåµŒå…¥å°å›¾ï¼Œæ¯”å¦‚é¥¼å›¾ï¼ŒæŸ±çŠ¶å›¾ç­‰ï¼Œ&lt;a href=&#34;http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/&#34;&gt;å·²ç»å®ç°&lt;/a&gt;, ä¹Ÿå¯ä»¥ä½¿ç”¨ç”¨æˆ·è‡ªå·±å›¾ç‰‡æ¥åµŒå…¥æ³¨é‡Šã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¿›åŒ–æ ‘çœ‹èµ·æ¥å’Œå±‚æ¬¡èšç±»å¾ˆåƒã€‚æœ‰å¿…è¦è§£é‡Šä¸€ä¸‹ä¸¤è€…çš„ä¸€äº›åŒºåˆ«ã€‚&lt;/p&gt;

&lt;p&gt;å±‚æ¬¡èšç±»çš„ä¾§é‡ç‚¹åœ¨äºåˆ†ç±»ï¼ŒæŠŠè·ç¦»è¿‘çš„èšåœ¨ä¸€èµ·ã€‚è€Œè¿›åŒ–æ ‘çš„æ„å»ºå¯ä»¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªèšç±»è¿‡ç¨‹ï¼Œä½†ä¾§é‡ç‚¹åœ¨äºæ¨æµ‹è¿›åŒ–å…³ç³»å’Œè¿›åŒ–è·ç¦»(evolutionary
distance)ã€‚&lt;/p&gt;

&lt;p&gt;å±‚æ¬¡èšç±»çš„è¾“å…¥æ˜¯è·ç¦»ï¼Œæ¯”å¦‚euclideanæˆ–manhattanè·ç¦»ã€‚æŠŠè·ç¦»è¿‘çš„èšåœ¨ä¸€èµ·ã€‚è€Œè¿›åŒ–æ ‘æ¨æ–­æ˜¯ä»ç”Ÿç‰©åºåˆ—ï¼ˆDNAæˆ–æ°¨åŸºé…¸ï¼‰çš„æ¯”å¯¹å¼€å§‹ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯è®¡ç®—ä¸€ä¸‹åºåˆ—ä¸­ä¸åŒ¹é…çš„æ•°ç›®ï¼Œç§°ä¹‹ä¸ºhamming
distanceï¼ˆé€šå¸¸ç”¨åºåˆ—é•¿åº¦åšå½’ä¸€åŒ–ï¼‰ï¼Œä½¿ç”¨è·ç¦»å½“ç„¶ä¹Ÿå¯ä»¥åº”ç”¨å±‚æ¬¡èšç±»çš„æ–¹æ³•ã€‚è¿›åŒ–æ ‘çš„æ„å»ºæœ€ç®€å•çš„æ–¹æ³•æ˜¯éåŠ æƒé…å¯¹å¹³å‡æ³•ï¼ˆUnweighted
Pair Group Method with Arithmetic Mean, UPGMAï¼‰ï¼Œè¿™å…¶å®æ˜¯ä½¿ç”¨average
linkageçš„å±‚æ¬¡èšç±»ã€‚è¿™ç§æ–¹æ³•åœ¨è¿›åŒ–æ ‘æ¨æ–­ä¸Šç°åœ¨åŸºæœ¬æ²¡äººç”¨ã€‚æ›´ä¸ºå¸¸ç”¨çš„æ˜¯é‚»æ¥æ³•ï¼ˆneighbor
joiningï¼‰ï¼Œä¸¤ä¸ªèŠ‚ç‚¹è·ç¦»å…¶å®ƒèŠ‚ç‚¹éƒ½æ¯”è¾ƒè¿œï¼Œè€Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹åˆæ¯”è¾ƒè¿‘ï¼Œå®ƒä»¬å°±æ˜¯neighborï¼Œå¯ä»¥çœ‹å‡ºneighborä¸ä¸€å®šæ˜¯è·ç¦»æœ€è¿‘çš„ä¸¤ä¸ªèŠ‚ç‚¹ã€‚çœŸæ­£åšè¿›åŒ–çš„äººï¼Œè¿™ä¸ªæ–¹æ³•ä¹ŸåŸºæœ¬ä¸ç”¨ã€‚ç°åœ¨ä¸»æµçš„æ–¹æ³•æ˜¯æœ€å¤§ä¼¼ç„¶æ³•(Maximum
likelihood, ML)ï¼Œé€šè¿‡è¿›åŒ–æ¨¡å‹ï¼ˆevolutionary
model)ä¼°è®¡æ‹“æœ´ç»“æ„å’Œåˆ†æ”¯é•¿åº¦ï¼Œä¼°è®¡çš„ç»“æœå…·æœ‰æœ€é«˜çš„æ¦‚ç‡èƒ½å¤Ÿäº§ç”Ÿè§‚æµ‹æ•°æ®ï¼ˆå¤šåºåˆ—æ¯”å¯¹ï¼‰ã€‚å¦å¤–è¿˜æœ‰æœ€å¤§ç®€çº¦æ³•å’Œè´å¶æ–¯æ¨æ–­ç­‰æ–¹æ³•ç”¨äºæ„å»ºè¿›åŒ–æ ‘ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://evolution.genetics.washington.edu/phylip/newicktree.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://evolution.genetics.washington.edu/phylip/newicktree.html&#34;&gt;Newick&lt;/a&gt;æ˜¯æœ€å¸¸ç”¨çš„å­˜å‚¨è¿›åŒ–æ ‘çš„æ–‡ä»¶æ ¼å¼ï¼Œå¦‚ä¸Šé¢è¿™ä¸ªæ ‘ï¼Œæ‹“æœ´ç»“æ„ç”¨newickæ ¼å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(B,(A,C,E),D);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‹¬å·æœ€å¤–å±‚æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå®ƒæœ‰ä¸‰ä¸ªå­èŠ‚ç‚¹ï¼Œ&lt;code&gt;B&lt;/code&gt;,
&lt;code&gt;(A,C,E)&lt;/code&gt;å’Œ&lt;code&gt;D&lt;/code&gt;ï¼Œè€ŒèŠ‚ç‚¹&lt;code&gt;(A,C,E)&lt;/code&gt;ä¹Ÿæœ‰ä¸‰ä¸ªå­èŠ‚ç‚¹&lt;code&gt;A&lt;/code&gt;ï¼Œ&lt;code&gt;C&lt;/code&gt;å’Œ&lt;code&gt;E&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åŠ ä¸Šåˆ†æ”¯é•¿åº¦ï¼Œä½¿ç”¨&lt;code&gt;:&lt;/code&gt;æ¥åˆ†éš”ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(B:6.0,(A:5.0,C:3.0,E:4.0):5.0,D:11.0);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¯”å¦‚&lt;code&gt;A:5.0&lt;/code&gt;ä»£è¡¨çš„æ˜¯&lt;code&gt;A&lt;/code&gt;ä¸å…¶çˆ¶èŠ‚ç‚¹çš„è·ç¦»æ˜¯&lt;code&gt;5.0&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å†…éƒ¨èŠ‚ç‚¹ä¹Ÿå¯ä»¥æœ‰labelï¼Œå†™åœ¨ç›¸åº”çš„æ‹¬å·å¤–é¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;(B:6.0,(A:5.0,C:3.0,E:4.0)Ancestor1:5.0,D:11.0);&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ˜¯æœ€ä¸ºå¹¿æ³›æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼Œå¾ˆå¤šè¿›åŒ–æ ‘å¯è§†è½¯ä»¶åªæ”¯æŒnewickæ ¼å¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;çš„å¼€å‘æºè‡ªäºæˆ‘éœ€è¦åœ¨æ ‘ä¸Šåšæ³¨é‡Šï¼Œå‘ç°å¹¶æ²¡æœ‰è½¯ä»¶å¯ä»¥å¾ˆå®¹æ˜“åœ°å®ç°ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬æŠŠç»Ÿè®¡ä¿¡æ¯åŠ åˆ°èŠ‚ç‚¹çš„labelä¸Šæ¥å±•ç¤ºï¼Œæ¯”å¦‚CodeMLçš„dN/dSåˆ†æï¼Œè¾“å‡ºæ–‡ä»¶é‡Œå°±ç»™ç”¨æˆ·å‡†å¤‡äº†newickæ ‘æ–‡æœ¬ï¼ŒæŠŠdN/dS
( &lt;em&gt;Ï‰&lt;/em&gt; ) åŠ äºèŠ‚ç‚¹labelä¹‹ä¸Š:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;codeml_file &amp;lt;- system.file(&amp;quot;extdata/PAML_Codeml/mlc&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tree_text &amp;lt;- readLines(codeml_file)[375:376]
tree_text

## [1] &amp;quot;w ratios as labels for TreeView:&amp;quot;                                                                                                                                                                                                                                                                                         
## [2] &amp;quot;(K #0.0224 , N #0.0095 , (D #0.0385 , (L #0.0001 , (J #0.0457 , (G #0.1621 , ((C #0.0461 , (E #0.0641 , O #0.0538 ) #0.0001 ) #0.0395 , (H #0.1028 , (I #0.0001 , (B #0.0001 , (A #0.0646 , (F #0.2980 , M #0.0738 ) #0.0453 ) #0.0863 ) #1.5591 ) #0.0001 ) #0.0001 ) #0.0549 ) #0.0419 ) #0.0001 ) #0.0964 ) #0.0129 );&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ç§åšæ³•åªèƒ½å±•ç¤ºä¸€å…ƒä¿¡æ¯ï¼Œè€Œä¸”ä¿®æ”¹èŠ‚ç‚¹labelçœŸå¿ƒæ˜¯ä¸ªè„æ´»ï¼Œæ»¡æ»¡çš„éƒ½æ˜¯ä¸çˆ½ï¼Œæˆ‘å¿ƒä¸­ç†æƒ³çš„æ–¹å¼æ˜¯æ ‘ä¸æ³¨é‡Šä¿¡æ¯åˆ†å¼€ï¼Œæ³¨é‡Šä¿¡æ¯å¯ä»¥æ–¹ä¾¿åœ°é€šè¿‡å›¾å±‚åŠ ä¸Šå»ï¼Œè€Œä¸”å¯ä»¥è‡ªç”±ç»„åˆã€‚äºæ˜¯ç€æ‰‹å¼€å‘&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;ã€‚&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;æ˜¯ä¸ªç®€å•æ˜“ç”¨çš„RåŒ…ï¼Œä¸€è¡Œä»£ç &lt;code&gt;ggtree(read.tree(file))&lt;/code&gt;å³å¯å®ç°æ ‘çš„å¯è§†åŒ–ã€‚è€Œæ³¨é‡Šé€šè¿‡å›¾å±‚æ¥å®ç°ï¼Œå¤šä¸ªå›¾å±‚å¯ä»¥å®Œæˆå¤æ‚çš„æ³¨é‡Šï¼Œè¿™å¾—åŠ›äº&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;çš„è®¾è®¡ã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯å¦‚ä½•æ¥è§£æè¿›åŒ–æ ‘ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ggtreeçš„è®¾è®¡:d1d9992be5d6848a0489ec268963cadb&#34;&gt;ggtreeçš„è®¾è®¡&lt;/h2&gt;

&lt;h3 id=&#34;è¿›åŒ–æ ‘çš„è§£æ:d1d9992be5d6848a0489ec268963cadb&#34;&gt;è¿›åŒ–æ ‘çš„è§£æ&lt;/h3&gt;

&lt;p&gt;é™¤äº†&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;ä¹‹å¤–ï¼Œæˆ‘æ‰€äº†è§£åˆ°çš„å…¶å®ƒç”»æ ‘è½¯ä»¶åœ¨ç”»æ ‘çš„æ—¶å€™éƒ½æŠŠæ ‘å½“æˆæ˜¯çº¿æ¡çš„é›†åˆã€‚å¾ˆæ˜æ˜¾ç”»å‡ºæ¥çš„è¿›åŒ–æ ‘å°±æ˜¯åœ¨ç”»ä¸€å †çº¿æ¡ï¼Œä½†æ˜¯çº¿æ¡è¡¨ç¤ºçš„æ˜¯çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„å…³ç³»ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œè€ŒèŠ‚ç‚¹åœ¨è¿›åŒ–æ ‘ä¸Šä»£è¡¨ç‰©ç§ï¼Œå¶å­èŠ‚ç‚¹æ˜¯æˆ‘ä»¬æ„å»ºè¿›åŒ–æ ‘çš„ç‰©ç§ï¼Œå†…éƒ¨èŠ‚ç‚¹æ˜¯æ ¹æ®å¶å­èŠ‚ç‚¹æ¨æ–­çš„å…±åŒç¥–å…ˆã€‚æˆ‘ä»¬æ‰€æœ‰çš„è¿›åŒ–åˆ†æã€æ¨æ–­ã€å®éªŒéƒ½æ˜¯é’ˆå¯¹èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æ‰æ˜¯è¿›åŒ–æ ‘ä¸Šæœ‰æ„ä¹‰çš„å®ä½“ã€‚è¿™æ˜¯&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;è®¾è®¡çš„åŸºç¡€ï¼Œ&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;åªæ˜ å°„èŠ‚ç‚¹åˆ°åæ ‡ç³»ç»Ÿä¸­ï¼Œè€Œçº¿æ¡åœ¨&lt;code&gt;geom_tree&lt;/code&gt;å›¾å±‚ä¸­è®¡ç®—å¹¶ç”»å‡ºæ¥ã€‚è¿™æ˜¯ä¸å…¶å®ƒè½¯ä»¶æœ€æ ¹æœ¬çš„ä¸åŒï¼Œä¹Ÿæ˜¯ggtreeèƒ½å¤Ÿç®€å•åœ°ç”¨å›¾å±‚åŠ æ³¨é‡Šä¿¡æ¯çš„åŸºç¡€ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ‰©å±•ggplot2:d1d9992be5d6848a0489ec268963cadb&#34;&gt;æ‰©å±•ggplot2&lt;/h3&gt;

&lt;p&gt;æœ‰å¾ˆå¤šå¯è§†åŒ–åŒ…åŸºäºggplot2å®ç°ï¼ŒåŒ…æ‹¬å„ç§&lt;code&gt;gg&lt;/code&gt;æ‰“å¤´çš„ï¼Œå·ç§°æ‰©å±•äº†ggplot2ï¼Œæ”¯æŒå›¾å½¢è¯­æ³•(grammar
of
graphics)ï¼Œæˆ‘å¹¶ä¸è®¤åŒã€‚è™½ç„¶åŸºäº&lt;code&gt;ggplot2&lt;/code&gt;äº§ç”Ÿçš„å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨&lt;code&gt;theme&lt;/code&gt;æ¥è¿›ä¸€æ­¥è°ƒæ•´ç»†èŠ‚ï¼Œç”¨&lt;code&gt;scale_&lt;/code&gt;ç³»åˆ—å‡½æ•°æ¥è°ƒæ•´é¢œè‰²å’Œæ ‡å°ºçš„æ˜ å°„ï¼Œä½†è¿™äº›ä¸è¶³ä»¥ç§°ä¹‹ä¸º&amp;rsquo;æ”¯æŒå›¾å½¢è¯­æ³•&amp;rsquo;ï¼Œå›¾å½¢è¯­æ³•æœ€å…³é”®æ ¸å¿ƒçš„éƒ¨åˆ†æˆ‘è®¤ä¸ºæ˜¯å›¾å±‚å’Œæ˜ å°„ã€‚&lt;/p&gt;

&lt;p&gt;åƒ&lt;code&gt;ggphylo&lt;/code&gt;,
&lt;code&gt;OutbreakTools&lt;/code&gt;å’Œ&lt;code&gt;phyloseq&lt;/code&gt;è¿™å‡ ä¸ªåŒ…éƒ½æœ‰åŸºäºggplot2çš„ç”»æ ‘å‡½æ•°ï¼Œä½†å…¶å®éƒ½ä¸æ”¯æŒå›¾å½¢è¯­æ³•ï¼Œå®ƒä»¬æ‰€å®ç°çš„æ˜¯å¤æ‚çš„å‡½æ•°ï¼Œç”»å®Œå°±å®Œäº‹äº†ï¼Œç”¨æˆ·å¹¶ä¸èƒ½ä½¿ç”¨å›¾å±‚æ¥æ·»åŠ ç›¸å…³çš„ä¿¡æ¯ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœåœ¨&lt;code&gt;OutbreakTools&lt;/code&gt;è¿™ä¸ªåŒ…ä¸­ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;if (show.tip.label) {
    p &amp;lt;- p + geom_text(data = df.tip, aes(x = x, y = y, label = label),
                       hjust = 0, size = tip.label.size)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœ&lt;code&gt;show.tip.label=FALSE&lt;/code&gt;ï¼Œå½“å‡½æ•°è¿”å›&lt;code&gt;p&lt;/code&gt;æ—¶&lt;code&gt;df.tip&lt;/code&gt;å°±è¢«æ‰”æ‰ï¼Œç”¨æˆ·æƒ³è¦å†åŠ &lt;code&gt;tip.label&lt;/code&gt;å°±ä¸å¯èƒ½äº†ã€‚&lt;code&gt;ggphylo&lt;/code&gt;å’Œ&lt;code&gt;phyloseq&lt;/code&gt;éƒ½æ˜¯ç±»ä¼¼çš„å®ç°ï¼Œè¿™äº›åŒ…æŠŠæ ‘è§£æä¸ºçº¿æ¡ï¼Œæ‰€ä»¥èŠ‚ç‚¹ç›¸å…³çš„ä¿¡æ¯éœ€è¦é¢å¤–çš„&lt;code&gt;data.frame&lt;/code&gt;æ¥å­˜å‚¨ï¼Œå¹¶ä¸”åªæœ‰æå°‘æ•°çš„é¢„è®¾å‚æ•°ï¼Œæ¯”å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„&lt;code&gt;tip.label&lt;/code&gt;ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”¨æˆ·è¿æ›´æ”¹&lt;code&gt;tip.label&lt;/code&gt;çš„é¢œè‰²éƒ½ä¸å¯èƒ½ï¼Œæ›´åˆ«è¯´ä½¿ç”¨é¢å¤–çš„æ³¨é‡Šä¿¡æ¯äº†ã€‚&lt;/p&gt;

&lt;p&gt;è¿™å‡ ä¸ªåŒ…æ‰€å®ç°çš„ç”»å›¾å‡½æ•°ï¼Œéƒ½å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨&lt;code&gt;ggtree&lt;/code&gt;å®ç°ï¼Œå¹¶ç”¨ç»è¿‡æµ‹è¯•ï¼Œggtreeè¿è¡Œé€Ÿåº¦æ¯”è¿™å‡ ä¸ªåŒ…éƒ½è¦å¿«ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/wiki/Why-ggtree-is-special%3F&#34;&gt;ggtreeçš„wikié¡µé¢&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ggtree&lt;/code&gt;æ˜¯çœŸæ­£æ‰©å±•&lt;code&gt;ggplot2&lt;/code&gt;ï¼Œæ”¯æŒå›¾å½¢è¯­æ³•çš„åŒ…ã€‚æˆ‘ä»¬é¦–å…ˆæ‰©å±•ggplotæ”¯æŒtree
objectåšä¸ºè¾“å…¥ï¼Œå¹¶å®ç°&lt;code&gt;geom_tree&lt;/code&gt;å›¾å±‚æ¥ç”»çº¿æ¡ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggplot2)
library(ggtree)
set.seed(2015-11-26)
tree &amp;lt;- rtree(30)
ggplot(tree, aes(x, y)) + geom_tree()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;ggtreeå‡½æ•°æ˜¯&lt;code&gt;ggplot() + geom_tree() + xlab(NA) + ylab(NA) + theme_tree()&lt;/code&gt;çš„ç®€å•ç»„åˆã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggtree(tree)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;æƒ³è¦åŠ &lt;code&gt;tip.label&lt;/code&gt;ï¼Œç”¨&lt;code&gt;geom_tiplab&lt;/code&gt;å›¾å±‚ï¼Œå¹¶ä¸”ggplot2çš„å›¾å±‚éƒ½å¯ä»¥ç›´æ¥åº”ç”¨äº&lt;code&gt;ggtree&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggtree(tree) + geom_tiplab() + geom_point(color=&#39;firebrick&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h2 id=&#34;æ ‘çš„æ“ä½œä¸æ³¨é‡Š:d1d9992be5d6848a0489ec268963cadb&#34;&gt;æ ‘çš„æ“ä½œä¸æ³¨é‡Š&lt;/h2&gt;

&lt;p&gt;ggtreeæä¾›äº†å¤šä¸ªå‡½æ•°å¯ä»¥æŠŠcladeæ”¾å¤§ç¼©å°(scaleClade)ï¼ŒæŠ˜å (collapse)å’Œå±•å¼€(expand)ï¼Œä½ç½®è°ƒæ¢å’Œæ—‹è½¬ï¼Œä»¥åŠåˆ†ç±»(groupOTU,
groupClade)ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nwk &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.nwk&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tree &amp;lt;- read.tree(nwk)
p &amp;lt;- ggtree(tree)
cp &amp;lt;- ggtree(tree) %&amp;gt;% collapse(node=21) + ggtitle(&#39;collapse&#39;)
ep &amp;lt;- cp %&amp;gt;% expand(node=21) + ggtitle(&#39;expand&#39;)
hp &amp;lt;- p + geom_hilight(node=21) + ggtitle(&#39;hilight&#39;)
rp &amp;lt;- hp %&amp;gt;% rotate(node=21) + ggtitle(&#39;rotate&#39;)
library(gridExtra)
grid.arrange(cp, ep, hp, rp, ncol=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h2 id=&#34;æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼:d1d9992be5d6848a0489ec268963cadb&#34;&gt;æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼&lt;/h2&gt;

&lt;p&gt;ggtreeæ”¯æŒçš„æ–‡ä»¶æ ¼å¼åŒ…æ‹¬Newick, Nexus, NHXå’Œjplaceã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šé¢å·²ç»å±•ç¤ºäº†Newickæ ¼å¼ï¼Œä¸‹é¢çš„ä¾‹å­æ˜¯NHXæ ¼å¼ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nhxfile = system.file(&amp;quot;extdata&amp;quot;, &amp;quot;ADH.nhx&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
nhx &amp;lt;- read.nhx(nhxfile)
ggtree(nhx, ladderize=F) + geom_tiplab() + geom_point(aes(color=S), size=8, alpha=.3) + 
    theme(legend.position=&amp;quot;right&amp;quot;) + 
        geom_text(aes(label=branch.length, x=branch), vjust=-.5) + 
           xlim(NA, 0.3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h2 id=&#34;æ”¯æŒè§£æå¤šç§è½¯ä»¶çš„è¾“å‡ºæ–‡ä»¶:d1d9992be5d6848a0489ec268963cadb&#34;&gt;æ”¯æŒè§£æå¤šç§è½¯ä»¶çš„è¾“å‡ºæ–‡ä»¶&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“FigTreeæ˜¯é’ˆå¯¹&lt;a href=&#34;http://guangchuangyu.github.io/2015/04/an-example-of-drawing-beast-tree-using-ggtree/&#34;&gt;BEAST&lt;/a&gt;çš„è¾“å‡ºè®¾è®¡çš„ï¼Œå¯ä»¥æŠŠBEASTçš„ç»Ÿè®¡æ¨æ–­æ‹¿æ¥ç»™æ ‘åšæ³¨é‡Šï¼Œä½†å¾ˆå¤šçš„è¿›åŒ–åˆ†æè½¯ä»¶å¹¶æ²¡æœ‰ç›¸åº”çš„ç”»æ ‘è½¯ä»¶æ”¯æŒï¼Œç”¨æˆ·å¾ˆéš¾æŠŠä¿¡æ¯å±•ç¤ºå‡ºæ¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ggtree&lt;/code&gt;æ”¯æŒ&lt;code&gt;ape&lt;/code&gt;, &lt;code&gt;phangorn&lt;/code&gt;, &lt;code&gt;r8s&lt;/code&gt;, &lt;code&gt;RAxML&lt;/code&gt;, &lt;code&gt;PAML&lt;/code&gt;, &lt;code&gt;HYPHY&lt;/code&gt;, &lt;code&gt;EPA&lt;/code&gt;,
&lt;code&gt;pplacer&lt;/code&gt;å’Œ&lt;code&gt;BEAST&lt;/code&gt;çš„è¾“å‡ºã€‚ç›¸åº”çš„ç»Ÿè®¡åˆ†æç»“æœå¯ä»¥åº”ç”¨äºæ ‘çš„æ³¨é‡Šã€‚å¯ä»¥è¯´&lt;code&gt;ggtree&lt;/code&gt;æŠŠè¿™äº›è½¯ä»¶åˆ†æçš„ç»“æœå¸¦ç»™äº†Rç”¨æˆ·ï¼Œé€šè¿‡ggtreeçš„è§£æï¼Œ
è¿™äº›è¿›åŒ–åˆ†æç»“æœå¯ä»¥è¿›ä¸€ç‚¹åœ¨Ré‡Œè¿›è¡Œå¤„ç†å’Œç»Ÿè®¡åˆ†æï¼Œå¹¶ä¸å•å•æ˜¯åœ¨ggtreeä¸­å±•ç¤ºè€Œå·²ã€‚&lt;/p&gt;

&lt;h3 id=&#34;raxml-bootstrapåˆ†æ:d1d9992be5d6848a0489ec268963cadb&#34;&gt;RAxML bootstrapåˆ†æ&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;raxml_file &amp;lt;- system.file(&amp;quot;extdata/RAxML&amp;quot;, &amp;quot;RAxML_bipartitionsBranchLabels.H3&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
raxml &amp;lt;- read.raxml(raxml_file)
ggtree(raxml) + geom_text(aes(label=bootstrap, color=bootstrap)) + 
    scale_color_gradient(high=&#39;red&#39;, low=&#39;darkgreen&#39;) + 
       theme(legend.position=&#39;right&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;multiPhylo&lt;/code&gt;ä¹Ÿæ˜¯æ”¯æŒçš„ï¼Œæ‰€ä»¥100é¢—bootstrapæ ‘å¯ä»¥åŒæ—¶ç”¨ä¸€è¡Œä»£ç å±•ç¤ºå‡ºæ¥ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;btree_file &amp;lt;- system.file(&amp;quot;extdata/RAxML&amp;quot;, &amp;quot;RAxML_bootstrap.H3&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
btree = read.tree(btree_file)
ggtree(btree) + facet_wrap(~.id, ncol=10)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœä¸åˆ†é¢ï¼Œè¿™100é¢—æ ‘ä¼šé‡å ç”»åœ¨ä¸€èµ·ï¼Œè¿™ä¹Ÿèƒ½å¾ˆå¥½åœ°å±•ç¤ºbootstrapåˆ†æçš„ç»“æœï¼Œbootstrapå€¼ä½çš„cladeï¼Œçº¿æ¡ä¼šæ¯”è¾ƒä¹±ï¼Œè€Œbootstrapå€¼é«˜çš„åœ°æ–¹ï¼Œçº¿æ¡ä¸€è‡´æ€§æ¯”è¾ƒå¥½ã€‚&lt;/p&gt;

&lt;h3 id=&#34;paml:d1d9992be5d6848a0489ec268963cadb&#34;&gt;PAML&lt;/h3&gt;

&lt;p&gt;ä½¿ç”¨BaseMLé¢„æµ‹çš„ç¥–å…ˆåºåˆ—ï¼Œggtreeè§£æç»“æœçš„åŒæ—¶ä¼šæŠŠçˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹çš„subsitutionç»™ç»Ÿè®¡å‡ºæ¥ï¼Œå¯ä»¥ç›´æ¥åœ¨æ ‘ä¸Šæ³¨é‡Šï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rstfile &amp;lt;- system.file(&amp;quot;extdata/PAML_Baseml&amp;quot;, &amp;quot;rst&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
rst &amp;lt;- read.paml_rst(rstfile)
p &amp;lt;- ggtree(rst) + geom_text(aes(label=marginal_AA_subs, x=branch), vjust=-.5)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-9-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;ä¸åŒäºBaseMLä»¥ç¢±åŸºä¸ºå•ä½ï¼ŒCodeMLé¢„æµ‹ç¥–å…ˆåºåˆ—ï¼Œä»¥å¯†ç å­ä¸ºå•ä½ã€‚&lt;code&gt;ggtree&lt;/code&gt;å®šä¹‰äº†ä¸€ä¸ªæ“ä½œç¬¦&lt;a href=&#34;http://guangchuangyu.github.io/2015/02/ggtree-updating-a-tree-view-using--operator/&#34;&gt;%&amp;lt;%&lt;/a&gt;ï¼Œå¦‚æœæœ‰ç›¸åŒçš„æ³¨é‡Šä¿¡æ¯è¦å±•ç¤ºï¼Œå¯ä»¥ç”¨tree
objectæ¥æ›´æ–°tree viewã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rstfile &amp;lt;- system.file(&amp;quot;extdata/PAML_Codeml&amp;quot;, &amp;quot;rst&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
crst &amp;lt;- read.paml_rst(rstfile)
p %&amp;lt;% crst
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-10-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;
åƒä¸Šé¢çš„ä¾‹å­ï¼Œç”¨&lt;code&gt;crst&lt;/code&gt;æ¥æ›´æ–°&lt;code&gt;p&lt;/code&gt;ï¼Œå°±æ˜¯ç”¨&lt;code&gt;crst&lt;/code&gt;ç”»å‡ºæ¥çš„æ ‘+æ³¨é‡Šã€‚å¯¹æ¯”ä¸¤å›¾ï¼Œå¯ä»¥å‘ç°BaseMLå’ŒCodeMLæ¨æµ‹çš„ç¥–å…ˆåºåˆ—æ˜¯ç¨æœ‰ä¸åŒçš„ã€‚&lt;/p&gt;

&lt;p&gt;CodeMLçš„dN/dSåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠæ•°æ®æ‹¿æ¥ç»™æ ‘ä¸Šè‰²ã€‚åŒæ ·é“ç†åˆ†ç±»æ•°æ®ä¹Ÿå¯ä»¥æ‹¿æ¥ä¸Šè‰²ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mlc_file &amp;lt;- system.file(&amp;quot;examples/mlc&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
mlc &amp;lt;- read.codeml_mlc(mlc_file) 
ggtree(mlc, aes(color=dN_vs_dS)) + 
   scale_color_continuous(limits=c(0, 1.5), high=&#39;red&#39;, low=&#39;green&#39;, oob=scales::squish, name=&#39;dN/dS&#39;) + 
      theme(legend.position=&#39;right&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-11-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h3 id=&#34;ä½¿ç”¨ç”¨æˆ·å®šä¹‰æ•°æ®:d1d9992be5d6848a0489ec268963cadb&#34;&gt;ä½¿ç”¨ç”¨æˆ·å®šä¹‰æ•°æ®&lt;/h3&gt;

&lt;p&gt;è¿›åŒ–æ ‘å·²ç»è¢«å¹¿æ³›åº”ç”¨äºå„ç§è·¨å­¦ç§‘çš„ç ”ç©¶ä¸­ï¼Œéšç€å®éªŒæŠ€æœ¯çš„å‘å±•ï¼Œå„ç§æ•°æ®ä¹Ÿæ›´æ˜“äºè·å¾—ï¼Œä½¿ç”¨ç”¨æˆ·æ•°æ®æ³¨é‡Šè¿›åŒ–æ ‘ï¼Œä¹Ÿæ˜¯ggtreeæ‰€æ”¯æŒçš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nwk &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.nwk&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tree &amp;lt;- read.tree(nwk)
p &amp;lt;- ggtree(tree)

dd &amp;lt;- data.frame(taxa  = LETTERS[1:13], 
             place = c(rep(&amp;quot;GZ&amp;quot;, 5), rep(&amp;quot;HK&amp;quot;, 3), rep(&amp;quot;CZ&amp;quot;, 4), NA),
                 value = round(abs(rnorm(13, mean=70, sd=10)), digits=1))
## you don&#39;t need to order the data
## data was reshuffled just for demonstration
dd &amp;lt;- dd[sample(1:13, 13), ]
row.names(dd) &amp;lt;- NULL
print(dd)

##    taxa place value
## 1     A    GZ  68.8
## 2     J    CZ  56.8
## 3     L    CZ  74.7
## 4     C    GZ  53.3
## 5     F    HK  62.8
## 6     B    GZ  60.8
## 7     E    GZ  87.1
## 8     M  &amp;lt;NA&amp;gt;  70.9
## 9     H    HK  67.0
## 10    G    HK  59.8
## 11    I    CZ  77.7
## 12    K    CZ  69.8
## 13    D    GZ  66.3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªåˆ†ç±»æ•°æ®å’Œä¸€ä¸ªè¿ç»­å‹æ•°æ®ï¼Œè¾“å…¥çš„å”¯ä¸€è¦æ±‚æ˜¯ç¬¬ä¸€åˆ—æ˜¯taxon
labelã€‚ggtreeä¸­å®šä¹‰äº†æ“ä½œç¬¦&lt;code&gt;%&amp;lt;+%&lt;/code&gt;ï¼Œæ¥æ·»åŠ æ•°æ®ã€‚æ·»åŠ ä¹‹åï¼Œç”¨æˆ·çš„æ•°æ®å¯¹ggplotæ˜¯å¯è§çš„ã€‚å¯ä»¥ç”¨äºæ ‘çš„æ³¨é‡Šã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- p %&amp;lt;+% dd + geom_text(aes(color=place, label=label), hjust=-0.5) + 
       geom_tippoint(aes(size=value, shape=place, color=place), alpha=0.25)
p+theme(legend.position=&amp;quot;right&amp;quot;)       
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-13-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;ggtreeè¿˜æ”¯æŒç”¨æˆ·æŠŠè‡ªå·±çš„æ•°æ®å’Œæ ‘ä¿å­˜ä¸ºjplaceæ ¼å¼ã€‚&lt;/p&gt;

&lt;p&gt;æ›´å¤šçš„å®ä¾‹è¯·å‚è€ƒ&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/vignettes/ggtree/inst/doc/ggtree.html#tree-annotation-with-output-from-evolution-software&#34;&gt;vignette&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ggtreeå…è®¸æŠŠä¸åŒè½¯ä»¶çš„åˆ†æç»“æœæ•´åˆåœ¨ä¸€èµ·ï¼ŒåŒæ—¶åœ¨æ ‘ä¸Šå±•ç¤ºæˆ–è€…æ¯”è¾ƒç»“æœã€‚åœ¨æˆ‘ä»¬æäº¤çš„è®ºæ–‡ä¸­ï¼Œä½¿ç”¨äº†æ•´åˆBEASTå’ŒCodeMLçš„ä¾‹å­ï¼Œåœ¨æ ‘ä¸Šå±•ç¤ºdN/dSã€æ—¶é—´è½´ã€æ°¨åŸºé…¸æ›¿æ¢ã€clade
support valuesã€ç‰©ç§å’ŒåŸºå› å‹
(genotypeï¼‰ç­‰å¤šç»´ä¿¡æ¯ï¼Œ6ç§ä¸åŒçš„ä¿¡æ¯åŒæ—¶å±•ç¤ºåœ¨ä¸€é¢—è¿›åŒ–æ ‘ä¸Šï¼Œè¿™æ˜¯ä¸ªå¤æ‚çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨é™„ä»¶1ä¸­å±•ç¤ºäº†å¯é‡å¤çš„ä»£ç ã€‚å¦‚æœæœ‰å…´è¶£ï¼Œå¯ä»¥ç•™æ„ä¸€ä¸‹æˆ‘ä»¬çš„æ–‡ç« ã€‚
:)&lt;/p&gt;

&lt;h2 id=&#34;å…¶å®ƒå¥½ç©çš„åŠŸèƒ½:d1d9992be5d6848a0489ec268963cadb&#34;&gt;å…¶å®ƒå¥½ç©çš„åŠŸèƒ½&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬æŠŠæ ‘å½“æˆèŠ‚ç‚¹çš„é›†åˆï¼Œè€Œä¸æ˜¯çº¿æ¡çš„é›†åˆï¼Œè¿™ä¸€ç‚¹å›å½’åˆ°äº†è¿›åŒ–æ ‘çš„æœ¬è´¨æ„ä¹‰ä¸Šï¼Œä½¿è¿™ä¸€å®ç°æˆä¸ºå¯èƒ½ã€‚è€Œæ”¯æŒå›¾å½¢è¯­æ³•ï¼Œä¸ggplot2çš„æ— ç¼è¡”æ¥åˆè®©æ³¨é‡Šå˜å¾—æ›´åŠ å®¹æ˜“ã€‚&lt;code&gt;ggtree&lt;/code&gt;ä¸ºæˆ‘ä»¬æ‰“å¼€äº†å„ç§æ³¨é‡Šå’Œæ“ä½œçš„å¯èƒ½æ€§ã€‚ç”šè‡³äºå¯ä»¥åˆ›é€ å‡ºå¥½ç©çš„å›¾ï¼Œæ¯”å¦‚ä½¿ç”¨showtextæ¥&lt;a href=&#34;http://guangchuangyu.github.io/2015/06/ggtree-with-funny-fonts/&#34;&gt;åŠ è½½å›¾å½¢åŒ–çš„å­—ä½“&lt;/a&gt;ã€&lt;a href=&#34;http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/&#34;&gt;ç”¨emojiæ¥ç”»æ ‘&lt;/a&gt;ã€&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/&#34;&gt;ä½¿ç”¨å›¾ç‰‡æ¥æ³¨é‡Šæ ‘&lt;/a&gt;ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒæ­£ç»åˆå¥½ç©çš„æ˜¯ä½¿ç”¨PhyloPicæ•°æ®åº“ä¸Šçš„å›¾å½¢ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pp &amp;lt;- ggtree(tree) %&amp;gt;% phylopic(&amp;quot;79ad5f09-cf21-4c89-8e7d-0c82a00ce728&amp;quot;, color=&amp;quot;steelblue&amp;quot;, alpha = .3)
pp + geom_tiplab(align=T, linetype=&#39;dashed&#39;, linesize=.5) + geom_tippoint(color=&#39;firebrick&#39;, size=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-14-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;å¦ä¸€ä¸ªå¥½ç©åˆä¸ºæˆ‘ä»¬å±•ç°å„ç§å¯èƒ½æ€§çš„æ˜¯&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt;å‡½æ•°ï¼Œå®ƒä½¿å¾—å›¾ä¸ŠåŠ å°å›¾å˜å¾—ç‰¹åˆ«å®¹æ˜“ã€‚å¹¶ä¸”å·²ç»è¢«åº”ç”¨äº&lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;åœ°å›¾ä¸ŠåŠ é¥¼å›¾&lt;/a&gt;ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„åˆè¡·åœ¨äºï¼Œæƒ³è¦ç»™èŠ‚ç‚¹åŠ é¥¼å›¾æ³¨é‡Šã€‚æœ‰äº†subviewå‡½æ•°ä¹‹åï¼Œè¿™ä¼šå˜å¾—å¾ˆå®¹æ˜“ï¼Œå½“ç„¶æˆ‘è¿˜æ²¡æœ‰å†™å‡ºç»™èŠ‚ç‚¹åŠ é¥¼å›¾çš„å‡½æ•°ï¼Œå› ä¸ºæˆ‘è¿˜æ²¡æœ‰è¿™ä¸ªéœ€æ±‚ï¼Œå¾—æœ‰ä¸€äº›å®é™…çš„æ•°æ®åšå‚è€ƒï¼Œè¿™æ ·æ‰èƒ½å¤Ÿè®¾è®¡å‡ºæ›´æ˜“ç”¨çš„å‡½æ•°å‘ˆç°ç»™ç”¨æˆ·ã€‚&lt;/p&gt;

&lt;p&gt;å¾ˆå¤šçš„åŠŸèƒ½è¿˜åœ¨å¼€å‘ä¹‹ä¸­ï¼Œæœ‰é—®é¢˜/å»ºè®®è¯·åŠæ—¶åœ¨&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues&#34;&gt;Github&lt;/a&gt;ä¸ŠæŠ¥å‘Š(ä¸­è‹±æ–‡éƒ½å¯ä»¥)ã€‚&lt;/p&gt;

&lt;h2 id=&#34;citation:d1d9992be5d6848a0489ec268963cadb&#34;&gt;Citation&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;G Yu&lt;/strong&gt;, DK Smith, H Zhu, Y Guan, TTY Lam&lt;sup&gt;*&lt;/sup&gt;. &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12628/abstract&#34;&gt;ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data&lt;/a&gt;. &lt;strong&gt;&lt;em&gt;Methods in Ecology and Evolution&lt;/em&gt;&lt;/strong&gt;. &lt;a href=&#34;http://dx.doi.org/10.1111/2041-210X.12628&#34;&gt;&lt;code&gt;doi:10.1111/2041-210X.12628&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;script type=&#34;text/javascript&#34; src=&#34;https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js&#34;&gt;&lt;/script&gt;
&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/2041-210X.12628&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•ç”»ç±»ä¼¼MEMEçš„æ³¨é‡Šåºåˆ—</title>
      <link>https://guangchuangyu.github.io/cn/2015/05/%E5%A6%82%E4%BD%95%E7%94%BB%E7%B1%BB%E4%BC%BCmeme%E7%9A%84%E6%B3%A8%E9%87%8A%E5%BA%8F%E5%88%97/</link>
      <pubDate>Thu, 21 May 2015 14:53:35 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2015/05/%E5%A6%82%E4%BD%95%E7%94%BB%E7%B1%BB%E4%BC%BCmeme%E7%9A%84%E6%B3%A8%E9%87%8A%E5%BA%8F%E5%88%97/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2015/Screenshot%202015-05-21%2010.31.46.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://meme-suite.org&#34;&gt;MEME&lt;/a&gt;æ˜¯motifåˆ†æçš„webserverï¼Œæ‰€è°“çš„æ³¨é‡Šåºåˆ—å°±æ˜¯ä¸€æ¡çº¿æ¡ä¸Šç”»ä¸€äº›é•¿æ–¹å½¢çš„boxã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2015/Screenshot%202015-05-20%2020.50.54.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å½“æœ‰äººé—®Ræ˜¯å¦å¯ä»¥ç”»çš„æ—¶å€™ï¼Œä½ å›ç­”è¯´å¯ä»¥ï¼Œä»–ç«‹é©¬å°±ä¼šé—®ï¼Œä»€ä¹ˆå‡½æ•°ï¼è¿™æ‰æ˜¯ä»–æƒ³è¦é—®çš„ã€‚è¿™æ­£å¥½ä¸­äº†æˆ‘çš„æ§½ç‚¹ï¼Œå¾ˆå¤šäººéƒ½è®¤ä¸ºRæ˜¯ä¸ªmagic boxï¼Œ
æœ‰å„ç§å„æ ·çš„magic packages/functionsï¼Œç„¶åinput-&amp;gt;output-&amp;gt;done!&lt;/p&gt;

&lt;p&gt;å½“magicä¸å­˜åœ¨çš„æ—¶å€™ï¼Œé‚£å°±æ˜¯crapã€‚é¡ºé“åæ§½ä¸€ä¸‹ï¼Œä¸ç»™ä¸ªå››å››æ–¹æ–¹çš„æ•°æ®ï¼Œå¾ˆå¤šäººéƒ½ä¸çŸ¥é“è¯¥æ€ä¹ˆè¯»äº†ï¼Œåæ§½å½’åæ§½ï¼Œè¿˜æ˜¯è¦å‘Šè¯‰ä»–æ€ä¹ˆå»ç”»ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2015/Screenshot%202015-05-20%2020.51.22.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;äº‹å®è¯æ˜æˆ‘åæ§½çš„ç°è±¡æ˜¯å¤šä¹ˆæ™®éï¼Œä¸‹é¢ç»§ç»­æœ‰äººåœ¨è¯ é‡Šæˆ‘çš„æ§½ç‚¹ï¼Œä»–ä»¬éœ€è¦çš„æ˜¯ç¥å¥‡çš„å‡½æ•°ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2015/Screenshot%202015-05-20%2020.52.31.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰€è°“åæ§½åå…¨å¥—ï¼Œæ—¢ç„¶è¿™æ ·ï¼Œæˆ‘åªèƒ½ç¢¾å‹ä»–ä»¬ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2015/Screenshot%202015-05-20%2015.17.08.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Use ggplot2</title>
      <link>https://guangchuangyu.github.io/cn/2014/05/use-ggplot2/</link>
      <pubDate>Sun, 11 May 2014 06:17:56 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2014/05/use-ggplot2/</guid>
      <description>

&lt;h3 id=&#34;why-use-ggplot2:c38c63fac86d2290b6bc01da39216614&#34;&gt;Why use ggplot2&lt;/h3&gt;

&lt;p&gt;ggplot2æ˜¯æˆ‘è§è¿‡æœ€human friendlyçš„ç”»å›¾è½¯ä»¶ï¼Œè¿™å¾—ç›ŠäºLeland Wilkinsonåœ¨ä»–çš„è‘—ä½œã€Š&lt;a href=&#34;http://book.douban.com/subject/10123863/&#34;&gt;The Grammar of Graphics&lt;/a&gt;ã€‹ä¸­æå‡ºäº†ä¸€å¥—å›¾å½¢è¯­æ³•ï¼ŒæŠŠå›¾å½¢å…ƒç´ æŠ½è±¡æˆå¯ä»¥è‡ªç”±ç»„åˆçš„æˆåˆ†ï¼ŒHadley
WickhamæŠŠè¿™å¥—æƒ³æ³•åœ¨Rä¸­å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºä»€ä¹ˆè¦å­¦ä¹ ggplot2ï¼Œå¯ä»¥å‚è€ƒ&lt;a href=&#34;http://book.douban.com/subject/24527091/&#34;&gt;ggplot2: æ•°æ®åˆ†æä¸å›¾å½¢è‰ºæœ¯&lt;/a&gt;çš„&lt;a href=&#34;https://github.com/cosname/ggplot2-translation/blob/master/preface.md&#34;&gt;åºè¨€&lt;/a&gt;ï¼ˆbtw: åœ¨åºè¨€çš„æœ€åï¼Œæˆ‘è¢«è‡´è°¢äº†ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;Hadley Wickhamä¹Ÿç»™å‡º&lt;a href=&#34;https://github.com/hadley/ggplot2/wiki/Why-use-ggplot2&#34;&gt;ä¸€å †ç†ç”±&lt;/a&gt;è®©æˆ‘ä»¬è¯´æœè‡ªå·±ï¼Œæˆ‘æƒ³å†è¡¥å……ä¸€ç‚¹ï¼ŒHadley Wickhamæ˜¯å­¦åŒ»å‡ºèº«çš„ï¼Œåšä¸ºå­¦ç”Ÿç‰©å‡ºèº«çš„äººæœ‰ä»€ä¹ˆç†ç”±ä¸æ”¯æŒå‘¢:)&lt;/p&gt;

&lt;p&gt;ggplot2åŸºæœ¬è¦ç´ &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ•°æ®ï¼ˆDataï¼‰å’Œæ˜ å°„ï¼ˆMappingï¼‰&lt;/li&gt;
&lt;li&gt;å‡ ä½•å¯¹è±¡ï¼ˆGeometricï¼‰&lt;/li&gt;
&lt;li&gt;æ ‡å°ºï¼ˆScaleï¼‰&lt;/li&gt;
&lt;li&gt;ç»Ÿè®¡å˜æ¢ï¼ˆStatisticsï¼‰&lt;/li&gt;
&lt;li&gt;åæ ‡ç³»ç»Ÿï¼ˆCoordinanteï¼‰&lt;/li&gt;
&lt;li&gt;å›¾å±‚ï¼ˆLayerï¼‰&lt;/li&gt;
&lt;li&gt;åˆ†é¢ï¼ˆFacetï¼‰&lt;/li&gt;
&lt;li&gt;ä¸»é¢˜ï¼ˆThemeï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™é‡Œå°†ä»è¿™äº›åŸºæœ¬è¦ç´ å¯¹ggplot2è¿›è¡Œä»‹ç»ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ•°æ®-data-å’Œæ˜ å°„-mapping:c38c63fac86d2290b6bc01da39216614&#34;&gt;æ•°æ®ï¼ˆDataï¼‰å’Œæ˜ å°„ï¼ˆMapping)&lt;/h3&gt;

&lt;p&gt;ä¸‹é¢ä»¥ä¸€ä»½é’»çŸ³çš„æ•°æ®ä¸ºä¾‹ï¼Œè¿™ä»½æ•°æ®éå¸¸å¤§ï¼Œéšæœºå–ä¸€ä¸ªå­é›†æ¥ç”»å›¾ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;require(ggplot2)
data(diamonds)
set.seed(42)
small &amp;lt;- diamonds[sample(nrow(diamonds), 1000), ]
head(small)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##       carat       cut color clarity depth table price    x    y    z
## 49345  0.71 Very Good     H     SI1  62.5    60  2096 5.68 5.75 3.57
## 50545  0.79   Premium     H     SI1  61.8    59  2275 5.97 5.91 3.67
## 15434  1.03     Ideal     F     SI1  62.4    57  6178 6.48 6.44 4.03
## 44792  0.50     Ideal     E     VS2  62.2    54  1624 5.08 5.11 3.17
## 34614  0.27     Ideal     E     VS1  61.6    56   470 4.14 4.17 2.56
## 27998  0.30   Premium     E     VS2  61.7    58   658 4.32 4.34 2.67
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;summary(small)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##      carat              cut      color      clarity        depth     
##  Min.   :0.220   Fair     : 28   D:121   SI1    :258   Min.   :55.2  
##  1st Qu.:0.400   Good     : 88   E:186   VS2    :231   1st Qu.:61.0  
##  Median :0.710   Very Good:227   F:164   SI2    :175   Median :61.8  
##  Mean   :0.819   Premium  :257   G:216   VS1    :141   Mean   :61.7  
##  3rd Qu.:1.070   Ideal    :400   H:154   VVS2   : 91   3rd Qu.:62.5  
##  Max.   :2.660                   I:106   VVS1   : 67   Max.   :72.2  
##                                  J: 53   (Other): 37                 
##      table          price             x              y       
##  Min.   :50.1   Min.   :  342   Min.   :3.85   Min.   :3.84  
##  1st Qu.:56.0   1st Qu.:  990   1st Qu.:4.74   1st Qu.:4.76  
##  Median :57.0   Median : 2595   Median :5.75   Median :5.78  
##  Mean   :57.4   Mean   : 4111   Mean   :5.79   Mean   :5.79  
##  3rd Qu.:59.0   3rd Qu.: 5495   3rd Qu.:6.60   3rd Qu.:6.61  
##  Max.   :65.0   Max.   :18795   Max.   :8.83   Max.   :8.87  
##                                                              
##        z       
##  Min.   :2.33  
##  1st Qu.:2.92  
##  Median :3.55  
##  Mean   :3.57  
##  3rd Qu.:4.07  
##  Max.   :5.58  
## 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç”»å›¾å®é™…ä¸Šæ˜¯æŠŠæ•°æ®ä¸­çš„å˜é‡æ˜ å°„åˆ°å›¾å½¢å±æ€§ä¸Šã€‚ä»¥å…‹æ‹‰(carat)æ•°ä¸ºXè½´å˜é‡ï¼Œä»·æ ¼(price)ä¸ºYè½´å˜é‡ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- ggplot(data = small, mapping = aes(x = carat, y = price))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸Šé¢è¿™è¡Œä»£ç æŠŠæ•°æ®æ˜ å°„XYåæ ‡è½´ä¸Šï¼Œéœ€è¦å‘Šè¯‰ggplot2ï¼Œè¿™äº›æ•°æ®è¦æ˜ å°„æˆä»€ä¹ˆæ ·çš„å‡ ä½•å¯¹è±¡ï¼Œä¸‹é¢ä»¥æ•£ç‚¹ä¸ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p + geom_point()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å‡ ä½•å¯¹è±¡å°†åœ¨ä¸‹é¢çš„å°èŠ‚ä»‹ç»ï¼Œè¿™ä¸€èŠ‚ï¼Œå…³æ³¨çš„æ˜¯æ•°æ®å’Œå›¾å½¢å±æ€§ä¹‹é—´çš„æ˜ å°„ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæƒ³å°†åˆ‡å·¥ï¼ˆcutï¼‰æ˜ å°„åˆ°å½¢çŠ¶å±æ€§ã€‚åªéœ€è¦ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- ggplot(data=small, mapping=aes(x=carat, y=price, shape=cut))
p+geom_point()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å†æ¯”å¦‚æˆ‘æƒ³å°†é’»çŸ³çš„é¢œè‰²ï¼ˆcolorï¼‰æ˜ å°„é¢œè‰²å±æ€§ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- ggplot(data=small, mapping=aes(x=carat, y=price, shape=cut, colour=color))
p+geom_point()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;å‡ ä½•å¯¹è±¡-geometric:c38c63fac86d2290b6bc01da39216614&#34;&gt;å‡ ä½•å¯¹è±¡ï¼ˆGeometricï¼‰&lt;/h3&gt;

&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå„ç§å±æ€§æ˜ å°„ç”±ggplotå‡½æ•°æ‰§è¡Œï¼Œåªéœ€è¦åŠ ä¸€ä¸ªå›¾å±‚ï¼Œä½¿ç”¨geom_point()å‘Šè¯‰ggplotè¦ç”»æ•£ç‚¹ï¼Œäºæ˜¯æ‰€æœ‰çš„å±æ€§éƒ½æ˜ å°„åˆ°æ•£ç‚¹ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;geom_point()å®Œæˆçš„å°±æ˜¯å‡ ä½•å¯¹è±¡çš„æ˜ å°„ï¼Œggplot2æä¾›äº†å„ç§å‡ ä½•å¯¹è±¡æ˜ å°„ï¼Œå¦‚geom_histogramç”¨äºç›´æ–¹å›¾ï¼Œgeom_barç”¨äºç”»æŸ±çŠ¶å›¾ï¼Œgeom_boxplotç”¨äºç”»ç®±å¼å›¾ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ä¸åŒçš„å‡ ä½•å¯¹è±¡ï¼Œè¦æ±‚çš„å±æ€§ä¼šæœ‰äº›ä¸åŒï¼Œè¿™äº›å±æ€§ä¹Ÿå¯ä»¥åœ¨å‡ ä½•å¯¹è±¡æ˜ å°„æ—¶æä¾›ï¼Œæ¯”å¦‚ä¸Šä¸€å›¾ï¼Œä¹Ÿå¯ä»¥ç”¨ä»¥ä¸‹è¯­æ³•æ¥ç”»ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- ggplot(small)
p+geom_point(aes(x=carat, y=price, shape=cut, colour=color))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ggplot2æ”¯æŒå›¾å±‚ï¼Œæˆ‘é€šå¸¸æŠŠä¸åŒçš„å›¾å±‚ä¸­å…±ç”¨çš„æ˜ å°„æä¾›ç»™ggplotå‡½æ•°ï¼Œè€ŒæŸä¸€å‡ ä½•å¯¹è±¡æ‰éœ€è¦çš„æ˜ å°„å‚æ•°æä¾›ç»™geom_xxxå‡½æ•°ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸€å°èŠ‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å„ç§å¸¸ç”¨çš„å‡ ä½•å¯¹è±¡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ç›´æ–¹å›¾&lt;/strong&gt; ç›´æ–¹å›¾æœ€å®¹æ˜“ï¼Œæä¾›ä¸€ä¸ªxå˜é‡ï¼Œç”»å‡ºæ•°æ®çš„åˆ†å¸ƒã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_histogram(aes(x=price))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig4.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åŒæ ·å¯ä»¥æ ¹æ®å¦å¤–çš„å˜é‡ç»™å®ƒå¡«å……é¢œè‰²ï¼Œæ¯”å¦‚æŒ‰ä¸åŒçš„åˆ‡å·¥ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_histogram(aes(x=price, fill=cut))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig5.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¹Ÿå¯ä»¥å°†å…¶åˆ†å¼€ï¼Œside-by-sideåœ°ç”»ç›´æ–¹å›¾ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_histogram(aes(x=price, fill=cut), position=&amp;quot;dodge&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig6.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿˜å¯ä»¥ä½¿ç”¨position=&amp;ldquo;fill&amp;rdquo;ï¼ŒæŒ‰ç…§ç›¸å¯¹æ¯”ä¾‹æ¥ç”»ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_histogram(aes(x=price, fill=cut), position=&amp;quot;fill&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig7.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æŸ±çŠ¶å›¾&lt;/strong&gt;
æŸ±çŠ¶å›¾éå¸¸é€‚åˆäºç”»åˆ†ç±»å˜é‡ã€‚åœ¨è¿™é‡Œä»¥é€æ˜åº¦ï¼ˆclarityï¼‰å˜é‡ä¸ºä¾‹ã€‚æŒ‰ç…§ä¸åŒé€æ˜åº¦çš„é’»çŸ³çš„æ•°ç›®ç”»æŸ±çŠ¶å›¾ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_bar(aes(x=clarity))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig8.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æŸ±çŠ¶å›¾ä¸¤ä¸ªè¦ç´ ï¼Œä¸€ä¸ªæ˜¯åˆ†ç±»å˜é‡ï¼Œä¸€ä¸ªæ˜¯æ•°ç›®ï¼Œä¹Ÿå°±æ˜¯æŸ±å­çš„é«˜åº¦ã€‚æ•°ç›®åœ¨è¿™é‡Œä¸ç”¨æä¾›ï¼Œå› ä¸ºggplot2ä¼šé€šè¿‡xå˜é‡è®¡ç®—å„ä¸ªåˆ†ç±»çš„æ•°ç›®ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ä½ æƒ³æä¾›ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œé€šè¿‡statå‚æ•°ï¼Œå¯ä»¥è®©geom_baræŒ‰æŒ‡å®šé«˜åº¦ç”»å›¾ï¼Œæ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot()+geom_bar(aes(x=c(LETTERS[1:3]),y=1:3), stat=&amp;quot;identity&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig24.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æŸ±çŠ¶å›¾å’Œç›´æ–¹å›¾æ˜¯å¾ˆåƒçš„ï¼Œç›´æ–¹å›¾æŠŠè¿ç»­å‹çš„æ•°æ®æŒ‰ç…§ä¸€ä¸ªä¸ªç­‰é•¿çš„åˆ†åŒºï¼ˆbinï¼‰æ¥åˆ‡åˆ†ï¼Œç„¶åè®¡æ•°ï¼Œç”»æŸ±çŠ¶å›¾ã€‚è€ŒæŸ±çŠ¶å›¾æ˜¯åˆ†ç±»æ•°æ®ï¼ŒæŒ‰ç±»åˆ«è®¡æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‰é¢ç›´æ–¹å›¾çš„å‚æ•°æ¥ç”»side-by-sideçš„æŸ±çŠ¶å›¾ï¼Œå¡«å……é¢œè‰²æˆ–è€…æŒ‰æ¯”ä¾‹ç”»å›¾ï¼Œå®ƒä»¬æ˜¯é«˜åº¦ä¸€è‡´çš„ã€‚&lt;/p&gt;

&lt;p&gt;æŸ±çŠ¶å›¾æ˜¯ç”¨æ¥è¡¨ç¤ºè®¡æ•°æ•°æ®çš„ï¼Œä½†åœ¨ç”Ÿç‰©ç•Œå´è¢«ç»å¸¸æ‹¿æ¥è¡¨ç¤ºå‡å€¼ï¼ŒåŠ ä¸Šè¯¯å·®æ¥è¡¨ç¤ºæ•°æ®åˆ†å¸ƒï¼Œè¿™å¯ä»¥é€šå¸¸å›¾å±‚æ¥å®ç°ï¼Œæˆ‘å°†åœ¨å›¾å±‚ä¸€èŠ‚ä¸­ç»™å‡ºå®ä¾‹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¯†åº¦å‡½æ•°å›¾&lt;/strong&gt;
è¯´åˆ°ç›´æ–¹å›¾ï¼Œå°±ä¸å¾—ä¸è¯´å¯†åº¦å‡½æ•°å›¾ï¼Œæ•°æ®å’Œæ˜ å°„å’Œç›´æ–¹å›¾æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯å‡ ä½•å¯¹è±¡ï¼Œgeom_histogramå‘Šè¯‰ggplotè¦ç”»ç›´æ–¹å›¾ï¼Œè€Œgeom_densityåˆ™è¯´æˆ‘ä»¬è¦ç”»å¯†åº¦å‡½æ•°å›¾ï¼Œåœ¨æˆ‘ä»¬ç†Ÿæ‚‰å‰é¢è¯­æ³•çš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“ç”»å‡ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_density(aes(x=price, colour=cut))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig9.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_density(aes(x=price,fill=clarity))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig10.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;colourå‚æ•°æŒ‡å®šçš„æ˜¯æ›²çº¿çš„é¢œè‰²ï¼Œè€Œfillæ˜¯å¾€æ›²çº¿ä¸‹é¢å¡«å……é¢œè‰²ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ç®±å¼å›¾&lt;/strong&gt;
æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œç”¨ç›´æ–¹å›¾å’Œå¯†åº¦å‡½æ•°å›¾æ˜¯è¡¨ç¤ºæ•°æ®åˆ†å¸ƒçš„å¥½æ–¹æ³•ï¼Œè€Œåœ¨æ•°æ®é‡è¾ƒå°‘çš„æ—¶å€™ï¼Œæ¯”å¦‚å¾ˆå¤šçš„ç”Ÿç‰©å®éªŒï¼Œå¾ˆå¤šæ—¶å€™å¤§å®¶éƒ½æ˜¯ä½¿ç”¨æŸ±çŠ¶å›¾+errorbarçš„å½¢å¼æ¥è¡¨ç¤ºï¼Œä¸è¿‡è¿™ç§æ–¹æ³•çš„ä¿¡æ¯é‡éå¸¸ä½ï¼Œè¢«&lt;a href=&#34;http://guangchuangyu.github.io/2014/03/boxplot/&#34;&gt;Nature Methodsåæ§½&lt;/a&gt;ï¼Œè¿™ç§æƒ…å†µæ¨èä½¿ç”¨boxplotã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_boxplot(aes(x=cut, y=price,fill=color))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;geom_boxplotå°†æ•°æ®æ˜ å°„åˆ°ç®±å¼å›¾ä¸Šï¼Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬åº”è¯¥å¾ˆç†Ÿæ‚‰äº†ï¼ŒæŒ‰åˆ‡å·¥(cut)åˆ†ç±»ï¼Œå¯¹ä»·æ ¼(price)å˜é‡ç”»ç®±å¼å›¾ï¼Œå†åˆ†å¼€æŒ‰ç…§colorå˜é‡å¡«å……é¢œè‰²ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig11.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ggplot2æä¾›äº†å¾ˆå¤šçš„geom_xxxå‡½æ•°ï¼Œå¯ä»¥æ»¡è¶³æˆ‘ä»¬å¯¹å„ç§å›¾å½¢ç»˜åˆ¶çš„éœ€æ±‚ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;geom_abline     geom_area   
geom_bar        geom_bin2d
geom_blank      geom_boxplot    
geom_contour    geom_crossbar
geom_density    geom_density2d  
geom_dotplot    geom_errorbar
geom_errorbarh  geom_freqpoly   
geom_hex        geom_histogram
geom_hline      geom_jitter     
geom_line       geom_linerange
geom_map        geom_path   
geom_point      geom_pointrange
geom_polygon    geom_quantile   
geom_raster     geom_rect
geom_ribbon     geom_rug    
geom_segment    geom_smooth
geom_step       geom_text   
geom_tile       geom_violin
geom_vline
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;æ ‡å°º-scale:c38c63fac86d2290b6bc01da39216614&#34;&gt;æ ‡å°ºï¼ˆScaleï¼‰&lt;/h3&gt;

&lt;p&gt;å‰é¢æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ï¼Œç”»å›¾å°±æ˜¯åœ¨åšæ˜ å°„ï¼Œä¸ç®¡æ˜¯æ˜ å°„åˆ°ä¸åŒçš„å‡ ä½•å¯¹è±¡ä¸Šï¼Œè¿˜æ˜¯æ˜ å°„å„ç§å›¾å½¢å±æ€§ã€‚è¿™ä¸€å°èŠ‚ä»‹ç»æ ‡å°ºï¼Œåœ¨å¯¹å›¾å½¢å±æ€§è¿›è¡Œæ˜ å°„ä¹‹åï¼Œä½¿ç”¨æ ‡å°ºå¯ä»¥æ§åˆ¶è¿™äº›å±æ€§çš„æ˜¾ç¤ºæ–¹å¼ï¼Œæ¯”å¦‚åæ ‡åˆ»åº¦ï¼Œå¯èƒ½é€šè¿‡æ ‡å°ºï¼Œå°†åæ ‡è¿›è¡Œå¯¹æ•°å˜æ¢ï¼›æ¯”å¦‚é¢œè‰²å±æ€§ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ ‡å°ºï¼Œè¿›è¡Œæ”¹å˜ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_point(aes(x=carat, y=price, shape=cut, colour=color))+scale_y_log10()+scale_colour_manual(values=rainbow(7))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig12.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä»¥æ•°æ®ï¼ˆDataï¼‰å’Œæ˜ å°„ï¼ˆMapping)ä¸€èŠ‚ä¸­æ‰€ç”»æ•£ç‚¹å›¾ä¸ºä¾‹ï¼Œå°†Yè½´åæ ‡è¿›è¡Œlog10å˜æ¢ï¼Œå†è‡ªå·±å®šä¹‰é¢œè‰²ä¸ºå½©è™¹è‰²ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç»Ÿè®¡å˜æ¢-statistics:c38c63fac86d2290b6bc01da39216614&#34;&gt;ç»Ÿè®¡å˜æ¢ï¼ˆStatisticsï¼‰&lt;/h3&gt;

&lt;p&gt;ç»Ÿè®¡å˜æ¢å¯¹åŸå§‹æ•°æ®è¿›è¡ŒæŸç§è®¡ç®—ï¼Œç„¶ååœ¨å›¾ä¸Šè¡¨ç¤ºå‡ºæ¥ï¼Œä¾‹å¦‚å¯¹æ•£ç‚¹å›¾ä¸ŠåŠ ä¸€æ¡å›å½’çº¿ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small, aes(x=carat, y=price))+geom_point()+scale_y_log10()+stat_smooth()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig13.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™é‡Œå°±ä¸æŒ‰é¢œè‰²ã€åˆ‡å·¥æ¥åˆ†äº†ï¼Œä¸ç„¶ggplotä¼šæŒ‰ä¸åŒçš„åˆ†ç±»å˜é‡åˆ†åˆ«åšå›å½’ï¼Œå›¾å°±å¾ˆä¹±ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ†é¢ï¼Œè¿™ä¸ªå°†åœ¨åé¢ä»‹ç»ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œï¼Œaesæ‰€æä¾›çš„å‚æ•°ï¼Œå°±é€šè¿‡ggplotæä¾›ï¼Œè€Œä¸æ˜¯æä¾›ç»™geom_pointï¼Œå› ä¸ºggploté‡Œçš„å‚æ•°ï¼Œç›¸å½“äºå…¨å±€å˜é‡ï¼Œgeom_point()å’Œstat_smooth()éƒ½çŸ¥é“x,yçš„æ˜ å°„ï¼Œå¦‚æœåªæä¾›ç»™geom_point()ï¼Œåˆ™ç›¸å½“äºæ˜¯å±€éƒ¨å˜é‡ï¼Œgeom_pointçŸ¥é“è¿™ç§æ˜ å°„ï¼Œè€Œstat_smoothä¸çŸ¥é“ï¼Œå½“ç„¶ä½ å†ç»™stat_smoothä¹Ÿæä¾›x,yçš„æ˜ å°„ï¼Œä¸è¿‡å…±ç”¨çš„æ˜ å°„ï¼Œè¿˜æ˜¯æä¾›ç»™ggplotå¥½ã€‚
ggplot2æä¾›äº†å¤šç§ç»Ÿè®¡å˜æ¢æ–¹å¼ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;stat_abline       stat_contour      stat_identity     stat_summary
stat_bin          stat_density      stat_qq           stat_summary2d
stat_bin2d        stat_density2d    stat_quantile     stat_summary_hex
stat_bindot       stat_ecdf         stat_smooth       stat_unique
stat_binhex       stat_function     stat_spoke        stat_vline
stat_boxplot      stat_hline        stat_sum          stat_ydensity
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç»Ÿè®¡å˜æ¢æ˜¯éå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å†™å‡½æ•°ï¼ŒåŸºäºåŸå§‹æ•°æ®åšæŸç§è®¡ç®—ï¼Œå¹¶åœ¨å›¾ä¸Šè¡¨ç°å‡ºæ¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ƒæ”¹å˜geom_xxxå‡½æ•°ç”»å›¾çš„é»˜è®¤ç»Ÿè®¡å‚æ•°ã€‚
æ¯”å¦‚æˆ‘åœ¨&lt;a href=&#34;http://www.sciencedirect.com/science/article/pii/S1874391912007567&#34;&gt;Proteomic investigation of the interactome of FMNL1 in hematopoietic cells unveils a role in calcium-dependent membrane plasticity&lt;/a&gt;çš„å›¾ä¸€ä¸­ï¼Œå°±æŠŠboxplotçš„ä¸­ä½çº¿æ›¿æ¢æˆäº†å¹³å‡å€¼æ¥ä½œå›¾ã€‚&lt;/p&gt;

&lt;h3 id=&#34;åæ ‡ç³»ç»Ÿ-coordinante:c38c63fac86d2290b6bc01da39216614&#34;&gt;åæ ‡ç³»ç»Ÿï¼ˆCoordinanteï¼‰&lt;/h3&gt;

&lt;p&gt;åæ ‡ç³»ç»Ÿæ§åˆ¶åæ ‡è½´ï¼Œå¯ä»¥è¿›è¡Œå˜æ¢ï¼Œä¾‹å¦‚XYè½´ç¿»è½¬ï¼Œç¬›å¡å°”åæ ‡å’Œæåæ ‡è½¬æ¢ï¼Œä»¥æ»¡è¶³æˆ‘ä»¬çš„å„ç§éœ€æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;åæ ‡è½´ç¿»è½¬ç”±coord_flip()å®ç°&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_bar(aes(x=cut, fill=cut))+coord_flip()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig14.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è€Œè½¬æ¢æˆæåæ ‡å¯ä»¥ç”±coord_polar()å®ç°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_bar(aes(x=factor(1), fill=cut))+coord_polar(theta=&amp;quot;y&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2.fig15.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¹‹å‰ä»‹ç»å¸¸ç”¨å›¾å½¢ç”»æ³•æ—¶æ²¡æœ‰æåŠé¥¼å›¾çš„åŸå› ï¼Œé¥¼å›¾å®é™…ä¸Šå°±æ˜¯æŸ±çŠ¶å›¾ï¼Œåªä¸è¿‡æ˜¯ä½¿ç”¨æåæ ‡è€Œå·²ï¼ŒæŸ±çŠ¶å›¾çš„é«˜åº¦ï¼Œå¯¹åº”äºé¥¼å›¾çš„å¼§åº¦ï¼Œé¥¼å›¾å¹¶ä¸æ¨èï¼Œå› ä¸ºäººç±»çš„çœ¼ç›æ¯”è¾ƒå¼§åº¦çš„èƒ½åŠ›æ¯”ä¸ä¸Šæ¯”è¾ƒé«˜åº¦ï¼ˆæŸ±çŠ¶å›¾ï¼‰&lt;/p&gt;

&lt;p&gt;è¿˜å¯ä»¥ç”»é¶å¿ƒå›¾ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_bar(aes(x=factor(1), fill=cut))+coord_polar()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig16.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä»¥åŠé£ç«ç‘°å›¾(windrose)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small)+geom_bar(aes(x=clarity, fill=cut))+coord_polar()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig17.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;å›¾å±‚-layer:c38c63fac86d2290b6bc01da39216614&#34;&gt;å›¾å±‚ï¼ˆLayerï¼‰&lt;/h3&gt;

&lt;p&gt;photoshopæµè¡Œçš„åŸå› åœ¨äºPS
3.0æ—¶å¼•å…¥å›¾å±‚çš„æ¦‚å¿µï¼Œggplotçš„ç‰›Bä¹‹å¤„åœ¨äºä½¿ç”¨+å·æ¥å åŠ å›¾å±‚ï¼Œè¿™å ªç§°æ˜¯æ³›å‹ç¼–ç¨‹çš„å…¸èŒƒã€‚
åœ¨å‰é¢æ•£ç‚¹å›¾ä¸Šï¼Œæˆ‘ä»¬å·²ç»è§è¯†è¿‡ï¼ŒåŠ ä¸Šäº†ä¸€ä¸ªå›å½’çº¿æ‹Ÿåˆçš„å›¾å±‚ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº†å›¾å±‚çš„æ¦‚å¿µï¼Œä½¿ç”¨ggplotç”»èµ·å›¾æ¥ï¼Œå°±æ›´åŠ å¾—å¿ƒåº”æ‰‹ã€‚&lt;/p&gt;

&lt;p&gt;åšä¸ºå›¾å±‚çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯&lt;a href=&#34;http://guangchuangyu.github.io/2011/08/the-batman-equation/&#34;&gt;è™è ä¾ logo&lt;/a&gt;ï¼Œbatman
logoç”±6ä¸ªå‡½æ•°ç»„æˆï¼Œåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘å…ˆç”»ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œä¹‹åå†åŠ ä¸€ä¸ªå›¾å±‚ç”»ç¬¬äºŒä¸ªå‡½æ•°ï¼Œä¸æ–­é‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°å…­ä¸ªå‡½æ•°å…¨éƒ¨ç”»å¥½ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;require(ggplot2)
f1 &amp;lt;- function(x) {
    y1 &amp;lt;- 3*sqrt(1-(x/7)^2)
    y2 &amp;lt;- -3*sqrt(1-(x/7)^2)
    y &amp;lt;- c(y1,y2)
    d &amp;lt;- data.frame(x=x,y=y)
    d &amp;lt;- d[d$y &amp;gt; -3*sqrt(33)/7,]
    return(d)
}
 
x1 &amp;lt;- c(seq(3, 7, 0.001), seq(-7, -3, 0.001))
d1 &amp;lt;- f1(x1)
p1 &amp;lt;- ggplot(d1,aes(x,y)) + geom_point(color=&amp;quot;red&amp;quot;) +xlab(&amp;quot;&amp;quot;) + ylab(&amp;quot;&amp;quot;) + theme_bw()
 
x2 &amp;lt;- seq(-4,4, 0.001)
y2 &amp;lt;- abs(x2/2)-(3*sqrt(33)-7)*x2^2/112-3 + sqrt(1-(abs(abs(x2)-2)-1)^2)
d2 &amp;lt;- data.frame(x2=x2, y2=y2)
p2 &amp;lt;- p1 + geom_point(data=d2, aes(x=x2,y=y2), color=&amp;quot;yellow&amp;quot;)
 
x3 &amp;lt;- c(seq(0.75,1,0.001), seq(-1,-0.75,0.001))
y3 &amp;lt;- 9-8*abs(x3)
d3 &amp;lt;- data.frame(x3=x3, y3=y3)
p3 &amp;lt;- p2+geom_point(data=d3, aes(x=x3,y=y3), color=&amp;quot;green&amp;quot;)
 
x4 &amp;lt;- c(seq(0.5,0.75,0.001), seq(-0.75,-0.5,0.001))
y4 &amp;lt;- 3*abs(x4)+0.75
d4 &amp;lt;- data.frame(x4=x4,y4=y4)
p4 &amp;lt;- p3+geom_point(data=d4, aes(x=x4,y=y4), color=&amp;quot;steelblue&amp;quot;)
  
x5 &amp;lt;- seq(-0.5,0.5,0.001)
y5 &amp;lt;- rep(2.25,length(x5))
d5 &amp;lt;- data.frame(x5=x5,y5=y5)
p5 &amp;lt;- p4+geom_point(data=d5, aes(x=x5,y=y5))
 
x6 &amp;lt;- c(seq(-3,-1,0.001), seq(1,3,0.001))
y6 &amp;lt;- 6 * sqrt(10)/7 +
    (1.5 - 0.5 * abs(x6)) * sqrt(abs(abs(x6)-1)/(abs(x6)-1)) -
    6 * sqrt(10) * sqrt(4-(abs(x6)-1)^2)/14
d6 &amp;lt;- data.frame(x6=x6,y6=y6)
p6 &amp;lt;- p5+geom_point(data=d6,aes(x=x6,y=y6), colour=&amp;quot;blue&amp;quot;)

multiplot &amp;lt;- function (..., plotlist = NULL, cols = 1, layout = NULL) {
    plots &amp;lt;- c(list(...), plotlist)
    numPlots = length(plots)
    if (is.null(layout)) {
        layout &amp;lt;- matrix(seq(1, cols * ceiling(numPlots/cols)),
            ncol = cols, nrow = ceiling(numPlots/cols))
    }
    if (numPlots == 1) {
        print(plots[[1]])
    }
    else {
        grid.newpage()
        pushViewport(viewport(layout = grid.layout(nrow(layout),
            ncol(layout))))
        for (i in 1:numPlots) {
            matchidx &amp;lt;- as.data.frame(which(layout == i, arr.ind = TRUE))
            print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                layout.pos.col = matchidx$col))
        }
    }
}

multiplot(p1,p2,p3,p4,p5,p6, cols=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_batman.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;åˆ†é¢-facet:c38c63fac86d2290b6bc01da39216614&#34;&gt;åˆ†é¢ï¼ˆFacetï¼‰&lt;/h3&gt;

&lt;p&gt;åœ¨ã€Š&lt;a href=&#34;http://book.douban.com/subject/24527091/&#34;&gt;ggplot2: æ•°æ®åˆ†æä¸å›¾å½¢è‰ºæœ¯&lt;/a&gt;ã€‹ä¸€ä¹¦çš„ç¿»è¯‘ä¸­ï¼Œä¸€å¼€å§‹è¯‘è€…æŠŠfacetç¿»è¯‘æˆåˆ‡ç‰‡ï¼Œæˆ‘åœ¨æ ¡ç¨¿çš„æ—¶å€™å‘ç°äº†ï¼Œç»™ä»–ä»¬å†™ä¿¡ï¼Œæ¨èç¿»è¯‘æˆåˆ†é¢ï¼Œå¦‚æœæ˜¯sliceè¿™ä¸ªè¯ï¼Œç¿»è¯‘æˆåˆ‡ç‰‡å€’æ˜¯å¾ˆç²¾å‡†ï¼ŒBSDçš„ç¡¬ç›˜åˆ†åŒºå°±å«sliceï¼Œä½†facetä»è¯æºä¸Šçœ‹å°±æ˜¯å°è„¸çš„æ„æ€ï¼Œç¿»è¯‘æˆåˆ†é¢æ‰åˆ°ä½ã€‚ç»™ä»–ä»¬å†™ä¿¡çš„æ—¶å€™ï¼Œæˆ‘è¿˜ä¸“é—¨æŸ¥äº†&lt;a href=&#34;http://dict.cnki.net/&#34;&gt;CNKIç¿»è¯‘åŠ©æ‰‹&lt;/a&gt;ï¼Œå‘ç°è¿™è¯åœ¨ä¿¡æ¯å­¦ä¸­ï¼Œç¿»æˆåˆ†é¢æ—©å·²æ˜¯å›ºå®šçš„ã€‚æˆ‘æ„Ÿè§‰è¿™æ˜¯æˆ‘å¯¹è¿™æœ¬ä¹¦ç¿»è¯‘çš„æœ€å¤§è´¡çŒ®ï¼Œæ ¡ç¨¿è¿‡ç¨‹ä¸­å‘ç°çš„å°‘é‡å°é—®é¢˜è¿œæ¯”ä¸ä¸Šè¿™ä¸ªå…³é”®è¯æ„æ€çš„æŠŠæ¡ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;åˆ†é¢å¯ä»¥è®©æˆ‘ä»¬æŒ‰ç…§æŸç§ç»™å®šçš„æ¡ä»¶ï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œç„¶ååˆ†åˆ«ç”»å›¾ã€‚
åœ¨ç»Ÿè®¡å˜æ¢ä¸€èŠ‚ä¸­ï¼Œæåˆ°å¦‚æœæŒ‰åˆ‡å·¥åˆ†ç»„ä½œå›å½’çº¿ï¼Œæ˜¾ç„¶å›¾ä¼šå¾ˆä¹±ï¼Œæœ‰äº†åˆ†é¢åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«ä½œå›¾ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(small, aes(x=carat, y=price))+geom_point(aes(colour=cut))+scale_y_log10() +facet_wrap(~cut)+stat_smooth()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig18.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;ä¸»é¢˜-theme:c38c63fac86d2290b6bc01da39216614&#34;&gt;ä¸»é¢˜ï¼ˆThemeï¼‰&lt;/h3&gt;

&lt;p&gt;é€šè¿‡ggplotç”»å›¾ä¹‹åï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦å¯¹å›¾è¿›è¡Œå®šåˆ¶ï¼Œåƒtitle, xlab,
ylabè¿™äº›é«˜é¢‘éœ€è¦ç”¨åˆ°çš„ï¼Œè‡ªä¸ç”¨è¯´ï¼Œggplot2æä¾›äº†ggtitle(),
xlab()å’Œylab()æ¥å®ç°ã€‚ æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- ggplot(small)+geom_boxplot(aes(x=cut, y=price,fill=color))
p + ggtitle(&amp;quot;Price vs Cut&amp;quot;)+xlab(&amp;quot;Cut&amp;quot;)+ylab(&amp;quot;Price&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2.fig19.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯è¿™ä¸ªè¿œè¿œæ»¡è¶³ä¸äº†éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜å­—ä½“ï¼Œå­—ä½“å¤§å°ï¼Œåæ ‡è½´ï¼ŒèƒŒæ™¯ç­‰å„ç§å…ƒç´ ï¼Œè¿™éœ€è¦é€šè¿‡theme()å‡½æ•°æ¥å®Œæˆã€‚&lt;/p&gt;

&lt;p&gt;ggplot2æä¾›ä¸€äº›å·²ç»å†™å¥½çš„ä¸»é¢˜ï¼Œæ¯”å¦‚&lt;code&gt;theme_grey()&lt;/code&gt;ä¸ºé»˜è®¤ä¸»é¢˜ï¼Œæˆ‘ç»å¸¸ç”¨çš„&lt;code&gt;theme_bw()&lt;/code&gt;ä¸ºç™½è‰²èƒŒæ™¯çš„ä¸»é¢˜ï¼Œè¿˜æœ‰&lt;code&gt;theme_classic()&lt;/code&gt;ä¸»é¢˜ï¼Œå’ŒRçš„åŸºç¡€ç”»å›¾å‡½æ•°è¾ƒåƒã€‚&lt;/p&gt;

&lt;p&gt;åˆ«å¤–ggthemesåŒ…æä¾›äº†ä¸€äº›ä¸»é¢˜å¯ä¾›ä½¿ç”¨ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;theme_economist theme_economist_white
theme_wsj       theme_excel
theme_few       theme_foundation
theme_igray     theme_solarized
theme_stata     theme_tufte
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;require(ggthemes)
p + theme_wsj()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig20.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨2013å¹´å‘è¡¨çš„æ–‡ç« &lt;a href=&#34;http://pubs.rsc.org/en/content/articlelanding/2013/mt/c3mt00126a#!divAbstract&#34;&gt;Putative cobalt- and nickel-binding proteins and motifs in Streptococcus pneumoniae&lt;/a&gt;ä¸­çš„å›¾3å°±æ˜¯ä½¿ç”¨&lt;code&gt;theme_stata&lt;/code&gt;æ¥ç”»çš„ã€‚&lt;/p&gt;

&lt;p&gt;è‡³äºå¦‚ä½•æ”¹å˜è¿™äº›å…ƒç´ ï¼Œæˆ‘è§‰å¾—æˆ‘ä¹‹å‰&lt;a href=&#34;http://guangchuangyu.github.io/2012/02/draw-chinese-character-jiong-using-ggplot2/&#34;&gt;ç”»å›§å­—çš„åšæ–‡&lt;/a&gt;å¯ä»¥åšä¸ºä¾‹å­ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;f &amp;lt;- function(x) 1/(x^2-1)
x &amp;lt;- seq(-3,3, by=0.001)
y &amp;lt;- f(x)
d &amp;lt;- data.frame(x=x,y=y)
 
p &amp;lt;- ggplot()
p &amp;lt;- p+geom_rect(fill = &amp;quot;white&amp;quot;,color=&amp;quot;black&amp;quot;,size=3,
aes(NULL, NULL,xmin=-3, xmax=3,
ymin=-3,ymax=3, alpha=0.1))
 
p &amp;lt;- p + geom_line(data=d, aes(x,y), size=3)+ylim(-3,3)
theme_null &amp;lt;- function() {
    theme_bw() %+replace%
    theme(axis.text.x=element_blank(),
    axis.text.y=element_blank(),
    legend.position=&amp;quot;none&amp;quot;,
    panel.grid.minor=element_blank(),
    panel.grid.major=element_blank(),
    panel.background=element_blank(),
    axis.ticks=element_blank(),
    panel.border=element_blank())
}
 
p+theme_null()+xlab(&amp;quot;&amp;quot;)+ylab(&amp;quot;&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2012/02/jiong.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¯¦ç»†çš„è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒ?themeçš„å¸®åŠ©æ–‡æ¡£ã€‚&lt;/p&gt;

&lt;h3 id=&#34;äºŒç»´å¯†åº¦å›¾:c38c63fac86d2290b6bc01da39216614&#34;&gt;äºŒç»´å¯†åº¦å›¾&lt;/h3&gt;

&lt;p&gt;åœ¨è¿™ä¸ªæ–‡æ¡£é‡Œï¼Œä¸ºäº†ä½œå›¾æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨diamondsæ•°æ®é›†çš„ä¸€ä¸ªå­é›†ï¼Œå¦‚æœä½¿ç”¨å…¨é›†ï¼Œæ•°æ®é‡å¤ªå¤§ï¼Œç”»å‡ºæ¥æ•£ç‚¹å°±ç³Šäº†ï¼Œè¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨äºŒç»´å¯†åº¦åŠ›æ¥å‘ˆç°ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggplot(diamonds, aes(carat, price))+ stat_density2d(aes(fill = ..level..), geom=&amp;quot;polygon&amp;quot;)+ scale_fill_continuous(high=&#39;darkred&#39;,low=&#39;darkgreen&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2.fig22.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;ggplot2å®ä¾‹:c38c63fac86d2290b6bc01da39216614&#34;&gt;ggplot2å®ä¾‹&lt;/h3&gt;

&lt;p&gt;è´è¶å›¾ï¼šè¯¦è§ã€ŠModern Applied Statistics with S-PLUSã€‹ç¬¬ä¸€ç« ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;theta &amp;lt;- seq(0,24*pi, len=2000)
radius &amp;lt;- exp(cos(theta)) - 2*cos(4*theta) + sin(theta/12)^5
dd &amp;lt;- data.frame(x=radius*sin(theta), y=radius*cos(theta))
ggplot(dd, aes(x, y))+geom_path()+theme_null()+xlab(&amp;quot;&amp;quot;)+ylab(&amp;quot;&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_fig25.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªå›¾ï¼Œæˆ‘æƒ³å±•ç¤ºçš„æ˜¯å¯¹ç»†èŠ‚çš„ä¿®æ”¹ä¸Šï¼Œåœ¨ç”»å›§å­—çš„æ—¶å€™ï¼ŒæŠŠç”»å¸ƒä¸Šçš„å…ƒç´ éƒ½ç»™æ¸…é™¤äº†ï¼Œæˆ‘æŠŠå®ƒå®šä¹‰ä¸ºtheme_nullä¸»é¢˜ï¼Œåœ¨è¿™é‡Œï¼Œç›´æ¥åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å½¢æˆè‡ªå·±çš„ç”»å›¾é£æ ¼ï¼Œå¹¶å†™å‡ºè‡ªå·±çš„ä¸»é¢˜å‡½æ•°å›ºå®šä¸‹æ¥ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åä»¥ç”Ÿç‰©ç•Œä¸­å¸¸ç”¨çš„æŸ±çŠ¶å›¾+è¯¯å·®å›¾ä¸ºå®ä¾‹ï¼Œå±•ç¤ºggplot2éå¸¸çµæ´»çš„å›¾å±‚ã€‚ä»¥æˆ‘2011å¹´å‘è¡¨çš„æ–‡ç« &lt;a href=&#34;http://guangchuangyu.github.io/2010/11/phosphoproteome-profile-of-human-lung-cancer-cell-line-a549/&#34;&gt;Phosphoproteome
profile of human lung cancer cell line
A549&lt;/a&gt;ä¸­çš„westernblotæ•°æ®ä¸ºä¾‹ã€‚è¿™ä¸ªå®ä¾‹å±•ç¤ºäº†å›¾å±‚ï¼Œæ ‡å°ºï¼Œä¸»é¢˜ï¼Œæ³¨é‡Šå’Œå„ç§ç»†èŠ‚å¾®è°ƒå¤šç§å…ƒç´ ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Normal &amp;lt;- c(0.83, 0.79, 0.99, 0.69)
Cancer &amp;lt;- c(0.56, 0.56, 0.64, 0.52)
m &amp;lt;- c(mean(Normal), mean(Cancer))
s &amp;lt;- c(sd(Normal), sd(Cancer))
d &amp;lt;- data.frame(V=c(&amp;quot;Normal&amp;quot;, &amp;quot;Cancer&amp;quot;), mean=m, sd=s)
d$V &amp;lt;- factor(d$V, levels=c(&amp;quot;Normal&amp;quot;, &amp;quot;Cancer&amp;quot;))

p &amp;lt;- ggplot(d, aes(V, mean, fill=V, width=.5))
p &amp;lt;- p+geom_errorbar(aes(ymin=mean, ymax=mean+sd, width=.2), 
                     position=position_dodge(width=.8))
p &amp;lt;- p + geom_bar(stat=&amp;quot;identity&amp;quot;, position=position_dodge(width=.8), colour=&amp;quot;black&amp;quot;)
p &amp;lt;- p + scale_fill_manual(values=c(&amp;quot;grey80&amp;quot;, &amp;quot;white&amp;quot;))
p &amp;lt;- p + theme_bw() +theme(legend.position=&amp;quot;none&amp;quot;) + xlab(&amp;quot;&amp;quot;) + ylab(&amp;quot;&amp;quot;)
p &amp;lt;- p + theme(axis.text.x = element_text(face=&amp;quot;bold&amp;quot;, size=12), 
               axis.text.y = element_text(face=&amp;quot;bold&amp;quot;, size=12))
p &amp;lt;- p+scale_y_continuous(expand=c(0,0), limits=c(0, 1.2), breaks=seq(0, 1.2, by=.2))
p &amp;lt;- p+geom_segment(aes(x=1, y=.98, xend=1, yend=1.1))
p &amp;lt;- p+geom_segment(aes(x=2, y=.65, xend=2, yend=1.1))
p &amp;lt;- p+geom_segment(aes(x=1, y=1.1, xend=2, yend=1.1))
p &amp;lt;- p + annotate(&amp;quot;text&amp;quot;, x=1.5, y=1.08, label=&amp;quot;*&amp;quot;)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2014/05/ggplot2_26.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ›´å¤šå®ä¾‹ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä½¿ç”¨&lt;a href=&#34;http://guangchuangyu.github.io/2011/08/ggplot2-version-of-figures-in-25-recipes-for-getting-started-with-r/&#34;&gt;ggplot2å®ç°&lt;25 Recipes for Getting Started with R&gt;ä¸€ä¹¦ä¸­çš„æ‰€æœ‰å›¾ç‰‡&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>boxplot</title>
      <link>https://guangchuangyu.github.io/cn/2014/03/boxplot/</link>
      <pubDate>Tue, 04 Mar 2014 12:23:16 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2014/03/boxplot/</guid>
      <description>&lt;p&gt;ç”Ÿç‰©å‘å¾ˆå¤šäººç”»å›¾åªä¼šç›´æ–¹å›¾ï¼Œç»Ÿè®¡åªä¼šTæ£€éªŒï¼Œåœ¨æš¨å¤§è§è¿‡å¤ªå¤šçš„å­¦ç”Ÿè¿Tæ£€éªŒéƒ½ä¸ä¼šï¼Œåˆ†ä¸æ¸…SEMå’ŒSDçš„å·®åˆ«ï¼Œä¹Ÿä¸æ¸…æ¥šTæ£€éªŒé‚£å‡ ä¸ªç®€å•å‚æ•°çš„å«ä¹‰ã€‚æˆ‘å†™ç»Ÿè®¡ç¬”è®°ä¹Ÿæ˜¯å› ä¸ºä¸æƒ³é‡å¤æ€§åœ°è·Ÿå­¦ç”Ÿè®²è§£Tæ£€éªŒã€‚&lt;/p&gt;

&lt;p&gt;Barplotå’ŒT testä¸€æ ·æ™®éè€Œæµè¡Œï¼Œbarploté€‚åˆäºè¡¨ç¤ºè®¡æ•°æ•°æ®å’Œæ¯”ä¾‹ï¼Œæ˜¾ç¤ºæ¯”ä¾‹ä¹Ÿå¯ä»¥ç”¨pie
plotï¼Œä½†ç›´æ–¹å›¾æ¯”é¥¼å›¾è¦å¥½ï¼Œå› ä¸ºäººç±»çš„çœ¼ç›é€‚åˆäºæ¯”è¾ƒé«˜åº¦ï¼Œè€Œä¸æ˜¯å¼§åº¦ã€‚&lt;/p&gt;

&lt;p&gt;å¤šåŠæ—¶å€™ç”Ÿç‰©å­¦æ•°æ®å¹¶éç®€å•çš„è®¡æ•°æ•°æ®ï¼Œå¯¹äºæµ‹é‡æ•°æ®ï¼Œåœ¨å±•ç¤ºæ•°æ®åˆ†å¸ƒæ—¶ï¼Œå¾ˆå¤šäººä¼šä½¿ç”¨ä»–ä»¬ç†Ÿæ‚‰çš„barplotï¼Œç”¨é«˜åº¦æ¥è¡¨ç¤ºmeanï¼Œç„¶åå†åŠ ä¸Šerrorbarï¼Œè¿™æ ·å±•ç¤ºæ•°æ®ï¼Œä¿¡æ¯é‡æ˜¯éå¸¸ä½çš„ï¼Œä½¿ç”¨boxplotèƒ½å¤Ÿæä¾›æ›´å¤šçš„æ•°æ®åˆ†å¸ƒä¿¡æ¯ï¼Œèƒ½æ›´å¥½åœ°å±•ç°æ•°æ®ï¼Œä½†å¯èƒ½å¾ˆå¤šäººåªä¼šåœ¨excelé‡Œç”»barplotï¼ŒNature
Methods 2013å¹´çš„æ–‡ç« ä¸­æœ‰100ä¸ªbarplotå›¾ï¼Œè€Œåªæœ‰20ä¸ªboxplotå›¾ï¼Œä»è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œç”¨boxplotçš„äººè¿œè¿œæ²¡æœ‰barplotå¤šï¼Œäºæ˜¯NPGæ€’äº†ï¼Œå†™äº†ä¸¤ç¯‡ä¸“æ æ–‡ç« &lt;a href=&#34;http://www.nature.com/nmeth/journal/v11/n2/full/nmeth.2807.html&#34;&gt;Points of View: Bar charts and box plots&lt;/a&gt;å’Œ&lt;a href=&#34;http://www.nature.com/nmeth/journal/v11/n2/full/nmeth.2813.html&#34;&gt;Points of Significance: Visualizing samples with box plots&lt;/a&gt;å¹¶ä¸”å‘è¡¨äº†ä¸€ç¯‡&lt;a href=&#34;http://www.nature.com/nmeth/journal/v11/n2/full/nmeth.2811.html&#34;&gt;BoxPlotR: a web tool for generation of box plots&lt;/a&gt;æ–¹ä¾¿å¤§å®¶ç”»boxplotï¼Œå¦‚æ­¤ç®€å•çš„web toolèƒ½å¤Ÿå‘Nature Methodsï¼Œå®åœ¨æ˜¯è®©äººç¾¡æ…•å¦’å¿Œæ¨å•Šã€‚&lt;/p&gt;

&lt;p&gt;Boxplotä»1970å¹´ç”±John Tukeyæç¤ºï¼Œåˆ°ç°åœ¨å·²ç»40å¤šå¹´äº†ï¼Œä»–æœ‰å¾ˆå¤šçš„å˜ç§ï¼Œæ¯”å¦‚&lt;a href=&#34;http://guangchuangyu.github.io/2012/02/violin-plot/&#34;&gt;violin plot&lt;/a&gt;å’Œ&lt;a href=&#34;http://www.jstatsoft.org/v28/c01/paper&#34;&gt;beanplot&lt;/a&gt;ï¼Œviolin
plotå’Œbeanplotæ˜¯å¾ˆåƒçš„ï¼Œéƒ½æ˜¯æŠŠboxæ¢æˆdensity curveï¼Œbeanplotå¦å¤–æŠŠæ•°æ®ç‚¹åœ¨ä¸­é—´ç”¨çº¿æ¡è¡¨ç¤ºå‡ºæ¥ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“åŠ ä¸Šå»ï¼Œæ­£å¦‚æˆ‘åœ¨&lt;a href=&#34;http://guangchuangyu.github.io/2012/02/violin-plot/&#34;&gt;violin plot&lt;/a&gt;ä¸­æŠŠæ•°æ®ç‚¹åŠ è¿›å»ä¸€æ ·ã€‚åŒæ ·å¯ä»¥æŠŠæ•°æ®ç‚¹åŠ è¿›boxplotä¸­ï¼Œè¿˜æœ‰å¾ˆå¤šæ‰‹æ³•æ¥å±•ç¤ºboxplotï¼Œæ¯”å¦‚å¯ä»¥ç”¨ç¼ºå£(notch)å½¢å¼æ¥ç”»boxplotï¼Œå¯ä»¥æŠŠä¸­é—´çš„å®½åº¦è¡¨ç¤ºä¸ºmedianå€¼çš„ç½®ä¿¡ç©ºé—´ã€‚boxplotçš„å®½åº¦å¯ä»¥ç”¨æ ·æœ¬é‡æ¥å½’ä¸€åŒ–ï¼Œå¦‚æœsample
sizeè¶³å¤Ÿå¤§çš„è¯ï¼Œ$mean\pm errorbar$ ä¸ä¼šè¶…å‡ºboxï¼Œå¯ä»¥å¾ˆæ¸…æ™°æŠŠè¿™ä¸ªä¿¡æ¯ä¹Ÿå±•ç¤ºåœ¨boxplotä¸­ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæ•°æ®é‡æ¯”è¾ƒå°‘ï¼Œå¯ä»¥ç”¨scatterplot+errorbarçš„å½¢å¼å±•ç¤ºæ•°æ®ï¼Œæ­£å¦‚æˆ‘åœ¨&lt;a href=&#34;http://pubs.rsc.org/en/Content/ArticleLanding/2011/MB/C0MB00055H#!divAbstract&#34;&gt;Phosphoproteome profile of human lung cancer cell line A549&lt;/a&gt;ä¸­æ‰€ç”»çš„&lt;a href=&#34;http://www.douban.com/photos/photo/1560368200/&#34;&gt;å›¾7&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>happy valentine</title>
      <link>https://guangchuangyu.github.io/cn/2012/02/happy-valentine/</link>
      <pubDate>Tue, 14 Feb 2012 05:37:55 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2012/02/happy-valentine/</guid>
      <description>&lt;p&gt;ä»Šå¤©çœ‹åˆ°&lt;a href=&#34;http://cos.name/2012/02/valentines-gift-by-using-r/&#34;&gt;ç»Ÿè®¡ä¹‹éƒ½ä¸Šçš„æƒ…äººèŠ‚å¿ƒå½¢å›¾&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ¬¡ç”»çš„å¿ƒå½¢å‡½æ•°æ˜¯ï¼š
$ x = 16 (sin t)^3$
$ y = 13 cos t - 5 cos 2t - 2 cos 3t - cos 4t$&lt;/p&gt;

&lt;p&gt;å°è¯•ç”¨ggplot2æ¥ç”»ï¼Œç»“æœå¦‚ä¸‹ï¼š
&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2012/02/heart2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2012/02/heart.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä»£ç è§&lt;a href=&#34;https://gist.github.com/1823931&#34;&gt;Github&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://guangchuangyu.github.io/cn/2011/08/love-function-plot/&#34;&gt;ç±»ä¼¼çš„å¿ƒå½¢å›¾ä»¥å‰ä¹Ÿæ˜¯ç”»è¿‡çš„&lt;/a&gt;ï¼Œå½“ç„¶è¿™æ ·çš„å‡½æ•°å›¾æœ‰å¾ˆå¤šï¼Œè¯¦è§&lt;a href=&#34;http://www.mathematische-basteleien.de/heart.htm&#34;&gt;http://www.mathematische-basteleien.de/heart.htm&lt;/a&gt;ï¼Œç”»èµ·æ¥ä¹Ÿå¾ˆå®¹æ˜“ã€‚&lt;/p&gt;

&lt;p&gt;å€’æ˜¯ä»¥å‰ç”»è¿‡çš„&lt;a href=&#34;https://guangchuangyu.github.io/2011/08/the-batman-equation/&#34;&gt;è™è ä¾ logo&lt;/a&gt;ï¼Œæ›´æœ‰æˆå°±æ„Ÿäº›ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>violin plot</title>
      <link>https://guangchuangyu.github.io/cn/2012/02/violin-plot/</link>
      <pubDate>Tue, 07 Feb 2012 06:31:55 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2012/02/violin-plot/</guid>
      <description>&lt;p&gt;ggplot2 0.9.0ç‰ˆæœ¬å°†åœ¨3æœˆ1å·å‘å¸ƒï¼Œæ”¹åŠ¨è¾ƒå¤§ï¼Œæœ€è¿‘bioc mailing
listä¹Ÿæœ‰è¯¸å¤šè®¨è®ºï¼Œå› ä¸ºå®ƒå¯¼è‡´äº†æŸäº›åŒ…ç¼–è¯‘å‡ºé”™ï¼ˆä¼°è®¡æ˜¯NAMESPACEå¼•èµ·çš„ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;æŒ‰ç…§hadleyçš„è¯´æ³•æ˜¯è¿™æ˜¯ä¸ºäº†æŠŠä»–ä¸ªäººçš„é¡¹ç›®å˜æˆä¸€ä¸ªç¤¾åŒºé¡¹ç›®ã€‚&lt;/p&gt;

&lt;p&gt;å¤§å¤šæ•°çš„æ”¹åŠ¨å¯¹ç”¨æˆ·æ¥è¯´æ˜¯invisibleçš„ï¼Œç”¨roxygen2å»æ³¨é‡Šå‡½æ•°ï¼Œæ ¸å¿ƒä»£ç ä½¿ç”¨S3é‡å†™ï¼Œåˆ†ç¦»å‡ºä¸€äº›ç‰¹æ€§ï¼ˆscalesåŒ…ï¼‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;æœ€æ˜æ˜¾çš„æ˜¯ç°åœ¨ç”»å›¾é€Ÿåº¦å˜å¿«äº†ï¼Œä¸è¿‡æˆ‘è§‰å¾—æœ€è®©äººå…´å¥‹çš„æ˜¯&lt;code&gt;guide_legend()&lt;/code&gt;å’Œ&lt;code&gt;guide_colorbar()&lt;/code&gt;ä¸¤ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä¿®æ”¹legend.&lt;/p&gt;

&lt;p&gt;ç”»å›¾çš„è¯ï¼ŒåŠ äº†å››ä¸ªå‡½æ•°&lt;code&gt;geom_map()&lt;/code&gt;, &lt;code&gt;geom_raster()&lt;/code&gt;,
&lt;code&gt;geom_dotplot()&lt;/code&gt;å’Œ&lt;code&gt;geom_violin()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;violin plotç»“åˆäº†box plotå’Œkernel density estimateï¼Œæœ‰äº†å®ƒï¼Œbox
plotåŸºæœ¬å¯ä»¥æ‰”äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2012/02/violin.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>love function plot</title>
      <link>https://guangchuangyu.github.io/cn/2011/08/love-function-plot/</link>
      <pubDate>Sat, 06 Aug 2011 05:37:55 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2011/08/love-function-plot/</guid>
      <description>&lt;p&gt;ä»Šå¤©åœ¨å¾®åšä¸Šçœ‹åˆ°è¿™å‘çˆ¹çš„æ–¹ç¨‹ï¼š $ (x^2+y^2-1)^3 = {x^2} {y^3}$&lt;/p&gt;

&lt;p&gt;ç”»å‡ºæ¥å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2011/08/pp.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è·Ÿä¸ªå±è‚¡ä¼¼çš„ï¼Œsigh&amp;hellip;&lt;/p&gt;

&lt;p&gt;ç¿»å‡ºazaleaçš„è€æ–‡ï¼š&lt;a href=&#34;http://azaleasays.com/2008/06/18/fomula-of-love/&#34;&gt;http://azaleasays.com/2008/06/18/fomula-of-love/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç”¨ggplot2ç”»ä¸€ä¸‹è¿™ä¸ªçˆ±çš„æ–¹ç¨‹ï¼š$17x^2-16|x|y+17y^2 = 225 $&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;x &amp;lt;- seq(-sqrt(17), sqrt(17), 0.001)
y1 &amp;lt;- 8*abs(x)/17 + 15* sqrt(17 - x^2)/17
y2 &amp;lt;- 8*abs(x)/17 - 15* sqrt(17 - x^2)/17
d &amp;lt;- data.frame(x=c(x,x),y=c(y1,y2))
require(ggplot2)

p &amp;lt;- ggplot(d, aes(x,y))
p + geom_point(color=&amp;quot;red&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2011/08/love2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿˜å¯ä»¥ç”»å‡ºçº¢å¿ƒï¼Œé€‚åˆä»Šå¤©ä¸ƒå¤•çš„æ—¥å­ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p + geom_line(color=&amp;quot;red&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2011/08/love3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç”»å‡½æ•°å›¾ï¼Œè¿™ç§äº‹æƒ…ï¼Œè¿˜æ˜¯ç”¨CASæ–¹ä¾¿ç‚¹ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡&lt;a href=&#34;https://guangchuangyu.github.io/cn/tags/maxima/&#34;&gt;maxima&lt;/a&gt;æ¥ç”»ï¼Œä¸€æ¡æŒ‡ä»¤å°±è¡Œï¼Œè¿˜ä¸ç”¨è§£æ–¹ç¨‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;contour_plot(17*x^2-16*abs(x)*y+17*y^2-225, [x,-sqrt(17),sqrt(17)],[y,-15*sqrt(17)/17, sqrt(17)])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2011/08/love_maxima.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>scilabä¸‰ç»´å¹³é¢ç»˜å›¾</title>
      <link>https://guangchuangyu.github.io/cn/2007/05/scilab%E4%B8%89%E7%BB%B4%E5%B9%B3%E9%9D%A2%E7%BB%98%E5%9B%BE/</link>
      <pubDate>Thu, 03 May 2007 10:27:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2007/05/scilab%E4%B8%89%E7%BB%B4%E5%B9%B3%E9%9D%A2%E7%BB%98%E5%9B%BE/</guid>
      <description>

&lt;p&gt;ä¸‰ç»´ç»˜å›¾å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»å‹ï¼šçŸ©é˜µå‹å’Œæ›²é¢å‹ã€‚&lt;/p&gt;

&lt;h2 id=&#34;çŸ©é˜µå‹:8b9e6891715644f541f979f699d9fdf4&#34;&gt;çŸ©é˜µå‹&lt;/h2&gt;

&lt;p&gt;é€šå¸¸æ˜¯å£°æ˜ä¸€ä¸ªçŸ©é˜µï¼Œä»¥çŸ©é˜µçš„é•¿å®½ä¸ºx,yèŒƒå›´ï¼Œä»¥çŸ©é˜µé‡Œé¢çš„æ•°å€¼ä¸ºé«˜zï¼Œ
ä½¿ç”¨&lt;code&gt;plot3d(t1,t2,Z,alpha=a,theta=b)&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;t1:yè½´æ–¹å‘çš„èŒƒå›´&lt;/li&gt;
&lt;li&gt;t2:xè½´æ–¹å‘çš„èŒƒå›´&lt;/li&gt;
&lt;li&gt;Z:çŸ©é˜µ&lt;/li&gt;
&lt;li&gt;alpha&lt;/li&gt;
&lt;li&gt;thetaå‚æ•°ç”¨äºæŒ‡å®šè§’åº¦ï¼Œè®©å›¾ç»˜å‡ºæ¥ä»¥æŸä¸ªç‰¹å®šçš„è§’åº¦å‘ˆç°å‡ºæ¥ã€‚(optional)&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;-&amp;gt;clear -&amp;gt;A=[1 2 5 4 3;0 3 2 8 6;2 4 6 7 5;2 3 4 3 1];
-&amp;gt;t1=1:4; -&amp;gt;t2=1:5;
//plot3d1ä¸plot3dè¯­æ³•ç±»ä¼¼ï¼Œèƒ½å¤ŸåµŒå…¥å¤šç§é¢œè‰²
-&amp;gt;plot3d(t1,t2,A,alpha=45,theta=45);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;meshä¸éœ€è¦è¾¹ç•Œå£°æ˜ï¼Œ &lt;code&gt;-&amp;gt;mesh(A);&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&#34;æ›²é¢å‹:8b9e6891715644f541f979f699d9fdf4&#34;&gt;æ›²é¢å‹&lt;/h2&gt;

&lt;p&gt;åˆ™æ˜¯å…ˆå£°æ˜ä¸€ä¸ªè¿ç»­å‡½æ•°ï¼Œå†é€‰å–x,yèŒƒå›´æ¥ç»˜å›¾ã€‚
&lt;code&gt;fplot3d()&lt;/code&gt;æŒ‡ä»¤ç”¨æ¥ç»˜åˆ¶è¿ç»­å‡½æ•°ã€‚
ç”¨&lt;code&gt;fplot3d&lt;/code&gt;ä¹‹å‰ï¼Œç”¨&lt;code&gt;deff&lt;/code&gt;æˆ–&lt;code&gt;function&lt;/code&gt;å£°æ˜å‡½æ•°z,ç„¶åå†å£°æ˜å‡½æ•°èŒƒå›´x,y.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-&amp;gt;deff(&#39;z=f(x,y)&#39;,&#39;z=x\*y&#39;); 
-&amp;gt;x=-10:8; -&amp;gt;y=-6:12;
-&amp;gt;fplot3d(x,y,f);
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;æŸ±çŠ¶å›¾:8b9e6891715644f541f979f699d9fdf4&#34;&gt;æŸ±çŠ¶å›¾&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;-&amp;gt;A=[1 3 5 7;2 6 10 14]; //å£°æ˜ä¸€ä¸ªçŸ©é˜µ 
-&amp;gt;hist3d(A);
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ç©ºé—´ç«‹ä½“æ›²çº¿å›¾:8b9e6891715644f541f979f699d9fdf4&#34;&gt;ç©ºé—´ç«‹ä½“æ›²çº¿å›¾&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;param3d&lt;/code&gt;ç»˜åˆ¶çš„æ˜¯çº¿ï¼Œè€Œéé¢ã€‚ &lt;code&gt;param3d(xf,yf,zf);&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;xf:xæ–¹å‘çš„å‡½æ•°&lt;/li&gt;
&lt;li&gt;yf:yæ–¹å‘çš„å‡½æ•°&lt;/li&gt;
&lt;li&gt;zf:zæ–¹å‘çš„å‡½æ•°&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;-&amp;gt;t=linspace(-%pi,%pi);
-&amp;gt;param3d(sin(t),cos(t),t);
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>