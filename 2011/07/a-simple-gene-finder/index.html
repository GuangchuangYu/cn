

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.24.1">
    <meta name="theme" content="Tranquilpeak 0.3.1-BETA">
    <title>a simple gene finder</title>
    <meta name="author" content="Guangchuang Yu">
    <meta name="keywords" content="">

    <link rel="icon" href="https://guangchuangyu.github.io/cn/favicon.png">
    

    
    <meta name="description" content="ä¸Šäº†å‡ å¤©çš„è¯¾ï¼Œhttp://ibw2011.fmmu.edu.cn/schedule.htm
ä»Šå¤©å°±ä¸Šå®Œäº†ï¼Œåªå®Œæˆäº†project 1ï¼Œæƒ³å†™gibbs samplingï¼Œä½†æ˜¯æ²¡ææ˜ç™½ï¼Œæ±—ã€‚

è¿™ä¸ªçº¯å±ç»ƒä¹ ç”¨ï¼Œæ²¡å•¥å®ç”¨ä»·å€¼ã€‚


Course Projects:

Project 1: Implementation of a simple gene finder

GOAL

Build a simple codon-usage based gene finder for finding genes in
E.coli.

Procedure

Collect 100 gene sequences from the bacterium E. coli in the genbank
(http://www.ncbi.nlm.nihh.gov). Compute the codon usage table based on
these genes (and the translated protein sequences from them); Build a
probabilistic model based on the codon usages; Implement a random
sequence model in which the nucleotide frequency is computed from the
100 E. coli genes. For a given DNA sequence (and one selected reading
frame), compare your model with a random sequence model; Results that
you should submit:

Two FASTA files for the collected 100 genes and 100 translated protein
sequences; The printed codon usage table; A program named ECgnfinder,
running with the syntax as ECgnfinder â€“i inputfile

Inputfile stands for the name of input file, which should contain one
DNA sequence in FASTA file format; the program should be able to
report an error message if the input file is in the wrong format.

The output should be printed to the standard output as (xxx stands for
the likelihood)

ORF1: xxx ORF2: xxx


">
    <meta property="og:description" content="ä¸Šäº†å‡ å¤©çš„è¯¾ï¼Œhttp://ibw2011.fmmu.edu.cn/schedule.htm
ä»Šå¤©å°±ä¸Šå®Œäº†ï¼Œåªå®Œæˆäº†project 1ï¼Œæƒ³å†™gibbs samplingï¼Œä½†æ˜¯æ²¡ææ˜ç™½ï¼Œæ±—ã€‚

è¿™ä¸ªçº¯å±ç»ƒä¹ ç”¨ï¼Œæ²¡å•¥å®ç”¨ä»·å€¼ã€‚


Course Projects:

Project 1: Implementation of a simple gene finder

GOAL

Build a simple codon-usage based gene finder for finding genes in
E.coli.

Procedure

Collect 100 gene sequences from the bacterium E. coli in the genbank
(http://www.ncbi.nlm.nihh.gov). Compute the codon usage table based on
these genes (and the translated protein sequences from them); Build a
probabilistic model based on the codon usages; Implement a random
sequence model in which the nucleotide frequency is computed from the
100 E. coli genes. For a given DNA sequence (and one selected reading
frame), compare your model with a random sequence model; Results that
you should submit:

Two FASTA files for the collected 100 genes and 100 translated protein
sequences; The printed codon usage table; A program named ECgnfinder,
running with the syntax as ECgnfinder â€“i inputfile

Inputfile stands for the name of input file, which should contain one
DNA sequence in FASTA file format; the program should be able to
report an error message if the input file is in the wrong format.

The output should be printed to the standard output as (xxx stands for
the likelihood)

ORF1: xxx ORF2: xxx


">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="a simple gene finder">
    <meta property="og:url" content="/2011/07/a-simple-gene-finder/">
    <meta property="og:site_name" content="Guangchuang Yu">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Guangchuang Yu">
    <meta name="twitter:description" content="ä¸Šäº†å‡ å¤©çš„è¯¾ï¼Œhttp://ibw2011.fmmu.edu.cn/schedule.htm
ä»Šå¤©å°±ä¸Šå®Œäº†ï¼Œåªå®Œæˆäº†project 1ï¼Œæƒ³å†™gibbs samplingï¼Œä½†æ˜¯æ²¡ææ˜ç™½ï¼Œæ±—ã€‚

è¿™ä¸ªçº¯å±ç»ƒä¹ ç”¨ï¼Œæ²¡å•¥å®ç”¨ä»·å€¼ã€‚


Course Projects:

Project 1: Implementation of a simple gene finder

GOAL

Build a simple codon-usage based gene finder for finding genes in
E.coli.

Procedure

Collect 100 gene sequences from the bacterium E. coli in the genbank
(http://www.ncbi.nlm.nihh.gov). Compute the codon usage table based on
these genes (and the translated protein sequences from them); Build a
probabilistic model based on the codon usages; Implement a random
sequence model in which the nucleotide frequency is computed from the
100 E. coli genes. For a given DNA sequence (and one selected reading
frame), compare your model with a random sequence model; Results that
you should submit:

Two FASTA files for the collected 100 genes and 100 translated protein
sequences; The printed codon usage table; A program named ECgnfinder,
running with the syntax as ECgnfinder â€“i inputfile

Inputfile stands for the name of input file, which should contain one
DNA sequence in FASTA file format; the program should be able to
report an error message if the input file is in the wrong format.

The output should be printed to the standard output as (xxx stands for
the likelihood)

ORF1: xxx ORF2: xxx


">
    
      <meta name="twitter:creator" content="@guangchuangyu">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/7466436733e8691a63a9f7af4651e014?s=640">
    

    
    
    

    

    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" />
    
    
    <link rel="stylesheet" href="https://guangchuangyu.github.io/cn/css/style-u6mk0ojoywresbx8iepslrmmhl4stuhrsxuwhkpwrkrx7mryjcaimasnk4pi.min.css" />
    
    

    
      
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-77901140-1', 'auto');
ga('send', 'pageview');
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://guangchuangyu.github.io/cn/">Guangchuang Yu</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://guangchuangyu.github.io/cn/#about">
    
    
    
      
        <img class="header-picture" src="//www.gravatar.com/avatar/7466436733e8691a63a9f7af4651e014?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://guangchuangyu.github.io/cn/#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/7466436733e8691a63a9f7af4651e014?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Guangchuang Yu</h4>
        
          <h5 class="sidebar-profile-bio">a senior-in-age-but-not-senior-in-knowledge bioinformatician</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://guangchuangyu.github.io/cn/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://guangchuangyu.github.io/cn/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://guangchuangyu.github.io/cn/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://guangchuangyu.github.io/cn/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://guangchuangyu.github.io/cn/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/GuangchuangYu" target="_blank">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://guangchuangyu.github.io/cn/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      a simple gene finder
    </h1>
  
  <div class="postShorten-meta post-meta">
  
    <time itemprop="datePublished" datetime="2011-07-10T09:04:46&#43;08:00">
      
  July 10, 2011

    </time>
  
  
  
  
    <span>in</span>
    
      <a class="category-link" href="https://guangchuangyu.github.io/cn/categories/conference">conference</a>, 
    
      <a class="category-link" href="https://guangchuangyu.github.io/cn/categories/r">R</a>
    
  


</div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>ä¸Šäº†å‡ å¤©çš„è¯¾ï¼Œ<a href="http://ibw2011.fmmu.edu.cn/schedule.htm">http://ibw2011.fmmu.edu.cn/schedule.htm</a>
ä»Šå¤©å°±ä¸Šå®Œäº†ï¼Œåªå®Œæˆäº†project 1ï¼Œæƒ³å†™gibbs samplingï¼Œä½†æ˜¯æ²¡ææ˜ç™½ï¼Œæ±—ã€‚</p>

<p>è¿™ä¸ªçº¯å±ç»ƒä¹ ç”¨ï¼Œæ²¡å•¥å®ç”¨ä»·å€¼ã€‚</p>

<blockquote>
<p>Course Projects:</p>

<p>Project 1: Implementation of a simple gene finder</p>

<p>GOAL</p>

<p>Build a simple codon-usage based gene finder for finding genes in
E.coli.</p>

<p>Procedure</p>

<p>Collect 100 gene sequences from the bacterium E. coli in the genbank
(<a href="http://www.ncbi.nlm.nihh.gov">http://www.ncbi.nlm.nihh.gov</a>). Compute the codon usage table based on
these genes (and the translated protein sequences from them); Build a
probabilistic model based on the codon usages; Implement a random
sequence model in which the nucleotide frequency is computed from the
100 E. coli genes. For a given DNA sequence (and one selected reading
frame), compare your model with a random sequence model; Results that
you should submit:</p>

<p>Two FASTA files for the collected 100 genes and 100 translated protein
sequences; The printed codon usage table; A program named ECgnfinder,
running with the syntax as ECgnfinder â€“i inputfile</p>

<p>Inputfile stands for the name of input file, which should contain one
DNA sequence in FASTA file format; the program should be able to
report an error message if the input file is in the wrong format.</p>

<p>The output should be printed to the standard output as (xxx stands for
the likelihood)</p>

<p>ORF1: xxx ORF2: xxx</p>
</blockquote>

<p></p>

<pre><code class="language-r">
###########################################################
##                                                       ##
##  Dragonstar Course Project (IBW 2011)                 ##
##                                                       ##
##  Project 1: Implementation of a simple gene finder    ##
##  Author Guangchuang your                              ##
##  Xi'an (2011-07-08)                                   ##
##                                                       ##
###########################################################



##' .. content for \description{} (ECgnfinder: An R program to predict prokaryotic genes (e.g. E.coli) using 1st Markov Chain) ..
##'
##' .. content for \details{} ..
##' @title ECgnfinder
##' @param traningSequence : A FASTA file containing multiple sequences for training set
##' @param testingSequence : A FASTA file containing multiple sequences for testing
##' @param backgroundSequence : A FASTA file containing multiple sequences for building the background model
##' @return log likelihood ratio
##' @author Guangchuang Yu
ECgnfinder &lt;- function(trainingSequence, testingSequence, backgroundSequence, print=FALSE) {
    print (&quot;reading training sequence file...&quot;)
    trainingFasta &lt;- readFASTA(trainingSequence)
    trainSeq &lt;- sapply(trainingFasta, function(i) i$seq)

    print(&quot;building Transition Probability Matrix...&quot;)
    TPM &lt;- getTPM(trainSeq)

    print(&quot;building codon usage table...&quot;)
    codonUsage &lt;- getCodonUsage(trainSeq)

    print(&quot;building NucleoTide table...&quot;)
    NtUsage &lt;- getNtUsage(backgroundSequence)


    print(&quot;reading testing sequence file...&quot;)
    testing &lt;- readFASTA(testingSequence)
    testingSeq &lt;- sapply(testing, function(i) i$seq)

    x &lt;- lapply(testingSeq, logLikelihood, transition=TPM, codonusage=codonUsage, background=NtUsage)
    names(x) &lt;- paste(&quot;Sequence&quot;, seq_along(testingSeq), sep=&quot;&quot;)
    if (print) {
        x
    }
    return(x)
}


##' .. content for \description{} (read FASTA file) ..
##'
##' .. content for \details{} ..
##' @title readFASTA
##' @param file: A FASTA file
##' @return a list of list which containing desc and seq.
##' @author Guangchuang Yu
readFASTA &lt;- function(file) {
    x=scan(file, what=&quot;&quot;, sep=&quot;\n&quot;)
    idx &lt;- grep(&quot;&gt;&quot;, x)
    fasta &lt;- list()
    for (i in 1:length(idx)) {
            desc &lt;- x[idx[i]]
            if (i == length(idx)) {
                stop &lt;- length(x)
            } else {
                stop &lt;- idx[i+1]-1
            }
            seq.idx &lt;- seq(idx[i]+1, stop)
            s &lt;- x[seq.idx]
            s &lt;- paste(s, collapse=&quot;&quot;)
            ss &lt;- list(desc=desc, seq=s)
            fasta[i] &lt;- list(ss)
    }
    return(fasta)
    }


##' Build a transition probability matrix from the given Sequence set.
##'
##' @title getTPM
##' @param sequences : A vector of Sequences.
##' @return transition probability matrix
##' @author Guangchuang Yu
getTPM &lt;- function(sequences) {
    codonLength &lt;- 3
    codons &lt;- getCodon()
    
    ## calculate a transition count matrix
    transition &lt;- matrix(1, nrow=length(codons), ncol=length(codons))  ## pseudo count
    colnames(transition) &lt;- codons
    rownames(transition) &lt;- codons

    for (x in 1:length(sequences)) {
        s &lt;- sequences[x]
        len &lt;- nchar(s)
        ## drop the last alphabets which is too short (

        idx &lt;- seq(1, len, codonLength)
        for (i in seq_along(idx)) {
            ## codonI--codonJ
            codonI &lt;- substr(s,idx[i], idx[i]+codonLength-1)
            if (i != length(idx)) {
                codonJ &lt;- substr(s,idx[i+1], idx[i+1]+codonLength-1)
            }
            if (codonI %in% codons &amp; codonJ %in% codons) {
                transition[codonI, codonJ] &lt;- transition[codonI, codonJ] +1
            } else {
                warning(&quot;codon &quot;, codonI, &quot; or &quot;, codonJ, &quot; which does not defined was detected...&quot;)
            }
        }
    }

    ## Calculate Transition Probability Matrix..
    rowsum &lt;- rowSums(transition)
    TPM &lt;- transition/rowsum
    return(TPM)
}

getCodon &lt;- function() {
    codons &lt;- c(&quot;TTT&quot;, &quot;TTC&quot;, &quot;TTA&quot;, &quot;TTG&quot;,
                &quot;CTT&quot;, &quot;CTC&quot;, &quot;CTA&quot;, &quot;CTG&quot;,
                &quot;ATT&quot;, &quot;ATC&quot;, &quot;ATA&quot;, &quot;ATG&quot;,
                &quot;GTT&quot;, &quot;GTC&quot;, &quot;GTA&quot;, &quot;GTG&quot;,
                &quot;TCT&quot;, &quot;TCC&quot;, &quot;TCA&quot;, &quot;TCG&quot;,
                &quot;CCT&quot;, &quot;CCC&quot;, &quot;CCA&quot;, &quot;CCG&quot;,
                &quot;ACT&quot;, &quot;ACC&quot;, &quot;ACA&quot;, &quot;ACG&quot;,
                &quot;GCT&quot;, &quot;GCC&quot;, &quot;GCA&quot;, &quot;GCG&quot;,
                &quot;TAT&quot;, &quot;TAC&quot;, &quot;TAA&quot;, &quot;TAG&quot;,
                &quot;CAT&quot;, &quot;CAC&quot;, &quot;CAA&quot;, &quot;CAG&quot;,
                &quot;AAT&quot;, &quot;AAC&quot;, &quot;AAA&quot;, &quot;AAG&quot;,
                &quot;GAT&quot;, &quot;GAC&quot;, &quot;GAA&quot;, &quot;GAG&quot;,
                &quot;TGT&quot;, &quot;TGC&quot;, &quot;TGA&quot;, &quot;TGG&quot;,
                &quot;CGT&quot;, &quot;CGC&quot;, &quot;CGA&quot;, &quot;CGG&quot;,
                &quot;AGT&quot;, &quot;AGC&quot;, &quot;AGA&quot;, &quot;AGG&quot;,
                &quot;GGT&quot;, &quot;GGC&quot;, &quot;GGA&quot;, &quot;GGG&quot;
                )
    return(codons)
}


##' .. content for \description{} (estimate codon usage table based on training sequences) ..
##'
##' .. content for \details{} ..
##' @title getCodonUsage
##' @param sequences : A vector of sequence set.
##' @return A data.frame containing two columns of codons and Freq (frequency probabilities)
##' @author Guangchuang Yu
getCodonUsage &lt;- function(sequences) {
    codons &lt;- getCodon()
    codon.table &lt;- data.frame(codons=codons, Freq=rep(0, length(codons)))
    rownames(codon.table) = codons

    for (i in 1:length(sequences)) {
        codon &lt;- codonCount(sequences[i])
        rowname.idx &lt;- as.character(codon[,1])
        codon.table[rowname.idx,2] &lt;- codon.table[rowname.idx,2] + codon[,2]
    }
    codon.table[,2] &lt;- codon.table[,2]/sum(codon.table[,2])
                                        #print(codon.table)  #### print result.
    return(codon.table)
}

##' .. content for \description{} (no empty lines) ..
##'
##' .. content for \details{} ..
##' @title codonCount
##' @param seqStr : A sequence string
##' @return A data.frame containing two columns of codons and their counts
##' @author Guangchuang Yu
codonCount &lt;- function(seqStr) {
    codonLength=3
    len &lt;- nchar(seqStr)
    ## drop the last alphabets which is too short (

    idx &lt;- seq(1, len,codonLength)
    codons &lt;- c()
    for ( i in 1:length(idx)) {
        codon &lt;- substr(seqStr, idx[i], idx[i]+codonLength-1)
        codons &lt;- c(codons, codon)
    }
    codons.df &lt;- as.data.frame(table(codons))
    return(codons.df)
}

##' .. content for \description{} (reverse complementary sequence) ..
##'
##' .. content for \details{} ..
##' @title revcom
##' @param seqStr : A sequence string
##' @return A reverse complementary sequence
##' @author Guangchuang Yu
revcom &lt;- function(seqStr) {
    seqStr.str &lt;- unlist(strsplit(seqStr, split=&quot;&quot;))
    idxT &lt;- which(seqStr.str==&quot;T&quot;)
    idxG &lt;- which(seqStr.str==&quot;G&quot;)
    idxA &lt;- which(seqStr.str==&quot;A&quot;)
    idxC &lt;- which(seqStr.str==&quot;C&quot;)
    seqStr.str[idxT] &lt;- &quot;A&quot;
    seqStr.str[idxA] &lt;- &quot;T&quot;
    seqStr.str[idxG] &lt;- &quot;C&quot;
    seqStr.str[idxC] &lt;- &quot;G&quot;
    seqStr.rc &lt;- rev(seqStr.str)
    seqStr.rc &lt;- paste(seqStr.rc, collapse=&quot;&quot;)
    return(seqStr.rc)
}

##' .. content for \description{} (calculate NT frequency probabilities of a given sequence set) ..
##'
##' .. content for \details{use to estimate the background/random NT usage} ..
##' @title getNtUsage
##' @param file : A FASTA file
##' @return A data.frame containing NTs and their corresponding frequency probabilities.
##' @author Guangchuang Yu
getNtUsage &lt;- function(file) {
    print(&quot;reading FASTA file&quot;)
    fasta &lt;- readFASTA(file)
    sequences &lt;- sapply(fasta, function(i) i$seq)
    x &lt;- sapply(sequences, strsplit, split=&quot;&quot;)
    x &lt;- unlist(x)
    NTprob &lt;- as.data.frame(table(x))
    NTprob[,2] &lt;- NTprob[,2]/sum(NTprob[,2])
    rownames(NTprob) &lt;- NTprob[,1]
    return(NTprob)
}

##' .. content for \description{} (calculate the log likelihood of the six possible reading frame of a given sequence) ..
##'
##' .. content for \details{} ..
##' @title logLikelihood
##' @param sequence : A sequence string
##' @param transition : Transition Probatility Matrix
##' @param codonusage : Codon Usage data.frame
##' @param background : NT Usage data.frame for background/random model
##' @return Log likelihood
##' @author Guangchuang Yu
logLikelihood &lt;- function(sequence, transition, codonusage, background) {
    codonLength &lt;- 3
    orf1 &lt;- sequence
    orf2 &lt;- substr(sequence, 2, nchar(sequence))
    orf3 &lt;- substr(sequence, 3, nchar(sequence))
    seq.rc &lt;- revcom(sequence)
    orf4 &lt;- seq.rc
    orf5 &lt;- substr(seq.rc, 2, nchar(seq.rc))
    orf6 &lt;- substr(seq.rc, 3, nchar(seq.rc))
    ORF &lt;- c(orf1, orf2, orf3, orf4, orf5, orf6)
    names(ORF) &lt;- c(&quot;ORF1&quot;, &quot;ORF2&quot;, &quot;ORF3&quot;, &quot;ORF4&quot;, &quot;ORF5&quot;, &quot;ORF6&quot;)

    result &lt;- data.frame(ORF=names(ORF), logLikelihood=rep(0,6))
    for (j in seq_along(ORF)) {
        firstCodon &lt;- substr(ORF[j], 1, 3)
        if (firstCodon %in% codonusage[,1]) {
            initProb &lt;- log(codonusage[firstCodon,2])
        } else {
            initProb &lt;- log(1/64)
        }

        transitionCount &lt;- matrix(0, nrow=nrow(transition), ncol=ncol(transition))
        rownames(transitionCount) &lt;- rownames(transition)
        colnames(transitionCount) &lt;- colnames(transition)

        codons &lt;- rownames(transition)

        len &lt;- nchar(ORF[j])
        len &lt;- len - len %% codonLength - codonLength

        idx &lt;- seq(1, len, codonLength)
        for (i in seq_along(idx)) {
            ## codonI--codonJ
            codonI &lt;- substr(ORF[j],idx[i], idx[i]+codonLength-1)
            if (i != length(idx)) {
                codonJ &lt;- substr(ORF[j],idx[i+1], idx[i+1]+codonLength-1)
            }
            if (codonI %in% codons &amp; codonJ %in% codons) {
                transitionCount[codonI, codonJ] &lt;- transitionCount[codonI, codonJ] +1
            } else {
                warning(&quot;codon &quot;, codonI, &quot; or &quot;, codonJ, &quot; which does not defined was detected...&quot;)
            }
        }

        postTransition &lt;- log(transition) * transitionCount
        posterior &lt;- initProb + sum(postTransition)

        NTseq &lt;- unlist(strsplit(ORF[j], split=&quot;&quot;))
        orf.len &lt;- nchar(ORF[j]) - nchar(ORF[j]) %% codonLength
        NTseq &lt;- NTseq[1:orf.len]
        randomModel &lt;- sum(log(background[NTseq,2]))

        likelihood &lt;- posterior - randomModel
        result[j, 2] &lt;- likelihood
    }
    return(result)
}
</code></pre>
              
              <center><span class="zaln"><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&mid=2247484170&idx=1&sn=ce5f7eb6df66d79661276a64bf25b4bc&chksm=ec43b24ddb343b5b2877574153aeccd049a6824716063883edb35c2338bd32c067caf3885f53#rd" class="zb">èµèµ</a></span></center>
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://guangchuangyu.github.io/cn//tags/ibw/">IBW</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://guangchuangyu.github.io/cn/2011/07/ibw2011/" data-tooltip="IBW2011">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://guangchuangyu.github.io/cn/2011/06/screen-shot/" data-tooltip="screen shot">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
      <li class="post-action">
        <a class="post-action-btn btn btn--default" href="#disqus_thread">
          <i class="fa fa-comment-o"></i>
        </a>
      </li>
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2017 Guangchuang Yu. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://guangchuangyu.github.io/cn/2011/07/ibw2011/" data-tooltip="IBW2011">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://guangchuangyu.github.io/cn/2011/06/screen-shot/" data-tooltip="screen shot">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
      <li class="post-action">
        <a class="post-action-btn btn btn--default" href="#disqus_thread">
          <i class="fa fa-comment-o"></i>
        </a>
      </li>
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <ul class="share-options">
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
        <i class="fa fa-google-plus"></i><span>Share on Google Plus</span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
        <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fguangchuangyu.github.io%2fcn%2f2011%2f07%2fa-simple-gene-finder%2f">
        <i class="fa fa-twitter"></i><span>Share on Twitter</span>
      </a>
    </li>
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/7466436733e8691a63a9f7af4651e014?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Guangchuang Yu</h4>
    
      <div id="about-card-bio">a senior-in-age-but-not-senior-in-knowledge bioinformatician</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Postdoc researcher
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Hong Kong
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/09/ggplot2-set-font/">
                <h3 class="media-heading">è®¾ç½®ggplotæ‰€æœ‰å­—ä½“</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>æœ€è¿‘å…¬ä¼—å·ã€Œç”Ÿä¿¡åª›ã€å’Œã€Œç”Ÿä¿¡å®å…¸ã€çš„å°ä¼™ä¼´åœ¨è¯´ggplot2æ— æ³•ä¸€æ¬¡æ€§è®¾ç½®æ‰€æœ‰å­—ä½“ï¼Œ<code>theme</code>åªèƒ½è®¾ç½®axis text, titleè¿™äº›ï¼Œè€Œæä¸äº†<code>geom_text</code>ï¼Œ<code>geom_text</code>å¿…é¡»è¦æ‰‹å·¥è¾“å…¥<code>family=XXX</code>æ¥è®¾ç½®ï¼Œå› ä¸ºä¸èƒ½ä½¿ç”¨<code>theme</code>æ¥æ›´æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡åŠæ³•é€šè¿‡åå¤„ç†æ¥è®¾å®šï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚</p>

<p>è¿™æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ï¼Œåå¤„ç†å¿…é¡»å¯ä»¥çš„ï¼Œä¸€æ¬¡æ€§æ»¡è¶³æ‰€æœ‰æ„¿æœ›ä¹Ÿåªæ˜¯å› ä¸ºæ²¡äººå†™ä¸ªç¥å¥‡çš„å‡½æ•°è€Œå·²ã€‚äºæ˜¯æˆ‘å°±åŠ¨æ‰‹å†™äº†ä¸ª<code>set_font</code>çš„å‡½æ•°ã€‚</p>

<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸‹å›¾ï¼š</p>

<pre><code class="language-r">library(ggplot2)
d &lt;- data.frame(x=rnorm(10), y=rnorm(10), lab=LETTERS[1:10])
p &lt;- ggplot(d, aes(x, y)) + 
    geom_text(aes(label=lab, color=lab), size=10) + 
	geom_text(aes(y, x, label=lab), size=3)
</code></pre>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/09/3d-breast/">
                <h3 class="media-heading">3Dç‰ˆé‚ªæ¶çš„æ›²çº¿</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>æˆ‘çš„å…¬ä¼—å·biobabbleç¬¬ä¸€ç¯‡åŸåˆ›æ–‡ç« ã€Š<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;amp;mid=2247483816&amp;amp;idx=1&amp;amp;sn=cbfbc284f4edb165ac65f7926f7f8fcc&amp;amp;chksm=ec43b0efdb3439f91ec4f570f7be65e442e21e403481b969d69449464ae1986c7983551de04d#rd">é‚ªæ¶çš„æ›²çº¿</a>ã€‹ï¼Œå› ä¸ºå¤ªé‚ªæ¶ï¼Œå½“æ—¶åªæ¨é€ç»™ç”·æ€§å…³æ³¨è€…ï¼Œç”±äºä¸æ˜¯æ¨é€ç»™æ‰€æœ‰äººï¼Œæ‰€ä»¥å†å²è®°å½•æ˜¯ç¿»ä¸åˆ°çš„ï¼Œä¹‹å‰æœ‰å†æ–‡å­—æ¨é€ä¸€ä¸‹é“¾æ¥ï¼Œç»“æœè¯„è®ºåŒºå…¨æ˜¯å·®è¯„ï¼Œæˆ‘ä¹Ÿæ˜¯è›®å›§rzçš„â€¦</p>

<p>æ— æ„ä¸­æˆ‘åˆç¿»åˆ°äº†ä¸€å¼ 2012å¹´2æœˆä»½ç”»çš„3Dç‰ˆæœ¬ï¼Œå°½ç®¡ä½ ä»¬è¦å·®è¯„ï¼Œè¿˜æ˜¯æƒ³åˆ†äº«ä¸€ä¸‹ã€‚ä»£ç å°±åœ¨æˆªå±ä¹‹ä¸­ï¼Œæƒ³ç©çš„è¯ï¼Œå¯ä»¥ç…§ç€è¾“å…¥ï¼Œæ”¯æŒé¼ æ ‡æ—‹è½¬å“¦ï¼Œå¯ä»¥æ…¢æ…¢æŠŠç©ï¼ˆå¤ªé‚ªæ¶äº†ï¼‰ã€‚</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/08/apple-logo-emoji/">
                <h3 class="media-heading">ä½ æ‰€æ²¡è§è¿‡çš„è‹¹æœ</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p><img src="https://guangchuangyu.github.io/blog_images/MISC/iphone5s.jpeg" alt="" /></p>

<p>5sæ— ç¼˜æ— æ•…çªç„¶å°±è‡ªå¸¦3Dæ•ˆæœï¼Œå¯æ˜¯è‹¹æœæ²¡é€æˆ‘3Dçœ¼é•œå•Šï¼åšä¸ºä¸€ä¸ªæœç²‰ï¼Œè‡ªä»ä¹”å¸®ä¸»ç¦»å»ä¹‹åï¼Œå¯¹è‹¹æœæ˜¯è¶Šæ¥è¶Šæ— çˆ±äº†ã€‚</p>

<p>anywayï¼Œå¯¹äºè¿™éƒ¨é™ªä¼´è®¸ä¹…çš„æ‰‹æœºï¼Œè¿˜æ˜¯è¦çºªå¿µä¸€ä¸‹çš„ã€‚</p>

<p>ã€Š<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;amp;mid=2247484489&amp;amp;idx=1&amp;amp;sn=36bbdee1da96aee301f217e61cc8e3b5&amp;amp;chksm=ec43b50edb343c186a58494e32ffe7df6ae9d960a37772fb5887a9c3f7461ab906b90d1a34f0#rd">æŒ‰åœ°ç†ä½ç½®åˆ†é¢</a>ã€‹ä¸€æ–‡æœ€åæˆ‘åŸ‹äº†ä¸ªä¼ç¬”ï¼Œå†™åˆ°æœ€åçš„æ—¶å€™ï¼Œæˆ‘æƒ³åˆ°çš„æ˜¯å¯ä»¥æ‹¿æ¥ç”»ä¸ªå…ƒç´ å‘¨æœŸè¡¨ï¼Œä½†æ‡’å¾—æï¼Œåœ¨ã€Š<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;amp;mid=2247484506&amp;amp;idx=1&amp;amp;sn=59bc85733a37c4aa8036e43c6d3e7523&amp;amp;chksm=ec43b51ddb343c0b7417b8fe924a86d0d974163b39fe6c8aa72504d1e0ef4c3393aa41659de4#rd">ggplot2åˆ†é¢ä¹‹åƒç´ è‰ºæœ¯</a>ã€‹ä¸€æ–‡é‡Œç”¨ä¸€åªç«é¸¡å±•ç¤ºäº†ç”¨å›¾æ¥æ‹¼åƒç´ ç”»çš„æ€è·¯ï¼Œå›åº”äº†å‰æ–‡çš„ä¼ç¬”ã€‚ä»Šå¤©ç»§ç»­å±•ç¤ºä¸€ä¸ªåƒç´ ç”»ï¼Œä¸ºäº†çºªå¿µæˆ‘çš„iphone5Sï¼Œå½“ç„¶æˆ‘è¦ç”»ä¸ªè‹¹æœğŸå‡ºæ¥ã€‚</p>

<p>è¿™é‡Œçš„å›¾ï¼Œç”¨çš„æ˜¯emojiæ¥ç”»ï¼Œå¦‚æœä½ è¿˜ä¸ä¼šç”¨emojiæ¥ç”»å›¾è£…é€¼ï¼Œèµ¶ç´§æˆ³ã€Š<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484416&amp;idx=1&amp;sn=c089403a2b8ab03d241b6d99ef138f50&amp;chksm=ec43b547db343c51bdae5f76b399072629720cf646ddc1c0b758c7c76d57e8b1e35b47221cf6">çœ‹å®Œæ­¤æ–‡, ä½ ä¹Ÿèƒ½å¤Ÿå¤§å¼€è„‘æ´, ä¸Šå‡é€¼æ ¼</a>ã€‹ã€‚ç„¶åç”¨<code>geofacet</code>æ¥æ‹¼å‡ºåƒç´ ç”»ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½ åº”è¯¥æƒ³åˆ°å¯ä»¥æ‹¿æ¥æ‹¼ä½ çš„ç…§ç‰‡ï¼Œç”»ä¸ªæŸä¸ªå½¢çŠ¶çš„ç…§ç‰‡å¢™äº†ã€‚</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/08/source-code-reuse/">
                <h3 class="media-heading">å…³äºé‡ç”¨ä»£ç ä¸æ–‡ç« æŠ„è¢­</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>ã€Š<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;amp;mid=2247484733&amp;amp;idx=1&amp;amp;sn=b43739e02ef7e7892f196aa51a1c2e59&amp;amp;chksm=ec43b47adb343d6c98b240a0dfed9abe1ab46e230535a44f2b47bf69cc7b45520f7c7fd38231#rd">å¤§å­¦æ•™æˆåŠ›æŒºæŠ„è¢­ï¼Œå¼ºè¡Œæ´—åœ°åˆ°è£¤è¡©éƒ½ä¸è¦äº†ï¼Œåˆ°åº•å›¾ä»€ä¹ˆï¼Ÿ</a>ã€‹è¿™ç¯‡æ–‡ç« å‘å‡ºæ¥ä¹‹åï¼Œå¼•èµ·å¤§å®¶è®¨è®ºï¼Œæœ‰ä¸€äº›å°ä¼™ä¼´æˆªäº†å±ç»™æˆ‘çœ‹ã€‚æ‰€ä»¥æˆ‘æƒ³æœ‰å¿…è¦å†è®²å‡ å¥ï¼Œæˆ‘è¿™ç¯‡æ–‡ç« å†™<strong>ä¸¤ä¸ªæ–¹é¢</strong>ï¼Œä¸€æ–¹é¢æ˜¯é‡ç”¨ä»£ç ï¼Œä¸€æ–¹é¢æ˜¯æ–‡ç« æŠ„è¢­ï¼Œè¿™ä¸¤æ–¹é¢å¯ä»¥æ˜¯ä¸ç›¸å…³çš„ï¼Œè¿™é‡Œçš„æ–‡ç« æŠ„è¢­å¹¶ä¸ç‰¹æŒ‡ä½ æŠ„äº†ä»£ç ã€‚</p>

<p>Xæ•™æˆã€Š<a href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484733&amp;idx=2&amp;sn=b6c3a81f38c0f60433e8ccd721a7ca3b&amp;chksm=ec43b47adb343d6c0bee4ae222af03353329173b9ae87c588d6bb19f95619dc46b829d0af1b6#rd">å¦‚ä½•å§¿åŠ¿æ­£ç¡®çš„ä½¿ç”¨ä»–äººä»£ç ï¼Ÿ</a>ã€‹ï¼Œæ€»ç»“èµ·æ¥ä¸¤ä¸ªç‚¹ï¼Œä¸€æ˜¯å¼€æºä»£ç éšä¾¿ç”¨ï¼ŒäºŒæ˜¯æ–‡ç« æœ‰å¼•ç”¨/è‡´è°¢å°±OKã€‚è¿™ä¸¤ä¸ªç‚¹éƒ½æ˜¯é”™è¯¯çš„ã€‚</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/08/plagiarism/">
                <h3 class="media-heading">å¤§å­¦æ•™æˆåŠ›æŒºæŠ„è¢­ï¼Œå¼ºè¡Œæ´—åœ°åˆ°è£¤è¡©éƒ½ä¸è¦äº†ï¼Œåˆ°åº•å›¾ä»€ä¹ˆï¼Ÿ</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><blockquote>
<p>è¿é®ç¾å¸ƒéƒ½ä¸è¦ï¼Œéš¾é“è¿™æ˜¯ä¸ªä¸€è¢«å­çš„æ•…äº‹?</p>
</blockquote>

<p>äº‹æƒ…å¼€å§‹äºæˆ‘æ•´ç†å¹¶æ›å…‰äº†è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦ä¸€ä¸ªè®²å¸ˆè¯»åœ¨èŒåšå£«æœŸé—´æŠ„è¢­äº†ä¸¤ç¯‡æ–‡ç« ï¼Œå¹¶é¡ºåˆ©æ‹¿åˆ°å­¦ä½æ™‹å‡ä¸ºå‰¯æ•™æˆçš„æ•…äº‹ã€‚</p>

<h2 id="è¿™ä¸ªæ•…äº‹å¾ˆç²¾å½©">è¿™ä¸ªæ•…äº‹å¾ˆç²¾å½©</h2>

<p><strong>äº®ç‚¹1</strong>: æœŸé—´å‘ç°äº†ä¸€æ¡æŠ„è¢­é“¾ï¼ŒGOSimè¢«DOSimæŠ„ï¼Œè€ŒDOSimåˆè¢«HPOSimæŠ„ï¼ŒæŠ„è¢­è€…éƒ½åœ¨æ–‡ç« ä¸­æŠŠæŠ„æ¥çš„ç®—æ³•å®ç°å½“æˆè‡ªå·±åšçš„ä¸œè¥¿æ¥ä»‹ç»ã€‚</p>

<p><strong>äº®ç‚¹2</strong>: ppiPreæŠ„è¢­GOSemSimçš„æ–‡ç« ï¼Œæˆ‘è·ŸBMC Systems Biologyåé¦ˆäº†ï¼Œè€Œç¼–è¾‘éƒ¨ç«Ÿç„¶å„ç§åŒ…åº‡ï¼Œæœ€åæŠ„è¢­è€…ä¸¤é¢ä¸‰åˆ€ï¼Œå’Œç¼–è¾‘éƒ¨é»‘ç®±æ“ä½œï¼Œåœ¨æœªå‘ŠçŸ¥æˆ‘çš„æƒ…å†µä¸‹ï¼Œå‡ºæ¥ä¸€ä¸ªæ´—åœ°çš„Erratumï¼ŒæŠŠæŠ„è¢­è¯´æˆä¸å¥½æ„æ€ï¼Œå¿˜è®°å¼•ç”¨äº†ã€‚</p>

<p>æ•´ä¸ªè¿‡ç¨‹è¿è½½äºä»¥ä¸‹å››ç¯‡æ–‡ç« ä¸­ï¼š</p>

<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484602&amp;idx=1&amp;sn=d81f54bd2cd04a97d54ae13f4aa44f29&amp;chksm=ec43b5fddb343ceb140b3302e3ad592f82572506cb3d99f0d1c65c9829cf5564948e53d73da8#rd">[è¿è½½1]ï¼šå­¦æœ¯æœŸåˆŠçš„å­¦æœ¯ä¸ç«¯ï¼Œä½ è§è¿‡å—ï¼Ÿ</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484618&amp;idx=1&amp;sn=bcb696bba156bc433cae638a461bdcdb&amp;chksm=ec43b58ddb343c9b546cf7c4b3d032da610ce89d0b8c1778cb723cf74cdfa11c11bbedf3557a#rd">[è¿è½½2]ï¼šEditorä½ çš„å¿ƒä¸ä¼šç—›å—ï¼Ÿ</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484629&amp;idx=1&amp;sn=f6224e30a6a4fde1461a050b642d80ec&amp;chksm=ec43b592db343c84f70689c39525a29d69f69fe4a62f76e69ecbb18634cd6baef0500a7fe6a6#rd">[è¿è½½3]ï¼šè¾£çœ¼ç›ï¼Œä¸€ç¯‡æŠ„è¢­å¼•å‘çš„ç³»åˆ—è¡€æ¡ˆï¼</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484637&amp;idx=1&amp;sn=973088de67527548429542d45344c714&amp;chksm=ec43b59adb343c8c2f25bc077695a5f6d6c6b59650102670dbfe7cf9b00a32698775593722c5#rd">[è¿è½½4]ï¼šæˆ‘åƒæ˜¯ä¸€é¢—æ£‹ï¼Œè¿›é€€ä»»ç”±ä½ å†³å®š</a></li>
</ul>

<p>å¦‚æœæƒ³è¦åˆ†äº«è¿™æ•´ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥åˆ†äº«ä»¥ä¸‹è¿™ä¸ªæ±‡æ€»çš„æ–‡ç« ï¼š</p>

<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484640&amp;idx=1&amp;sn=478f77b8f03eb9793bafc8f18e126097&amp;chksm=ec43b5a7db343cb11fc9e0c232e0de0db7ec444abf5e8e3bd703f83a3cb31695f10359b47b8f#rd">ä»ä¸šè¶…è¿‡10å¹´ï¼Œæœªè§è¿‡å¦‚æ­¤åšé¢œæ— è€»ä¹‹äºº</a></li>
</ul>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/08/get-phd-degree/">
                <h3 class="media-heading">åšå£«å…»æˆè®°</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><h2 id="æœŸæœ›ä¸­çš„åšå£«ç”Ÿæ´»æ˜¯è¿™æ ·å­">æœŸæœ›ä¸­çš„åšå£«ç”Ÿæ´»æ˜¯è¿™æ ·å­</h2>

<p><img src="https://guangchuangyu.github.io/blog_images/MISC/phd/2016-01-05 00.58.47.jpg" alt="" /></p>

<h2 id="ç„¶è€ŒçœŸå®çš„ç”Ÿæ´»å´æ˜¯">ç„¶è€ŒçœŸå®çš„ç”Ÿæ´»å´æ˜¯ï¼š</h2>

<p><img src="https://guangchuangyu.github.io/blog_images/MISC/phd/2015-06-23 11.31.59.jpg" alt="" /></p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/08/prepare-genelist/">
                <h3 class="media-heading">å¬è¯´ä½ æœ‰RNAseqæ•°æ®å´ä¸çŸ¥é“æ€ä¹ˆè·‘GSEA</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><blockquote>
<p>Dear GuangChuangyu,</p>

<p>I&rsquo;m trying to use the clusterProfiler package for GSE analysis on DGE data obtained from RNAseq.
While I can run enrichKEGG, I&rsquo;m unable to run gseKEGG basically because I don&rsquo;t know how to obtain an order ranked gene list.</p>

<p>I work on R. I have a dataframe or matrix with gene names, log2 fold change values, pvalues and adjusted pvalues among others.</p>

<p>How can I get the order ranked gene list to feed in gseKEGG?</p>

<p>Moreover what is the more reliable way to obtain functional insight about each sample? enrichKEGG or gseKEGG?</p>

<p>Thank you in advance for your help.</p>

<p>best regards</p>

<p>bruno saubamÃ©a</p>
</blockquote>

<p>ä»Šå¤©æ”¶åˆ°ä¸€å°æ¥è‡ªUniversitÃ© Paris Descartesçš„æ±‚åŠ©ä¿¡ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘è¢«é—®è¿‡å¥½å¤šæ¬¡äº†ï¼Œæ˜¾ç„¶å¾ˆå¤šæ–°æ‰‹éƒ½æœ‰è¿™é—®é¢˜ï¼Œæ ¹æœ¬ä¸çŸ¥é“è¯¥æ€ä¹ˆè·‘GSEAï¼Œæä¸æ¸…GSEAçš„è¾“å…¥æ˜¯ä»€ä¹ˆã€‚</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/08/response-to-sciencenet-blog-post/">
                <h3 class="media-heading">ç¥ä½ ä»¬ç¼ ç¼ ç»µç»µåˆ°å¤©æ¶¯</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>è–›å®‡è¿™ç¯‡ã€Š<a href="http://blog.sciencenet.cn/home.php?mod=space&amp;uid=404304&amp;do=blog&amp;id=1069933">BMC Systems Biologyæ²¡æœ‰å­¦æœ¯ä¸ç«¯</a>ã€‹å†™ä½œæ°´å¹³è¿˜çœŸæ˜¯é«˜å•Šï¼Œå…ˆæ¥ä¸ªä¸æ‹‰å¹²çš„å°äº‹æƒ…ï¼Œç”¨äº†è½¯ä»¶æ²¡å¼•ç”¨ï¼Œæ¥é“ºå«å¹¶ä»¥æ­¤å¯¹æŠ„è¢­äº‹æƒ…è¿›è¡Œå®šä½/å®šæ€§ã€‚å†æ¥ä¸€å †è®ºæ®å’Œç»“è®ºä¸ç›¸å…³çš„é€»è¾‘æ¥è®ºè¯ï¼Œå¥½åƒå¾ˆæœ‰é“ç†çš„æ ·å­ï¼Œä¸æ˜çœŸç›¸ï¼ˆæ²¡æœ‰è¯»æˆ‘çš„4ç¯‡è¿è½½ï¼‰çš„ç¾¤ä¼—å¾ˆå®¹æ˜“å°±æ‰å‘é‡Œäº†ã€‚</p>

<p>é¦–å…ˆè®²äº†ä»–å’ŒRæ•™æˆçš„æ•…äº‹ï¼Œé‚£åªä¸è¿‡æ˜¯ç”¨äº†å·¥å…·æ²¡å¼•ç”¨è€Œå·²ï¼Œå’ŒæŠ„è¢­æ˜¯ä¸¤ç äº‹ï¼è¯•å›¾æŠŠæŠ„è¢­å†™æˆä¸æ­¤ç±»ä¼¼çš„ã€Œå¿˜è®°å¼•ç”¨ã€ï¼</p>

<blockquote>
<p>æ¯”æ–¹è¯´æˆ‘ç»™Ræ•™æˆå†™ä¿¡ï¼Œå°±åªæ˜¯é—®æœ‰æ²¡æœ‰ç”¨æˆ‘çš„å·¥å…·ã€‚éƒ½æ˜¯èªæ˜äººï¼Œè¯ä¸éœ€è¦è¯´çš„é‚£ä¹ˆé€ï¼Œç‚¹åˆ°ä¸ºæ­¢å°±å¾—äº†ã€‚é‚£æ‚¨è¦é—®ï¼Œå¦‚æœäººå®¶ä¸å›ä¿¡æˆ–è€…è€èµ–è¯´æ²¡ç”¨å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä¸‰å¤©ä¸å›ä¿¡æˆ‘ä¼šç«‹é©¬å†™ä¿¡æ‚å¿—ç¤¾ï¼Œè¯´ä½œè€…ç”¨äº†æˆ‘çš„ä¸œè¥¿å¹¶ä¸”åˆ»æ„æ²¡æœ‰å¼•ç”¨ä¹Ÿæ²¡æœ‰è‡´è°¢ï¼Œæ€åº¦æå…¶æ¶åŠ£å»ºè®®æ’¤ç¨¿ï¼Œå¹¶ä¸”æŠŠæˆ‘ä¸‰å¤©å‰å‘çš„ä¿¡æŠ„ç»™ç¼–è¾‘ä½œä¸ºè¯æ®ã€‚</p>
</blockquote>

<p>ä¸ºäº†æŠŠæŠ„è¢­è¿™ç§ä¸¥é‡çš„äº‹æƒ…ä¸ç”¨äº†å·¥å…·æ²¡å¼•ç”¨è¿™ç§ç®€ç›´å¤ªå¸¸è§ä¸”ä¸å€¼ä¸€æçš„å°äº‹åšç±»æ¯”ï¼Œè–›å®‡æ•™æˆæ˜¯ç”¨å¿ƒè‰¯è‹¦å•Šï¼ŒæŠŠå°äº‹ç»™è¯´å¤§äº†ï¼</p>

<p>è¿™å°±æ˜¯ç‰›é€¼ä¹‹å¤„ï¼Œæˆ‘ä¸å¾—ä¸æœï¼Œç”¨å°äº‹ä¸å¤§äº‹ç±»æ¯”ï¼Œå°†å¤§äº‹è¯´å°ï¼å°†å°äº‹è¯´å¤§ï¼Œè®©å¤§äº‹åŒ–å°äºæ— å½¢ä¸­ã€‚</p>

<blockquote>
<p>æœ‰å¾·å›½å­¦è€…ä½¿ç”¨äº†GOSemSimçš„ä»£ç è®¾è®¡äº†é¢„æµ‹è›‹ç™½è´¨ç›¸äº’ä½œç”¨çš„å·¥å…·IntScoreï¼Œå‘è¡¨åœ¨2012å¹´çš„æ ¸é…¸ç ”ç©¶ä¸Šï¼Œä½œè€…ä¸“é—¨å†™äº†ä¸€èŠ‚æ¥ä»‹ç»GOçš„è¯­ä¹‰å­¦ç›¸ä¼¼æ€§å¹¶ä¸”æ ‡æ˜å¼•ç”¨ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« ç¬¦åˆå­¦æœ¯è§„èŒƒï¼Œæ²¡æœ‰é—®é¢˜ã€‚æˆ‘ä»¬å†çœ‹çœ‹DOSimï¼Œè¿™ç¯‡æ–‡ç« é‡Œæ³¨æ˜äº†GOæ³¨é‡Šçš„åˆ†æä½¿ç”¨çš„æ˜¯GOSimå¹¶ä¸”åŠ äº†å¼•ç”¨ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p>
</blockquote>

<p>è¿™æ®µè¯å¾ˆæœ‰æ°´å¹³ï¼Œé¦–å…ˆæ˜¯<strong>ä¸å¯¹ç­‰ç±»æ¯”</strong>ï¼Œä»¥2012å¹´NARçš„ç¬¦åˆå­¦æœ¯è§„èŒƒçš„æ–‡ç« æ¥ç±»æ¯”ä¸€ç¯‡æŠ„è¢­æ–‡ç« ï¼Œè¯•å›¾åŒ–æŠ„è¢­äºæ— å½¢ä¸­ã€‚</p>

<p>æˆ‘ä»¬æ¥çœ‹æ‰€è°“çš„ä¸€èŠ‚<strong>ä¸“é—¨ä»‹ç»</strong>å’Œæ ‡æ˜å¼•ç”¨æ˜¯æ€æ ·çš„ï¼š</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/07/magick-add-gif/">
                <h3 class="media-heading">æœ‰é­”æ€§çš„å›¾æ¥ä¸€å‘</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jul 7, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>ä¸çŸ¥ä¸è§‰ä¸­æˆ‘å·²ç»ä»‹ç»äº†å¾ˆå¤šRåŒ…ï¼Œæœ‰å­¦æœ¯ä¸Šçš„<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247483886&amp;idx=1&amp;sn=cb76891dff5787025f6b99cdcc723d86&amp;chksm=ec43b0a9db3439bfcec1c9ac3c0d00e6190cf4d3d02d9d3dc767007e0ff68b4fbd8064bb0f77#rd">ChIPseeker</a>ã€<a href="http://mp.weixin.qq.com/s/Uhx3l3lKQS88OJ4SHntkNg">treeio</a>ã€<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247483962&amp;idx=1&amp;sn=7240c1fe0e09a142ef95ac594922b890&amp;chksm=ec43b37ddb343a6bc7c2633597aba751b7f257846d26bc0060b7782ecd3ae20fece8085f0295">ggtree</a>ã€
<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484374&amp;idx=1&amp;sn=f946f3539a752b09a94b5e160e87368e&amp;chksm=ec43b291db343b871a1f10ca31d6ef94e9da4485043ed374c9739689d02072be92a34ca4e863#rd">clusterProfiler</a>ã€
<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484054&amp;idx=1&amp;sn=c9c45157bfb60d5143e5d467ebfe5a86&amp;chksm=ec43b3d1db343ac74cbc7a4f0bbe8b9a09346c2becbce33e5f8c070b333a2195adb8741e9e82">GOSemSim</a>ã€<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484018&amp;idx=1&amp;sn=53281ebf18b52518bc14dc83a0709bf9&amp;chksm=ec43b335db343a23465208b47327088d054f8eed64f7d7137b09d01ca414c08fb17804fd19ce">seqcombo</a>å’Œ<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484054&amp;idx=2&amp;sn=9a42f1094349a0bd09a5e0b7c44595e0&amp;chksm=ec43b3d1db343ac7e11d92eda3eb1837aab46f79bb109e6cdbba466e4693d041a87fa698ef1b">MSnbase</a>ç­‰ï¼Œå½“ç„¶å…ä¸äº†æœ‰<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247483948&amp;idx=1&amp;sn=e57e385ada66c991a5c3cf6eb48f7169&amp;chksm=ec43b36bdb343a7dbd39574bb6b02cf8057a4d068399630e77e0580113a2807bb8c34edafbf0">åæ§½</a>è¿˜æœ‰<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484640&amp;idx=1&amp;sn=478f77b8f03eb9793bafc8f18e126097&amp;chksm=ec43b5a7db343cb11fc9e0c232e0de0db7ec444abf5e8e3bd703f83a3cb31695f10359b47b8f#rd">æŠ„è¢­</a>ã€‚<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484641&amp;idx=1&amp;sn=3ff11eef4cf48ebc6c2d1b06be950834&amp;chksm=ec43b5a6db343cb04355c149b52bbd9bcb11b7983e48ddb5d40b85081003937d5e582b0f69b5">æœ‰å­¦Rçš„</a>å’Œ<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484173&amp;idx=1&amp;sn=ad1817e4acd1362428b3beaa1cd4fede&amp;chksm=ec43b24adb343b5cad6c7ff528182e9c95f0f292044399e127d7495c77bbe2e1cbccb095179c">æ›´æ–°RåŒ…</a>ï¼Œä¹Ÿæœ‰<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484109&amp;idx=1&amp;sn=9988b955cb4a995dfcfbe31f31d929da&amp;chksm=ec43b38adb343a9cc2ce4ab9fabf3e6ff1db82f6627c91a1035ef94279c6d51e72ffea247f1a">æ¡Œé¢å°å·¥å…·</a>ï¼Œè¿˜æœ‰ç”»å›¾çš„<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247483941&amp;idx=1&amp;sn=bb352b5d74797715a9759f64765e49f6&amp;chksm=ec43b362db343a7433d23dd081da263a062e944664ced85d82643eb6e963bccc5d35b43617a8#rd">ggplot2</a>ã€<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247483955&amp;idx=1&amp;sn=0b753422e337e8dd63056d62af9b9e80&amp;chksm=ec43b374db343a62b102a22bc1ebc288c5c4c0ac27db4228bd5214b54b59fa20a948348cebdd">æ€ä¹ˆé…è‰²</a>ã€<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484079&amp;idx=1&amp;sn=2f37b54ad09b966ccb9e8bf93ebd6643&amp;chksm=ec43b3e8db343afed5d55c25aaaba233f3339686e9eba0e65f004a5ca58ac13bba7ba9b5bacc#rd">åµŒå…¥å›¾ç‰‡</a>(æ¯”å¦‚pokemon)ï¼Œ ä»¥åŠ<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484416&amp;idx=1&amp;sn=c089403a2b8ab03d241b6d99ef138f50&amp;chksm=ec43b547db343c51bdae5f76b399072629720cf646ddc1c0b758c7c76d57e8b1e35b47221cf6">emojiä½œå›¾</a>ï¼Œä¹Ÿæœ‰å¥½ç©çš„<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247484504&amp;idx=1&amp;sn=9ce4f3f59d41a27ec3f14c6e77f29a75&amp;chksm=ec43b51fdb343c097ebdaf29ca1eef27c4ea2405555ea2a685f2815c212e93afa337886e1a23">è´´çº¸</a>å’Œ<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247483868&amp;idx=1&amp;sn=412e13481ad636032125a035bf2216b0&amp;chksm=ec43b09bdb34398d060b1898d286b84975e578c1230da0ce2782d56278a6ce0ee95c0965ac5d">è£…é€¼åˆ©å™¨</a>ã€‚</p>

<hr />

<p>ä»Šå¤©è¦ä»‹ç»å¦å¤–ä¸€ä¸ªRåŒ…ï¼Œmagickï¼Œæ˜¯Ré‡Œé¢ç©å›¾ç‰‡çš„åˆ©å™¨ï¼Œä»Šå¤©è¦è®²çš„æ˜¯åœ¨é™æ€å›¾ç‰‡ä¸ŠåŠ åŠ¨æ€å›¾ç‰‡ï¼Œè¿™æ ·æˆ‘ä»¬å¹³æ—¶ç”»ä¸€äº›å­¦æœ¯çš„å›¾ï¼Œå°±å¯ä»¥åŠ ç‚¹æç¬‘çš„åŠ¨æ€å…ƒç´ ä¸Šå»ï¼Œæœ‰åˆ©äºåœ¨åšå®¢å’Œå…¬ä¼—å·ä¸Šè£…é€¼ã€‚</p>

<p>æ— éæ˜¯ç»™æˆ‘ä¸€å¼ é™æ€å›¾å½“èƒŒæ™¯ï¼Œå†æ¥ä¸€å¼ åŠ¨æ€å›¾åŠ åœ¨ä¸Šé¢ï¼Œä¸ºäº†è®©ä»£ç å¯ä»¥é‡ç”¨ï¼Œé¦–å…ˆæ‰“åŒ…ä¸ªå°å‡½æ•°ï¼š</p>

<pre><code class="language-r">add_gif &lt;- function(bg_file, gif_file, out_file, offset, bg_size=&quot;500&quot;, gif_size=&quot;150&quot;) {
	library(magick)
	p &lt;- image_read(bg_file)
	g &lt;- image_read(gif_file)
	g &lt;- image_scale(g, gif_size)

	background &lt;- image_background(image_scale(p, bg_size), &quot;white&quot;, flatten = TRUE)

	frames &lt;- lapply(g, function(frame) {
  		image_composite(background, frame, offset = offset)
	})

	animation &lt;- image_animate(image_join(frames))
	image_write(animation, out_file)
}
</code></pre>

<p>ç„¶åå°±å¯ä»¥æ¥ç©äº†ï¼Œé¦–å…ˆç”¨ä¸Šæ¬¡è®²åˆ°çš„dotplotåšä¸ºåº•å›¾ï¼Œå†ä»ç½‘ä¸Šæ‰¾ä¸€ä¸ªåŠ¨å›¾ï¼Œè°ƒç”¨å‡½æ•°ï¼Œbingo:</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://guangchuangyu.github.io/cn/2017/07/clusterprofiler-dotplot/">
                <h3 class="media-heading">å¬è¯´ä½ ä¹Ÿåœ¨ç”»dotplotï¼Œä½†æ˜¯æˆ‘ä¸æœ!</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jul 7, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>é™ˆåŒçš„â€˜ç”Ÿä¿¡å®å…¸â€™å…¬ä¼—å·å‡ºäº†ç¯‡ã€Š<a href="https://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&amp;mid=2247483978&amp;idx=1&amp;sn=e0c158c0e92375553036cc37f4987e40&amp;chksm=ec0dc7c0db7a4ed6ac593493b7d8b52f11f2feb92d24fa00d19527fbb6f95b24f7e313ef9440#rd">Rè¯­è¨€å­¦ä¹  - å¯Œé›†åˆ†ææ³¡æ³¡å›¾</a>ã€‹ï¼Œæä¸ªshellè„šæœ¬ï¼Œä¸€æ­¥ç»˜å›¾ã€‚è®²äº†è¿™ä¸ªè„šæœ¬å¯ä»¥é€‚ç”¨äºclusterProfilerå’Œå…¶å®ƒè½¯ä»¶çš„å¯Œé›†ç»“æœã€‚</p>

<p>æµ‘èº«éƒ½æ˜¯ç¡¬ä¼¤ï¼Œæˆ‘éƒ½ä¸æƒ³åæ§½ï¼Œä½†ç”±äºä½œè€…é‚€è¯·æˆ‘æç‚¹ï¼Œé‚£å°±åæ§½æ¨¡å¼å…¨å¼€ã€‚</p>

<h2 id="ä¸€ä¸ªcommandå‡ºå›¾-å°ç™½å·²ç»å“­æ™•">ä¸€ä¸ªcommandå‡ºå›¾ï¼Œå°ç™½å·²ç»å“­æ™•</h2>

<p>ä»å‡ºçš„å›¾çœ‹ï¼Œåº”è¯¥æ˜¯ggplot2ç”»çš„ï¼ˆå°±ç®—çŒœé”™ï¼Œè¦åæ§½çš„ä¾ç„¶æ­£ç¡®ï¼‰ï¼Œå°ç™½åœ¨web-serverä¸Šåšäº†åˆ†æï¼Œå­˜ç»“æœä¸ºxlsæ–‡ä»¶ï¼Œæ‹¿ä½ è¿™è„šæœ¬ï¼Œä¸€è·‘æŠ¥é”™ã€‚è¯»xlsæ–‡ä»¶ï¼ˆåˆ«å‘Šè¯‰æˆ‘ä½ è·Ÿç”¨æˆ·è¯´è¯»xlsä½†å…¶å®æ˜¯ä¸ªtsvï¼‰å’Œç”»å›¾çš„ä¾èµ–å…³ç³»æ²¡è§£å†³ï¼ç”¨æˆ·å‹å¥½åœ¨é‚£é‡Œï¼Ÿä¸è¦å‘Šè¯‰æˆ‘ä½ çš„è„šæœ¬0ä¾èµ–ï¼Œæœ‰ä¸ªshellå°±èƒ½è·‘ï¼Œå³ä½¿æˆ‘ä»¬ç†Ÿæ‚‰çš„å„ç§å‘½ä»¤ï¼Œå¾ˆå¤šéƒ½æ˜¯ç‹¬ç«‹ç¨‹åºï¼Œä¸å…³shellä»€ä¹ˆäº‹ã€‚</p>

<h2 id="æ‰€è°“çš„ä¸€æ­¥å‡ºå›¾">æ‰€è°“çš„ä¸€æ­¥å‡ºå›¾</h2>

<p>æ—¢ç„¶è®²äº†clusterProfilerï¼Œé‚£ä¹ˆclusterProfilerç”¨æˆ·ç¬‘è€Œä¸è¯­äº†ã€‚æˆ‘ä»¬ç”¨dotplotä¸ä¹Ÿæ˜¯ä¸€æ¡å‘½ä»¤å‡ºå›¾ï¼Œä¸ºä»€ä¹ˆè¦é€€å‡ºRï¼Œå»è·‘ä½ çš„shellè„šæœ¬ï¼Œè¿™è¿‡ç¨‹è¿˜å¾—è½¬æ¢æ•°æ®ï¼Œå­˜å‚¨æ•°æ®ã€‚æœ€åçš„è¿™ä¸€æ­¥ï¼Œæ˜¯å‰é¢+Næ­¥ä¸ºä»£ä»·çš„ã€‚</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         125 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('https://guangchuangyu.github.io/cn/images/cover.jpg');"></div>
  


    
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.js"></script>


<script src="https://guangchuangyu.github.io/cn/js/script-wl33z0n6ocaypepiqrazthtivfrliqijej4rq8ek8gvrv1awftmgjuv8k4zc.min.js"></script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight').each(function(i, block) {
    var code = "";
    hljs.highlightAuto(block.innerText).value.split(/\r\n|\r|\n/).forEach(function(line) {
      code += "<span class=\"line\">" + line + "</span><br>";
    });
    if (code.length > 0) {
      block.innerHTML = code;  
    }
  });
  $('pre > code').each(function(i, block) {
    $(this).addClass('codeblock');
    hljs.highlightBlock(block);
  });
});
</script>

  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/guangchuangyu.github.io\/cn\/2011\/07\/a-simple-gene-finder\/';
          
            this.page.identifier = '\/2011\/07\/a-simple-gene-finder\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'gcyu';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  





    
  </body>
</html>

