<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cormut on Guangchuang Yu</title>
    <link>https://guangchuangyu.github.io/cn/tags/cormut/</link>
    <description>Recent content in Cormut on Guangchuang Yu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 17 Jan 2017 12:23:16 +0800</lastBuildDate>
    <atom:link href="https://guangchuangyu.github.io/cn/tags/cormut/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title> RåŒ…è¾£é¸¡ä¹‹CorMut</title>
      <link>https://guangchuangyu.github.io/cn/2017/01/r%E5%8C%85%E8%BE%A3%E9%B8%A1%E4%B9%8Bcormut/</link>
      <pubDate>Tue, 17 Jan 2017 12:23:16 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/01/r%E5%8C%85%E8%BE%A3%E9%B8%A1%E4%B9%8Bcormut/</guid>
      <description>

&lt;blockquote&gt;
&lt;p&gt;æ›¾ç»QQä¸Šæœ‰äººå«æˆ‘å¸®å¿™ï¼Œè·‘æŸä¸ªRåŒ…åšä¸ªåˆ†æï¼Œæˆ‘ä¸€çœ‹é‚£åŒ…ï¼Œä¸€å †bugï¼Œæ˜¾ç„¶ä¸èƒ½ç”¨ï¼Œé‚£å°±ä¸æ˜¯ç®€å•çš„äº‹äº†ï¼Œæˆ‘å¯æ²¡ç©ºå¸®ä»–å†™ä»£ç ï¼Œäºæ˜¯ä»–å°±ç»å¸¸æ¶å¿ƒæˆ‘ï¼Œæœ‰äº‹æ²¡äº‹å°±æ¥è¯´æˆ‘å†™ggtreeæ²¡æ„ä¹‰ï¼Œä¸æ˜¯å®è´¨ç§‘ç ”ï¼Œä¸å¦‚è·Ÿä»–åšç‚¹ç‰›é€¼çš„ï¼Œä¸å¦‚å†å†™ä¸ªRåŒ…å¹²ä»–é‚£äº‹ã€‚æ˜¨å¤©ç”¨é©¬ç”²åœ¨è¿›åŒ–ç¾¤é‡Œé—®ç”»æ ‘ï¼Œæˆ‘è¿˜çƒ­å¿ƒè´´ä¸ªä»£ç ç»™ä»–ï¼Œè¯´çœ‹ä¸æ‡‚ï¼Œæˆ‘åœ¨ç¾¤é‡Œè¯´äº†ï¼Œæˆ‘å†™ä¸ªæ–‡è¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚ç„¶è€Œä»–çš„é©¬ç”²èº«ä»½æš´éœ²å•¦ï¼Œæ‰€ä»¥ä»Šæ—¥è·³ç¥¨ï¼Œæˆ‘å†™å¥½çš„æ–‡ä¹Ÿä¸å‘äº†ï¼Œä½ ç‰›é€¼å°±ä¸è¦ç”¨é©¬ç”²æ¥éª—ä»£ç å‘€ï¼Œggtreeæ²¡ç”¨ä½ ä¸è¦ç”¨å‘€ï¼Œå”å°±æ˜¯è¿™ä¹ˆä»»æ€§ğŸ˜&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¹‹å‰è®²è¿‡æŸä¸ªRåŒ…æˆ‘ä¸€çœ‹ä¸€å †bugï¼Œç›´æ¥æ”¾å¼ƒï¼Œä»Šå¤©å€’æ˜¯æ‹¿å‡ºæ¥æ™’ä¸€ä¸‹ï¼Œä¸ä¸ºåˆ«çš„ï¼Œæˆ‘åªæƒ³è¯´ä¸€å¥ï¼Œä¸€çŸ¥åŠè§£æ˜¯å¾ˆå±é™©çš„ï¼Œç›²ç›®ç›¸ä¿¡è½¯ä»¶ä¹Ÿæ˜¯å¾ˆå±é™©çš„ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ¯”å¯¹-ä¸æ¯”å¯¹-è¿™æ˜¯ä¸ªä¸¥è‚ƒçš„é—®é¢˜:73d341715265d4d00941b1a9c2cbba18&#34;&gt;æ¯”å¯¹ï¼Ÿä¸æ¯”å¯¹ï¼Ÿè¿™æ˜¯ä¸ªä¸¥è‚ƒçš„é—®é¢˜&lt;/h2&gt;

&lt;p&gt;è¯è¯´æ­¤åŒ…çš„è¾“å…¥æ˜¯alignmentï¼Œæˆ‘åˆšå¼€å§‹ä¹Ÿæ²¡çœ‹ä»£ç ï¼Œç…§ç€ç¤ºä¾‹è·‘ä¸€ä¸‹ï¼Œä½†è¯»åºåˆ—çš„æ—¶å€™ï¼Œæˆ‘å°±æƒŠå‘†äº†ï¼Œæ€ä¹ˆè¯»ä¸ªfastaè¿™ä¹ˆæ…¢ï¼Œäºæ˜¯æˆ‘å¼€å§‹çœ‹ä»£ç ï¼Œä¸çœ‹ä¸çŸ¥é“ï¼Œä¸€çœ‹å“ä¸€è·³ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;seq_f01=as.list(sapply(allSeq,function(x)c2s(s2c(x)[ref01!=&amp;quot;-&amp;quot;])))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªs2cæŠŠstringå˜æˆcharacter vectorï¼Œc2såˆ™åè¿‡æ¥ï¼Œè¿™ä¸€å¥å°±å¹²ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰stringï¼ˆfastaè¯»è¿›æ¥çš„sequencesï¼‰ä¸­çš„-å…¨éƒ¨åˆ é™¤ã€‚å°±è¿™ä¹ˆä¸€åˆ‡ä¸€è´´ï¼Œéå¸¸éå¸¸æ…¢ï¼Œç®€å•åœ°ç”¨&lt;code&gt;gsub(â€œ-â€œ, â€œâ€, allSeq)&lt;/code&gt;å°±å¯ä»¥éå¸¸å¿«é€ŸåšåŒæ ·çš„äº‹æƒ…ã€‚
ç„¶åè¿™æ—¶å€™æˆ‘ä»¬ä¼¼ä¹è§‰å¾—é‚£é‡Œä¸å¦¥ï¼ä½ æŠŠ&lt;code&gt;-&lt;/code&gt;å…¨åˆ äº†ï¼Œç­‰äºæ˜¯æŠŠæ¯”å¯¹åºåˆ—å˜æˆäº†éæ¯”å¯¹åºåˆ—ã€‚é‚£ä¹ˆä½ è¦æ±‚è¾“å…¥æ˜¯æ¯”å¯¹åºåˆ—æ˜¯ä¸ºä»€ä¹ˆï¼Ÿï¼
ç¡®å®åºåˆ—å¿…é¡»å¾—æ˜¯æ¯”å¯¹å¥½çš„ï¼Œå› ä¸ºè¿™åŒ…å°±æ˜¯è¦æ£€æµ‹correlated mutationsï¼Œå®ƒæ¯”çš„æ˜¯codon, è¿™å¿…é¡»æ˜¯æ¯”å¯¹å¥½çš„åºåˆ—æ‰è¡Œï¼Œä½†åœ¨è¯»åºåˆ—çš„æ—¶å€™ï¼Œå°±æŠŠ-ç»™åˆ äº†ï¼Œåºåˆ—ä¸å†æ˜¯æ¯”å¯¹å¥½çš„ï¼Œæœ¬æ¥å¯¹åº”çš„codonç°åœ¨å¿…ç„¶å¾ˆå¤šéƒ½ç§»ä½äº†ï¼Œè¿™åœ¨ä¸€å¼€å§‹å°±æŒ–äº†å·¨å¤§çš„å‘ã€‚åé¢æ‰€æœ‰çš„è®¡ç®—å¿…é¡»éƒ½æ˜¯è¾£é¸¡äº†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;codonæ¯”è¾ƒ-æ•°æ•°å­—ä½ ä¼šå—:73d341715265d4d00941b1a9c2cbba18&#34;&gt;codonæ¯”è¾ƒï¼Œæ•°æ•°å­—ä½ ä¼šå—ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/Bioconductor-mirror/CorMut/blob/master/R/CorMut-internal.R#L125-L129&#34;&gt;https://github.com/Bioconductor-mirror/CorMut/blob/master/R/CorMut-internal.R#L125-L129&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;for(j in 1:length(seqf[[i]])){
	if(j%%3==1){ tris=seqf[[i]][j:(j+2)]
	}else if(j%%3==2){ tris=seqf[[i]][(j-1):(j+1)]
	}else if(j%%3==0){ tris=seqf[[i]][(j-2):j]
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™å¾ªç¯ç«Ÿç„¶ä¸æ˜¯ä¸€ä¸ªcodonä¸€ä¸ªcodonæ¥ï¼Œè€Œæ˜¯ä¸€ä¸ªbaseä¸€ä¸ªbaseåœ°è¿­ä»£ï¼Œè¿™é‡Œç§»åŠ¨ä¸‰ä¸ªä½ç½®ï¼Œæ‹¿åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªcodonï¼Œç„¶åå®ƒå°±å»æ¯”è¾ƒæ˜¯å¦ä¸åŒï¼Œæ•°æ•°ç›®äº†ï¼Œä¸€ä¸ªä¸åŒï¼Œæ•°å®ƒ3éï¼Œæˆ‘ä¹Ÿæ˜¯é†‰äº†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;på€¼ä½ ä¼šç®—å—:73d341715265d4d00941b1a9c2cbba18&#34;&gt;på€¼ä½ ä¼šç®—å—ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/Bioconductor-mirror/CorMut/blob/release-3.4/R/kaksAA.R#L67-L77&#34;&gt;https://github.com/Bioconductor-mirror/CorMut/blob/release-3.4/R/kaksAA.R#L67-L77&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;LOD=0
Nnum=NS+NY
for(ii in NYs:Nnum){
	per_item=choose(Nnum,ii)*(q^ii)*((1-q)^(Nnum-ii))
	#avoid the appear of NaN
	if(per_item!=&amp;quot;NaN&amp;quot;){
		LOD=per_item+LOD
	}
	#print(choose(dim(mat)[2],i)*(q^i)*((1-q)^(dim(mat)[2]-i)))
}
LOD=-log10(LOD)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“ç®—på€¼æ˜¯ç®—ç§¯åˆ†é¢ç§¯ï¼Œå®ƒå€’å¥½ï¼Œç¦»æ•£æ€§åˆ†å¸ƒè¿™ä¸€ä¸ªä¸ªæ•°å­—æ¥è®¡ç®—ï¼Œç„¶åæ±‚åˆã€‚
è¿™é‡Œç”¨çš„æ˜¯äºŒé¡¹å¼åˆ†å¸ƒï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;per_item=choose(Nnum,ii)(q^ii)((1-q)^(Nnum-ii))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªåŸºæœ¬ä¸Šä½ ç®—å‡ºæ¥ä¼šæœ‰å¾ˆå¤š0å’ŒNaNï¼Œç²¾åº¦é—®é¢˜å˜›ï¼Œè¿™æ ·ç®—å¿…é¡»æ˜¯ä¸å‡†çš„ã€‚ç„¶åä»–å¿…é¡»æ˜¯è·‘äº†è‡ªå·±ä»£ç å‡ºä¸æ¥på€¼ï¼Œå‘ç°æœ‰å¾ˆå¤šNaNï¼Œä¹Ÿä¸å»æƒ³ä¸ºä»€ä¹ˆï¼Œç›´æ¥æŠŠNaNç»™æ‰”äº†ã€‚è¿™æ ¹æœ¬å°±æ˜¯é”™çš„ï¼Œä¹Ÿä¸çŸ¥é“ç”¨pbinomå»ç®—ï¼Œæˆ‘ä¹Ÿæ˜¯æœäº†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“:73d341715265d4d00941b1a9c2cbba18&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;æˆ‘åªæ˜¯ç²—ç•¥åœ°çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå°±å‘ç°å¾ˆå¤šé”™è¯¯ï¼Œè€Œä¸”å‡ ä¹æ¯ä¸ªé‡è¦çš„éƒ¨åˆ†éƒ½å‡ºé”™ã€‚é—®é¢˜è‚¯å®šæ¯”æˆ‘ç²—ç•¥çœ‹ä¸€ä¸‹æ‰€èƒ½å‘ç°åœ°å¤šå¾—å¤šã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è¯»åºåˆ—ï¼ŒæŠŠæ¯”å¯¹çš„åºåˆ—ææˆäº†éæ¯”å¯¹ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”è¾ƒcodonï¼Œåºåˆ—éæ¯”å¯¹è¿™æ¯”æ¯›çº¿å•Šï¼Œç„¶åè¿æ•°æ•°ç›®éƒ½æ•°é”™ã€‚&lt;/li&gt;
&lt;li&gt;på€¼ï¼Œç®€å•äºŒé¡¹å¼ï¼Œä½ éƒ½ä¸ä¼šç®—å•Šï¼Œç®€å•ç²—æš´åœ°å¯¹NaNè§†è€Œä¸è§ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™è´§ä¸­å›½CDCå‡ºå“ï¼Œç«Ÿç„¶è¿˜å‘äº†Bioinformaticsï¼Œreviewerç®€ç›´ççœ¼äº†ï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2017/2017-01-09-002515_560x405_scrot.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;â€‹&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>