<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Clusterprofiler on Guangchuang Yu</title>
    <link>https://guangchuangyu.github.io/cn/tags/clusterprofiler/</link>
    <description>Recent content in Clusterprofiler on Guangchuang Yu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 27 Jul 2017 07:05:22 +0800</lastBuildDate>
    
	<atom:link href="https://guangchuangyu.github.io/cn/tags/clusterprofiler/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>听说你也在画dotplot，但是我不服!</title>
      <link>https://guangchuangyu.github.io/cn/2017/07/clusterprofiler-dotplot/</link>
      <pubDate>Thu, 27 Jul 2017 07:05:22 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/07/clusterprofiler-dotplot/</guid>
      <description> 陈同的‘生信宝典’公众号出了篇《R语言学习 - 富集分析泡泡图》，搞个shell脚本，一步绘图。讲了这个脚本可以适用于clusterProfiler和其它软件的富集结果。
浑身都是硬伤，我都不想吐槽，但由于作者邀请我提点，那就吐槽模式全开。
一个command出图，小白已经哭晕 从出的图看，应该是ggplot2画的（就算猜错，要吐槽的依然正确），小白在web-server上做了分析，存结果为xls文件，拿你这脚本，一跑报错。读xls文件（别告诉我你跟用户说读xls但其实是个tsv）和画图的依赖关系没解决！用户友好在那里？不要告诉我你的脚本0依赖，有个shell就能跑，即使我们的各种命令，很多都是独立程序，不关shell什么事。
所谓的一步出图 既然讲了clusterProfiler，那么clusterProfiler用户笑而不语了。我们用dotplot不也是一条命令出图，为什么要退出R，去跑你的shell脚本，这过程还得转换数据，存储数据。最后的这一步，是前面+N步为代价的。
一步出图是邪恶的！ 做为ggplot2画的图，我们用clusterProfiler的dotplot，写文件前，可以先看一下，做点调整。你搞个脚本缺少了用户互动的重要一步。
生物狗开口闭口都是next generation。画图也是二代了好么！一步出图是第一代产品，因为你只有纸笔模式，画完就完事了，那是死图，你想改，illustrator啊！
现在这年代，图已经不能简单地称为图，都是数据，只有在需要渲染图片时才是死图，做为数据，你是可以改的，改完再渲染，效果就变了。你用着二代产品，却在干一代产品的活，能不邪恶吗？
比如下面这个：
library(clusterProfiler) data(gcSample) x &amp;lt;- compareCluster(gcSample, &#39;enrichDO&#39;) p &amp;lt;- dotplot(x, showCategory=10)  clusterProfiler出的图，我们可以随意改啊，比如改颜色：
p2 &amp;lt;- p + scale_color_continuous(low=&#39;purple&#39;, high=&#39;green&#39;)  再比如改点的形状：
p2 + aes(shape=GeneRatio &amp;gt; 0.1)  比如字体溢出、长文本截断、设置点的大小等等都可以搞，你还可以改图例，改背景等各种元素等等！
我所说的硬伤 下面是陈同原文里的图：
我当时看了说硬伤，告诉他没overlap，他不明白，请我详细讲，于是有本文。
他上面的图是给人的感觉就是两组实验非常不同，完全没有overlap，但实际并非如此，只是我们没办法把所有富集结果展示出来而已，只展示了最显著的一部分。然而我们在截取最显著的部分时，应该把其它组实验中有overlap的结果也截出来，这个在我讲解showCategory参数中已经有明显明确说明。
最后来两个硬广， 硬广一 对于富集结果没办法完全展示这个问题，我们会发现最显著的那些，其实都overlap了很多基因，特别是GO的分析结果，GO的冗余太多，clusterProfiler提供了simplify函数，可以去冗余哟，让我们解析结果更容易，这个后面也会介绍。
硬广二 有些人就喜欢自己用ggplot2画，可能觉得透明吧，自己搞有逼格吧。氮素像上面的槽点，像这个includeAll的参数，在把clusterProfiler的结果转变成data.frame后进行处理的时候，你是否能够考虑到？我见过太多自己画的，都是不同实验组给人一种绝然不同富集结果的错觉。
然而我写的代码，模块化非常好，数据处理和可视化是分开的，clusterProfiler的输出你不用as.data.frame，就可以直接传给ggplot2，别的富集软件做的，不是data.frame对象的，都不能传给ggplot2，但clusterProfiler可以，如果你想问为什么，原因只有一个，因为那是我写的！clusterProfiler的dotplot所有参数，都可以传给ggplot2，像上面用到的showCategory, includeAll这些都可以，然后数据处理于无形中，你可以加图层自己画图了。这个功能存在了好几年，只不过我第一次公开讲。
ggplot(x, aes(Cluster, Description), showCategory=8) + geom_point(aes(color=qvalue, size=GeneRatio))  再次重申， clusterProfiler之所以好，因为真的考虑了很多细节！请放开那图，让clusterProfiler来画！ 电梯直达相关阅读  ggplot2字体溢出的那点破事 wrapping labels in ggplot2 dotplot展示富集分析结果 搞大你的点，让我们画真正的气泡图  </description>
    </item>
    
    <item>
      <title>非模式基因GO富集分析：以玉米为例&#43;使用OrgDb</title>
      <link>https://guangchuangyu.github.io/cn/2017/07/clusterprofiler-maize/</link>
      <pubDate>Mon, 24 Jul 2017 08:53:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/07/clusterprofiler-maize/</guid>
      <description>&lt;p&gt;模式生物做什么都简单，非模式生物则很多缺少注释，没有注释你就没法做，只能是借助于各种软件比如blastgo，自己跑电子注释。但今天要讲的不是这种情况，很多物种还是有注释的，只是你有时候不知道该去那里下载，或者你有数据，却不知道该怎么用！很多的软件都是针对模式生物的，或者针对某一些类型的非模式生物，能够支持多种非模式生物，能够支持用户自己的注释文件的软件相对来讲，就非常少有了，然而clusterProfiler就是这类少有的软件之一。&lt;/p&gt;

&lt;h2 id=&#34;获得orgdb&#34;&gt;获得OrgDb&lt;/h2&gt;

&lt;p&gt;今天要讲的是通过OrgDb来做GO分析，这是clusterProfiler的&lt;strong&gt;enrichGO&lt;/strong&gt;函数所支持的背景注释，Bioconductor自带20个OrgDb可供使用，多半是模式生物，难道我们要做的物种不在这20个里面就不行了吗？显然不是的，clusterProfiler能支持的物种我自己都数不过来。&lt;/p&gt;

&lt;p&gt;我们可以通过AnnotationHub在线检索并抓取OrgDb，比如这里以玉米为例：&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>SCIENCE文章用了DAVID被吐槽</title>
      <link>https://guangchuangyu.github.io/cn/2017/07/david-clusterprofiler/</link>
      <pubDate>Thu, 06 Jul 2017 05:44:27 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/07/david-clusterprofiler/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/DAVID/science.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;好端端的一篇文章，因为用了DAVID，在PubPeer上就被吐槽了：&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>enrichDAVID支持自定义背景</title>
      <link>https://guangchuangyu.github.io/cn/2017/05/enrichdavid%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89%E8%83%8C%E6%99%AF/</link>
      <pubDate>Tue, 16 May 2017 07:04:22 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/05/enrichdavid%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89%E8%83%8C%E6%99%AF/</guid>
      <description>&lt;p&gt;虽然我不喜欢DAVID，但很多用户喜欢，所以clusterProfiler也支持了，最近github上又有人&lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/87&#34;&gt;要求支持自定义背景&lt;/a&gt;。&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Dear Guangchuang,&lt;/p&gt;

&lt;p&gt;I am using clusterProfiler in Kegg pathway enrichment analysis, it is useful and nice. I am looking for a function which accept background and has ability to deal with Ensembl gene ID.&lt;/p&gt;

&lt;p&gt;In a function enrichDAVID it can takes ensembl gene id as an input format, but not allows to enter background.
&lt;code&gt;enrichDAVID(gene = gene, idType=&amp;quot;ENSEMBL_GENE_ID&amp;quot;, annotation=&amp;quot;KEGG_PATHWAY&amp;quot;, species= &amp;quot;hsa&amp;quot;)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Other command enrichKEGG has a background input but only takes entrez gene id,
&lt;code&gt;enrichKEGG(gene, organism = &amp;quot;hsa&amp;quot;, keyType = &amp;quot;kegg&amp;quot;, universe)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;I have tried to convert my ensembl gene IDs to entrez gene id, but some ensembl gene IDs represent more than one entrez gene ID.
I downloaded KEGG pathway dataset to apply fisher exact test. however, genes are in entrez ID and i am still dont know how to convert.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>wrapping labels in ggplot2</title>
      <link>https://guangchuangyu.github.io/cn/2017/02/wrapping-labels-in-ggplot2/</link>
      <pubDate>Tue, 14 Feb 2017 09:50:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2017/02/wrapping-labels-in-ggplot2/</guid>
      <description>&lt;p&gt;在公众号biobabble后台有多人同时在问这个问题：&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/2017/2017-02-12-223832_646x667_scrot.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;晒这个截屏主要想说一点，如果是一两句话就能说清楚的问题，可以提问，如果不是，则不要在后台提问，写邮件或者到论坛提问，是更好的方式，像截屏中显示的，图片显示过期，我根本就没看到过图片。在手机上是无法看的，而我正好几天没在电脑前，于是你们发的图片我看不了，而且我如果没有在24小时之内回复，公众平台就不允许我回复了，因为问题已经过期。所以在此强调，不要在后台发图片提问，不要在后台问稍复杂的问题。&lt;/p&gt;

&lt;p&gt;这个问题其实很简单，用&lt;code&gt;stringr&lt;/code&gt;包的&lt;code&gt;str_wrap&lt;/code&gt;来完成文本自动换行就行了。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>buildGOmap</title>
      <link>https://guangchuangyu.github.io/cn/2016/11/buildgomap/</link>
      <pubDate>Mon, 28 Nov 2016 00:53:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/11/buildgomap/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/640.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;周末Bioconductor上的问题，说的是他用了buildGOmap之后，在终端上输出了一长串，但没有文件产生，今天就来讲讲这个buildGOmap的前世今生。&lt;/p&gt;

&lt;p&gt;当年写clusterProfiler的时候在暨大工作，主要也是自己的需求驱动，因为实验室里有做细菌，比如肺炎链球菌D39，在细菌界基本上所谓的GO分析，就是跑个电子注释，然后数一下数目，列个表格画个饼图。很难看到有富集性分析的身影，因为绝大多数的工具是只支持少量模式生物的，还有部分工具比如支持某些细菌，支持某些植物或者某些真菌，比如支持植物的，也只是支持少量的植物物种而已，都是些自己定制给自己用的玩意，放出来只是为了顺道灌水而已。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Evolution of my BioC packages</title>
      <link>https://guangchuangyu.github.io/cn/2016/07/evolution-of-my-bioc-packages/</link>
      <pubDate>Wed, 13 Jul 2016 21:06:59 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/cn/2016/07/evolution-of-my-bioc-packages/</guid>
      <description>&lt;p&gt;发现Youtube上有一个视频叫&lt;a href=&#34;https://www.youtube.com/watch?v=MYTblx-5Yog&#34;&gt;Evolution of clusterProfiler&lt;/a&gt;, 是Landon Wilkins用&lt;a href=&#34;http://gource.io/&#34;&gt;Gource&lt;/a&gt;做的。于是我也来玩一下，看一下自己这几年码代码的过程。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>