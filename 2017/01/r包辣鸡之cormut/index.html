<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <title> RåŒ…è¾£é¸¡ä¹‹CorMut</title>

  
  
  <link rel="stylesheet" href="https://guangchuangyu.github.io/cn/css/hugo-octopress.css">

  
  

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link href="https://guangchuangyu.github.io/cn/favicon.png" rel="icon">

  
  
  

  

  <meta name="description" content="">
  <meta name="keywords" content="">

  <meta name="author" content="Guangchuang Yu">

  
  <meta name="generator" content="Hugo 0.15" />

  
  
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-77901140-1', 'auto');
ga('send', 'pageview');
</script>


</head>
<body>


<header role="banner"><hgroup>
  
  <h1><a href="https://guangchuangyu.github.io/cn/">Guangchuang Yu</a></h1>
    <h2>a senior-in-age-but-not-senior-in-knowledge bioinformatician</h2>
</hgroup></header>


<nav role="navigation">

<ul class="main-navigation">
  
  
    
      <li><a href="https://guangchuangyu.github.io/cn/" target="_blank" title="Blog">Blog</a></li>
    
  
    
      <li><a href="https://guangchuangyu.github.io/resume" target="_blank" title="Resume">Resume</a></li>
    
  
    
      <li><a href="https://guangchuangyu.github.io/cn/douban" target="_blank" title="Douban">Douban</a></li>
    
  
    
      <li><a href="https://guangchuangyu.github.io/cn/archive" target="_blank" title="Archive">Archive</a></li>
    
  
</ul>


<ul class="subscription">
  <a href="https://guangchuangyu.github.io/cn/index.xml" target="_blank" type="application/rss+xml" title="RSS"><i class="fa fa-rss-square fa-lg"></i></a>

  
  

</ul>


</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">
        <header>
          <h1 class="entry-title">
             RåŒ…è¾£é¸¡ä¹‹CorMut 
          </h1>
          <p class="meta">Jan 17, 2017 - 1 minute read -  <a href="https://guangchuangyu.github.io/cn/2017/01/r%E5%8C%85%E8%BE%A3%E9%B8%A1%E4%B9%8Bcormut/#disqus_thread">Comments</a>

          

          
          
          <a class="label" href="https://guangchuangyu.github.io/cn/categories/r">R</a>
          </p>
        </header>
        <div class="entry-content">
          
          
          

	  
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_dd" href="//www.addtoany.com/share"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_google_plus"></a>
<a class="a2a_button_pinterest"></a>
<a class="a2a_button_reddit"></a>
<a class="a2a_button_sina_weibo"></a>
<a class="a2a_button_wechat"></a>
<a class="a2a_button_douban"></a>
</div>
<script async src="//static.addtoany.com/menu/page.js"></script>

<br>

    

<blockquote>
<p>æ›¾ç»QQä¸Šæœ‰äººå«æˆ‘å¸®å¿™ï¼Œè·‘æŸä¸ªRåŒ…åšä¸ªåˆ†æï¼Œæˆ‘ä¸€çœ‹é‚£åŒ…ï¼Œä¸€å †bugï¼Œæ˜¾ç„¶ä¸èƒ½ç”¨ï¼Œé‚£å°±ä¸æ˜¯ç®€å•çš„äº‹äº†ï¼Œæˆ‘å¯æ²¡ç©ºå¸®ä»–å†™ä»£ç ï¼Œäºæ˜¯ä»–å°±ç»å¸¸æ¶å¿ƒæˆ‘ï¼Œæœ‰äº‹æ²¡äº‹å°±æ¥è¯´æˆ‘å†™ggtreeæ²¡æ„ä¹‰ï¼Œä¸æ˜¯å®è´¨ç§‘ç ”ï¼Œä¸å¦‚è·Ÿä»–åšç‚¹ç‰›é€¼çš„ï¼Œä¸å¦‚å†å†™ä¸ªRåŒ…å¹²ä»–é‚£äº‹ã€‚æ˜¨å¤©ç”¨é©¬ç”²åœ¨è¿›åŒ–ç¾¤é‡Œé—®ç”»æ ‘ï¼Œæˆ‘è¿˜çƒ­å¿ƒè´´ä¸ªä»£ç ç»™ä»–ï¼Œè¯´çœ‹ä¸æ‡‚ï¼Œæˆ‘åœ¨ç¾¤é‡Œè¯´äº†ï¼Œæˆ‘å†™ä¸ªæ–‡è¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚ç„¶è€Œä»–çš„é©¬ç”²èº«ä»½æš´éœ²å•¦ï¼Œæ‰€ä»¥ä»Šæ—¥è·³ç¥¨ï¼Œæˆ‘å†™å¥½çš„æ–‡ä¹Ÿä¸å‘äº†ï¼Œä½ ç‰›é€¼å°±ä¸è¦ç”¨é©¬ç”²æ¥éª—ä»£ç å‘€ï¼Œggtreeæ²¡ç”¨ä½ ä¸è¦ç”¨å‘€ï¼Œå”å°±æ˜¯è¿™ä¹ˆä»»æ€§ğŸ˜</p>
</blockquote>

<p>ä¹‹å‰è®²è¿‡æŸä¸ªRåŒ…æˆ‘ä¸€çœ‹ä¸€å †bugï¼Œç›´æ¥æ”¾å¼ƒï¼Œä»Šå¤©å€’æ˜¯æ‹¿å‡ºæ¥æ™’ä¸€ä¸‹ï¼Œä¸ä¸ºåˆ«çš„ï¼Œæˆ‘åªæƒ³è¯´ä¸€å¥ï¼Œä¸€çŸ¥åŠè§£æ˜¯å¾ˆå±é™©çš„ï¼Œç›²ç›®ç›¸ä¿¡è½¯ä»¶ä¹Ÿæ˜¯å¾ˆå±é™©çš„ã€‚</p>

<h2 id="æ¯”å¯¹-ä¸æ¯”å¯¹-è¿™æ˜¯ä¸ªä¸¥è‚ƒçš„é—®é¢˜:73d341715265d4d00941b1a9c2cbba18">æ¯”å¯¹ï¼Ÿä¸æ¯”å¯¹ï¼Ÿè¿™æ˜¯ä¸ªä¸¥è‚ƒçš„é—®é¢˜</h2>

<p>è¯è¯´æ­¤åŒ…çš„è¾“å…¥æ˜¯alignmentï¼Œæˆ‘åˆšå¼€å§‹ä¹Ÿæ²¡çœ‹ä»£ç ï¼Œç…§ç€ç¤ºä¾‹è·‘ä¸€ä¸‹ï¼Œä½†è¯»åºåˆ—çš„æ—¶å€™ï¼Œæˆ‘å°±æƒŠå‘†äº†ï¼Œæ€ä¹ˆè¯»ä¸ªfastaè¿™ä¹ˆæ…¢ï¼Œäºæ˜¯æˆ‘å¼€å§‹çœ‹ä»£ç ï¼Œä¸çœ‹ä¸çŸ¥é“ï¼Œä¸€çœ‹å“ä¸€è·³ï¼š</p>

<pre><code class="language-r">seq_f01=as.list(sapply(allSeq,function(x)c2s(s2c(x)[ref01!=&quot;-&quot;])))
</code></pre>

<p>è¿™ä¸ªs2cæŠŠstringå˜æˆcharacter vectorï¼Œc2såˆ™åè¿‡æ¥ï¼Œè¿™ä¸€å¥å°±å¹²ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰stringï¼ˆfastaè¯»è¿›æ¥çš„sequencesï¼‰ä¸­çš„-å…¨éƒ¨åˆ é™¤ã€‚å°±è¿™ä¹ˆä¸€åˆ‡ä¸€è´´ï¼Œéå¸¸éå¸¸æ…¢ï¼Œç®€å•åœ°ç”¨<code>gsub(â€œ-â€œ, â€œâ€, allSeq)</code>å°±å¯ä»¥éå¸¸å¿«é€ŸåšåŒæ ·çš„äº‹æƒ…ã€‚
ç„¶åè¿™æ—¶å€™æˆ‘ä»¬ä¼¼ä¹è§‰å¾—é‚£é‡Œä¸å¦¥ï¼ä½ æŠŠ<code>-</code>å…¨åˆ äº†ï¼Œç­‰äºæ˜¯æŠŠæ¯”å¯¹åºåˆ—å˜æˆäº†éæ¯”å¯¹åºåˆ—ã€‚é‚£ä¹ˆä½ è¦æ±‚è¾“å…¥æ˜¯æ¯”å¯¹åºåˆ—æ˜¯ä¸ºä»€ä¹ˆï¼Ÿï¼
ç¡®å®åºåˆ—å¿…é¡»å¾—æ˜¯æ¯”å¯¹å¥½çš„ï¼Œå› ä¸ºè¿™åŒ…å°±æ˜¯è¦æ£€æµ‹correlated mutationsï¼Œå®ƒæ¯”çš„æ˜¯codon, è¿™å¿…é¡»æ˜¯æ¯”å¯¹å¥½çš„åºåˆ—æ‰è¡Œï¼Œä½†åœ¨è¯»åºåˆ—çš„æ—¶å€™ï¼Œå°±æŠŠ-ç»™åˆ äº†ï¼Œåºåˆ—ä¸å†æ˜¯æ¯”å¯¹å¥½çš„ï¼Œæœ¬æ¥å¯¹åº”çš„codonç°åœ¨å¿…ç„¶å¾ˆå¤šéƒ½ç§»ä½äº†ï¼Œè¿™åœ¨ä¸€å¼€å§‹å°±æŒ–äº†å·¨å¤§çš„å‘ã€‚åé¢æ‰€æœ‰çš„è®¡ç®—å¿…é¡»éƒ½æ˜¯è¾£é¸¡äº†ã€‚</p>

<h2 id="codonæ¯”è¾ƒ-æ•°æ•°å­—ä½ ä¼šå—:73d341715265d4d00941b1a9c2cbba18">codonæ¯”è¾ƒï¼Œæ•°æ•°å­—ä½ ä¼šå—ï¼Ÿ</h2>

<p><a href="https://github.com/Bioconductor-mirror/CorMut/blob/master/R/CorMut-internal.R#L125-L129">https://github.com/Bioconductor-mirror/CorMut/blob/master/R/CorMut-internal.R#L125-L129</a>:</p>

<pre><code class="language-r">for(j in 1:length(seqf[[i]])){
	if(j%%3==1){ tris=seqf[[i]][j:(j+2)]
	}else if(j%%3==2){ tris=seqf[[i]][(j-1):(j+1)]
	}else if(j%%3==0){ tris=seqf[[i]][(j-2):j]
}
</code></pre>

<p>è¿™å¾ªç¯ç«Ÿç„¶ä¸æ˜¯ä¸€ä¸ªcodonä¸€ä¸ªcodonæ¥ï¼Œè€Œæ˜¯ä¸€ä¸ªbaseä¸€ä¸ªbaseåœ°è¿­ä»£ï¼Œè¿™é‡Œç§»åŠ¨ä¸‰ä¸ªä½ç½®ï¼Œæ‹¿åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªcodonï¼Œç„¶åå®ƒå°±å»æ¯”è¾ƒæ˜¯å¦ä¸åŒï¼Œæ•°æ•°ç›®äº†ï¼Œä¸€ä¸ªä¸åŒï¼Œæ•°å®ƒ3éï¼Œæˆ‘ä¹Ÿæ˜¯é†‰äº†ã€‚</p>

<h2 id="på€¼ä½ ä¼šç®—å—:73d341715265d4d00941b1a9c2cbba18">på€¼ä½ ä¼šç®—å—ï¼Ÿ</h2>

<p><a href="https://github.com/Bioconductor-mirror/CorMut/blob/release-3.4/R/kaksAA.R#L67-L77">https://github.com/Bioconductor-mirror/CorMut/blob/release-3.4/R/kaksAA.R#L67-L77</a>:</p>

<pre><code class="language-r">LOD=0
Nnum=NS+NY
for(ii in NYs:Nnum){
	per_item=choose(Nnum,ii)*(q^ii)*((1-q)^(Nnum-ii))
	#avoid the appear of NaN
	if(per_item!=&quot;NaN&quot;){
		LOD=per_item+LOD
	}
	#print(choose(dim(mat)[2],i)*(q^i)*((1-q)^(dim(mat)[2]-i)))
}
LOD=-log10(LOD)
</code></pre>

<p>æˆ‘ä»¬çŸ¥é“ç®—på€¼æ˜¯ç®—ç§¯åˆ†é¢ç§¯ï¼Œå®ƒå€’å¥½ï¼Œç¦»æ•£æ€§åˆ†å¸ƒè¿™ä¸€ä¸ªä¸ªæ•°å­—æ¥è®¡ç®—ï¼Œç„¶åæ±‚åˆã€‚
è¿™é‡Œç”¨çš„æ˜¯äºŒé¡¹å¼åˆ†å¸ƒï¼š</p>

<pre><code class="language-r">per_item=choose(Nnum,ii)(q^ii)((1-q)^(Nnum-ii))
</code></pre>

<p>è¿™ä¸ªåŸºæœ¬ä¸Šä½ ç®—å‡ºæ¥ä¼šæœ‰å¾ˆå¤š0å’ŒNaNï¼Œç²¾åº¦é—®é¢˜å˜›ï¼Œè¿™æ ·ç®—å¿…é¡»æ˜¯ä¸å‡†çš„ã€‚ç„¶åä»–å¿…é¡»æ˜¯è·‘äº†è‡ªå·±ä»£ç å‡ºä¸æ¥på€¼ï¼Œå‘ç°æœ‰å¾ˆå¤šNaNï¼Œä¹Ÿä¸å»æƒ³ä¸ºä»€ä¹ˆï¼Œç›´æ¥æŠŠNaNç»™æ‰”äº†ã€‚è¿™æ ¹æœ¬å°±æ˜¯é”™çš„ï¼Œä¹Ÿä¸çŸ¥é“ç”¨pbinomå»ç®—ï¼Œæˆ‘ä¹Ÿæ˜¯æœäº†ã€‚</p>

<h2 id="æ€»ç»“:73d341715265d4d00941b1a9c2cbba18">æ€»ç»“</h2>

<p>æˆ‘åªæ˜¯ç²—ç•¥åœ°çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå°±å‘ç°å¾ˆå¤šé”™è¯¯ï¼Œè€Œä¸”å‡ ä¹æ¯ä¸ªé‡è¦çš„éƒ¨åˆ†éƒ½å‡ºé”™ã€‚é—®é¢˜è‚¯å®šæ¯”æˆ‘ç²—ç•¥çœ‹ä¸€ä¸‹æ‰€èƒ½å‘ç°åœ°å¤šå¾—å¤šã€‚</p>

<ul>
<li>è¯»åºåˆ—ï¼ŒæŠŠæ¯”å¯¹çš„åºåˆ—ææˆäº†éæ¯”å¯¹ã€‚</li>
<li>æ¯”è¾ƒcodonï¼Œåºåˆ—éæ¯”å¯¹è¿™æ¯”æ¯›çº¿å•Šï¼Œç„¶åè¿æ•°æ•°ç›®éƒ½æ•°é”™ã€‚</li>
<li>på€¼ï¼Œç®€å•äºŒé¡¹å¼ï¼Œä½ éƒ½ä¸ä¼šç®—å•Šï¼Œç®€å•ç²—æš´åœ°å¯¹NaNè§†è€Œä¸è§ã€‚</li>
</ul>

<p>è¿™è´§ä¸­å›½CDCå‡ºå“ï¼Œç«Ÿç„¶è¿˜å‘äº†Bioinformaticsï¼Œreviewerç®€ç›´ççœ¼äº†ï¼</p>

<p><img src="https://guangchuangyu.github.io/blog_images/2017/2017-01-09-002515_560x405_scrot.png" alt="" /></p>

<p>â€‹</p>


 
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Guangchuang Yu</span></span>
    
    <time>Jan 17, 2017</time>
    <span class="categories">
      Tags:
        
        
          <a class="category" href="https://guangchuangyu.github.io/cn/tags/cormut">CorMut</a>  
        
    </span>
  </p>

  
  

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://guangchuangyu.github.io/cn/2017/01/chipseq%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/" title="ChIPseqä»å…¥é—¨åˆ°æ”¾å¼ƒ">ChIPseqä»å…¥é—¨åˆ°æ”¾å¼ƒ</a>
    

    
      <a class="basic-alignment right" href="https://guangchuangyu.github.io/cn/2017/01/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E6%96%87markdown%E4%B8%80%E9%94%AE%E6%8E%92%E7%89%88/" title="å¾®ä¿¡å…¬ä¼—æ–‡markdownä¸€é”®æ’ç‰ˆ">å¾®ä¿¡å…¬ä¼—æ–‡markdownä¸€é”®æ’ç‰ˆ</a>
    
  </p>


  

  
    
      <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    
    

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'gcyu';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
  
</footer>

      </article>
    </div>
    


<aside class="sidebar thirds">
  <section class="first odd">
    

    <p>
      
      
      <script src="//tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
      å…³æ³¨Yå”å¾®ä¿¡å…¬ä¼—è´¦å·biobabble<br>
      <img src="//guangchuangyu.github.io/blog_images/biobabble.jpg" width="250" height="250" />
      <wb:follow-button uid="2185528715" type="red_3" width="100%" height="24" ></wb:follow-button>

      

    
  </section>



  



    
     
  
  
  <section class="even">
    <h1>Recent Posts</h1>

    
    <ul id="recent_posts">
      
      
        
      
      
      <li class="post">
        <a href="https://guangchuangyu.github.io/cn/2017/05/enrichdavid%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89%E8%83%8C%E6%99%AF/">enrichDAVIDæ”¯æŒè‡ªå®šä¹‰èƒŒæ™¯</a>
      </li>
      
      <li class="post">
        <a href="https://guangchuangyu.github.io/cn/2017/05/bootstrap-value%E5%88%86%E6%AE%B5%E6%A0%87%E8%AE%B0/">bootstrap valueåˆ†æ®µæ ‡è®°</a>
      </li>
      
      <li class="post">
        <a href="https://guangchuangyu.github.io/cn/2017/04/annotate-tree-with-user-specific-data/">annotate tree with user specific data</a>
      </li>
      
      <li class="post">
        <a href="https://guangchuangyu.github.io/cn/2017/04/%E5%85%AC%E5%8F%B7%E7%8B%97%E7%9A%84%E7%A6%8F%E9%9F%B3/">å…¬å·ç‹—çš„ç¦éŸ³</a>
      </li>
      
      <li class="post">
        <a href="https://guangchuangyu.github.io/cn/2017/04/%E6%9D%A5%E8%87%AAr%E7%9A%84%E6%A1%8C%E9%9D%A2%E6%8F%90%E9%86%92/">æ¥è‡ªRçš„æ¡Œé¢æé†’</a>
      </li>
      
    </ul>
  </section>

  
  
  <section class="even">
    <h1>Book to Read</h1>
    Analysis of Phylogenetic and Evolution with R<br>
    Inferring phylogenies<br>
    Statistical Models: Theory and Practice<br>
    Algorithms on Strings, Trees, and Sequences
    <h1>Links</h1>
    <a href="http://www.biostathandbook.com/">Handbook of Biological Statistics</a><br>
    <a href="http://r-bloggers.com/">R-bloggers</a>
    <h1>å‹é‚»</h1>
    <a href="http://azaleasays.com/">azalea</a><br>
    <a href="http://blog.shenwei.me/">shenwei</a><br>
    <a href="http://ztpala.com/">ztpala</a>

  </section>




  <script type="text/javascript" src="//rf.revolvermaps.com/0/0/7.js?i=5qpvv5zz7fp&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;sx=0" async="async"></script>

  <script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'GuangchuangYu/Bioinformatics'
  };
</script>
  <script src="//sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
  
</aside>

  </div>
</div>




<footer role="contentinfo">
  <p>Copyright &copy; 2017 Guangchuang Yu - <a href="https://guangchuangyu.github.io/cn/license/">License</a> - 
  <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
</p>

</footer>


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/zenburn.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript"
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/javascript" src="//w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "d135f460-3fc5-4802-8169-bd08e4734a09", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>



</body>
</html>

